{"meta":{"version":1,"warehouse":"4.0.2"},"models":{"Asset":[{"_id":"themes/butterfly/source/css/index.styl","path":"css/index.styl","modified":0,"renderable":1},{"_id":"themes/butterfly/source/css/var.styl","path":"css/var.styl","modified":0,"renderable":1},{"_id":"themes/butterfly/source/js/main.js","path":"js/main.js","modified":0,"renderable":1},{"_id":"themes/butterfly/source/js/tw_cn.js","path":"js/tw_cn.js","modified":0,"renderable":1},{"_id":"themes/butterfly/source/js/utils.js","path":"js/utils.js","modified":0,"renderable":1},{"_id":"themes/butterfly/source/img/favicon.png","path":"img/favicon.png","modified":0,"renderable":1},{"_id":"themes/butterfly/source/img/404.jpg","path":"img/404.jpg","modified":0,"renderable":1},{"_id":"themes/butterfly/source/img/friend_404.gif","path":"img/friend_404.gif","modified":0,"renderable":1},{"_id":"themes/butterfly/source/js/search/algolia.js","path":"js/search/algolia.js","modified":0,"renderable":1},{"_id":"themes/butterfly/source/js/search/local-search.js","path":"js/search/local-search.js","modified":0,"renderable":1},{"_id":"source/images/okx-banner.png","path":"images/okx-banner.png","modified":0,"renderable":0},{"_id":"source/images/vpn1.png","path":"images/vpn1.png","modified":0,"renderable":0},{"_id":"source/images/vpn2.png","path":"images/vpn2.png","modified":0,"renderable":0}],"Cache":[{"_id":"source/_posts/isType.md","hash":"08bf1e07e75dac9e3aabfead09541083864c8520","modified":1651732669920},{"_id":"source/_posts/vite.md","hash":"85e30c825f0648914e819d07f2169071a9a04294","modified":1652170628323},{"_id":"source/_posts/weixinpay.md","hash":"34a7ef91d0d64ac57f3ee9dd760c7496abd79462","modified":1651219320374},{"_id":"source/_posts/vite2.md","hash":"a16686e831639cb883e60a289ad54461e25333ad","modified":1652170628353},{"_id":"source/_posts/项目笔记.md","hash":"b7581ffbb8dba677dd967314c041ef6846dee5bf","modified":1651217791999},{"_id":"source/_posts/小程序随手笔记.md","hash":"6f6376957add8d65a1fdbcf8450a120c3ccf52a8","modified":1651732343154},{"_id":"source/tags/index.md","hash":"f9c375556260e0ae2a95b67712c2857add904d23","modified":1651224164006},{"_id":"themes/butterfly/LICENSE","hash":"c8bc7df08db9dd3b39c2c2259a163a36cf2f6808","modified":1650361750904},{"_id":"themes/butterfly/README.md","hash":"2555c3e418157a0fda35d3deaf029f12e5a12f12","modified":1650361750904},{"_id":"themes/butterfly/README_CN.md","hash":"84fa5880f5358abe919eb295aad3cfd17b69b631","modified":1650361750905},{"_id":"themes/butterfly/_config.yml","hash":"7b3db0f251ea89eebfaca1295f67fcfda2a7cd42","modified":1651222478690},{"_id":"themes/butterfly/package.json","hash":"ff4e6e90badea36f89e79a3c7a25e67dcdf36e32","modified":1650361750933},{"_id":"themes/butterfly/.github/stale.yml","hash":"7a131b8aa4936fbcedea3517299e1cdc1bcbcaab","modified":1650361750904},{"_id":"themes/butterfly/layout/archive.pug","hash":"2d5bf4b1755f89898c579c18d601be83d2bc8ebd","modified":1650361750907},{"_id":"themes/butterfly/layout/category.pug","hash":"bf979aec88d78b644fc5d31518f8679ad7625792","modified":1650361750907},{"_id":"themes/butterfly/layout/index.pug","hash":"648dcbdb3d145a710de81c909e000e8664d2ac9c","modified":1650361750932},{"_id":"themes/butterfly/layout/page.pug","hash":"bf2d6c6d2d156777b55292e51be02b0b3acf0af8","modified":1650361750932},{"_id":"themes/butterfly/layout/post.pug","hash":"fdbb508b5e6dec30fb8753c5a7fdd494410c4fc0","modified":1650361750932},{"_id":"themes/butterfly/layout/tag.pug","hash":"4bb5efc6dabdf1626685bf6771aaa1467155ae86","modified":1650361750933},{"_id":"themes/butterfly/languages/default.yml","hash":"54a412ace93549f02f8e44fcf3e1cacb161a64db","modified":1650361750906},{"_id":"themes/butterfly/languages/en.yml","hash":"69ed4d7aa63a26afd539321784d27494fbebffe8","modified":1650361750907},{"_id":"themes/butterfly/languages/zh-CN.yml","hash":"813eb75fbf274b26e2a0c0c75f359f810ad5eeff","modified":1650361750907},{"_id":"themes/butterfly/languages/zh-TW.yml","hash":"c9675ad7721dd20c9f7731438181a891b43553e6","modified":1650361750907},{"_id":"themes/butterfly/.github/ISSUE_TEMPLATE/bug_report.md","hash":"0b7979a908ebe8c350d73b6731f0be3e29d401c2","modified":1650361750903},{"_id":"themes/butterfly/.github/ISSUE_TEMPLATE/custom.md","hash":"b41123ce5f0ccfa9e06a68b9f3cb59ba040a049a","modified":1650361750903},{"_id":"themes/butterfly/.github/ISSUE_TEMPLATE/feature_request.md","hash":"205a69ba038cf76affcdc1f39d88a8cb8079fc12","modified":1650361750903},{"_id":"themes/butterfly/.github/workflows/publish.yml","hash":"e320b40c051bae1549156cd5ea4a51383cf78598","modified":1650361750904},{"_id":"themes/butterfly/layout/includes/404.pug","hash":"aace9ddff469de4226e47a52ede1c81e66d66d5c","modified":1650361750908},{"_id":"themes/butterfly/layout/includes/additional-js.pug","hash":"8459729db2978bebd7f3668f6dc00a5bb100e633","modified":1650361750908},{"_id":"themes/butterfly/layout/includes/footer.pug","hash":"8715948b93e7508b84d913be1969b28c6b067b9b","modified":1650361750908},{"_id":"themes/butterfly/layout/includes/head.pug","hash":"687461a9422d1eb4d4b5a619854c79e5acc30fd7","modified":1650361750909},{"_id":"themes/butterfly/layout/includes/layout.pug","hash":"f2e1d8a05d2e409c4804f67a98f5f59f527d6627","modified":1650361750912},{"_id":"themes/butterfly/layout/includes/pagination.pug","hash":"bb1847f45e713cc88b1c0a97035ec01f0209c995","modified":1650361750914},{"_id":"themes/butterfly/layout/includes/sidebar.pug","hash":"2cf68619af17ece9acea71aa2cb06737097890a5","modified":1650361750915},{"_id":"themes/butterfly/layout/includes/rightside.pug","hash":"205562ec188bfba5686c51af77486550d0927df5","modified":1650361750915},{"_id":"themes/butterfly/scripts/events/404.js","hash":"f1d1c378356b776e9b2a8411e6dca88dc8c3245c","modified":1650361750933},{"_id":"themes/butterfly/scripts/events/config.js","hash":"e959cd313fc20c62fe23f0a7cba3d350d6131d66","modified":1650361750934},{"_id":"themes/butterfly/scripts/events/init.js","hash":"b321a97420082101a4d41e6e571db1a166475e06","modified":1650361750934},{"_id":"themes/butterfly/scripts/events/welcome.js","hash":"b92cc4648cfe5fb28c58943727823d1178b73a4a","modified":1650361750934},{"_id":"themes/butterfly/scripts/events/stylus.js","hash":"218add7e9b39b6fb6e69921abb9e44891a6cc3ce","modified":1650361750934},{"_id":"themes/butterfly/scripts/filters/post_lazyload.js","hash":"5fd6c9659262dc8f61d87866d0417fd534292c88","modified":1650361750935},{"_id":"themes/butterfly/scripts/filters/random_cover.js","hash":"6c3b7d0874fa499800a4fd49894c481b05ec750c","modified":1650361750935},{"_id":"themes/butterfly/scripts/helpers/aside_categories.js","hash":"376e1884ea764404c38b1e73b16de0358ece519e","modified":1650361750936},{"_id":"themes/butterfly/scripts/helpers/aside_archives.js","hash":"4f712b4ea383b59a3122683db1d54c04a79ccc5d","modified":1650361750936},{"_id":"themes/butterfly/scripts/helpers/inject_head_js.js","hash":"22a2c69b3e68b0e3f80decfd4a2b9c9cc213ff5c","modified":1650361750936},{"_id":"themes/butterfly/scripts/helpers/page.js","hash":"384de3c04809ec5fa996e8aa0628f770cd4bff3e","modified":1650361750936},{"_id":"themes/butterfly/scripts/helpers/related_post.js","hash":"26dd1900e68a3e10a5cf3f3484a93139a0f1340e","modified":1650361750937},{"_id":"themes/butterfly/scripts/tag/button.js","hash":"44cca49ddc76921bb455465ef912cab46c993cef","modified":1650361750937},{"_id":"themes/butterfly/scripts/tag/flink.js","hash":"3ba7677969ff01fab06fc6713455ddc6861f0024","modified":1650361750937},{"_id":"themes/butterfly/scripts/tag/gallery.js","hash":"6d4cd2393945a9316339351cab588265f5c18d73","modified":1650361750938},{"_id":"themes/butterfly/scripts/tag/hide.js","hash":"e01a3967e5884881bab858b11635457df412de80","modified":1650361750939},{"_id":"themes/butterfly/scripts/tag/inlineImg.js","hash":"7641adb0d520c5ff29dd36fc1fb8617c52ecc9fb","modified":1650361750939},{"_id":"themes/butterfly/scripts/tag/label.js","hash":"551f1b8edc973bd8afc5cce2eae546f002fa84c3","modified":1650361750939},{"_id":"themes/butterfly/scripts/tag/note.js","hash":"420ba8b11e7316b4c09eb301d39814bc9bae9f90","modified":1650361750940},{"_id":"themes/butterfly/scripts/tag/mermaid.js","hash":"fd683ccc090db3122d77c7ee73e8d35dc8735ee3","modified":1650361750940},{"_id":"themes/butterfly/scripts/tag/tabs.js","hash":"08ea00791bd4738952234cb5d8360e119df6f875","modified":1650361750940},{"_id":"themes/butterfly/scripts/tag/timeline.js","hash":"4c7056d3cd56f10bd209d2ba4d3cc2027aad1440","modified":1650361750940},{"_id":"themes/butterfly/source/css/index.styl","hash":"c7924868adcb046b46498626a9223c7a7b3f2e30","modified":1650361750958},{"_id":"themes/butterfly/source/css/var.styl","hash":"584ef7b18d5e677eb2e62f9b139097d3b714a993","modified":1650361750958},{"_id":"themes/butterfly/source/js/main.js","hash":"a2c1c55b5b8ec9a83cf6242ebc9ea9be95e1f0c1","modified":1650361750960},{"_id":"themes/butterfly/source/js/tw_cn.js","hash":"4db1170be7a9360e2c5399d281b979da730df2a3","modified":1650361750962},{"_id":"themes/butterfly/source/js/utils.js","hash":"fdb9e5b38f076953a2431b8f682388b030694b55","modified":1650361750963},{"_id":"themes/butterfly/source/img/favicon.png","hash":"3cf89864b4f6c9b532522a4d260a2e887971c92d","modified":1650361750959},{"_id":"themes/butterfly/source/img/404.jpg","hash":"fb4489bc1d30c93d28f7332158c1c6c1416148de","modified":1650361750958},{"_id":"themes/butterfly/source/img/friend_404.gif","hash":"8d2d0ebef70a8eb07329f57e645889b0e420fa48","modified":1650361750959},{"_id":"themes/butterfly/layout/includes/head/Open_Graph.pug","hash":"07380718ed3af19a7e64b30e8c13726fe5983947","modified":1650361750909},{"_id":"themes/butterfly/layout/includes/head/analytics.pug","hash":"c1e45d4d0bd905ddcd2282de4fe89be92e67847d","modified":1650361750909},{"_id":"themes/butterfly/layout/includes/head/config.pug","hash":"b8e3e07b0e8f3cf25af9550c6361725a05045b92","modified":1650361750909},{"_id":"themes/butterfly/layout/includes/head/config_site.pug","hash":"bd5dd5452e28a4fe94c3241a758ec6f4fdb7a149","modified":1650361750909},{"_id":"themes/butterfly/layout/includes/head/google_adsense.pug","hash":"f29123e603cbbcc6ce277d4e8f600ba67498077c","modified":1650361750910},{"_id":"themes/butterfly/layout/includes/head/preconnect.pug","hash":"fc3e67e5ae4774d9e89964ba96beed28f34ee8f0","modified":1650361750910},{"_id":"themes/butterfly/layout/includes/head/noscript.pug","hash":"72efaa09ff60843567458bd54152e06f0cb2757e","modified":1650361750910},{"_id":"themes/butterfly/layout/includes/head/pwa.pug","hash":"6dc2c9b85df9ab4f5b554305339fd80a90a6cf43","modified":1650361750910},{"_id":"themes/butterfly/layout/includes/head/site_verification.pug","hash":"5168caadc4cf541f5d6676a9c5e8ae47a948f9ad","modified":1650361750911},{"_id":"themes/butterfly/layout/includes/header/index.pug","hash":"3a2797d2744607ba6cdb5a02853851957c0f7e29","modified":1650361750911},{"_id":"themes/butterfly/layout/includes/header/menu_item.pug","hash":"ca8bcd90ad9467819330bfe7c02b76322754bccf","modified":1650361750911},{"_id":"themes/butterfly/layout/includes/header/nav.pug","hash":"a9e56b1c41bf327859b0a7bcb8e72b458bd851b2","modified":1650361750911},{"_id":"themes/butterfly/layout/includes/header/social.pug","hash":"631ec7000fd4d6cfa2de118ee02ad8a42ffb34f5","modified":1650361750912},{"_id":"themes/butterfly/layout/includes/header/post-info.pug","hash":"3b0b2053fe9f08cbc21b3baa53163adc2f76c19a","modified":1650361750912},{"_id":"themes/butterfly/layout/includes/mixins/article-sort.pug","hash":"971038debf539333b1687b4a1d87cf4fc965a846","modified":1650361750913},{"_id":"themes/butterfly/layout/includes/mixins/post-ui.pug","hash":"9c8e65939d048a579ea08d063c0f98550376f536","modified":1650361750913},{"_id":"themes/butterfly/layout/includes/loading/loading-js.pug","hash":"2e1ab0c2ca59a1ff5a5ba9b6ef60f3e34af5430c","modified":1650361750912},{"_id":"themes/butterfly/layout/includes/loading/loading.pug","hash":"dd8e6813976be64e80eba6562b54e74527ab306d","modified":1650361750913},{"_id":"themes/butterfly/layout/includes/page/categories.pug","hash":"5276a8d2835e05bd535fedc9f593a0ce8c3e8437","modified":1650361750913},{"_id":"themes/butterfly/layout/includes/page/default-page.pug","hash":"e9459f122af7b733398578f9f0f8ab3c5e12a217","modified":1650361750914},{"_id":"themes/butterfly/layout/includes/page/flink.pug","hash":"e2eba0fcb8332cb333b2aff9c76664e40e2e1974","modified":1650361750914},{"_id":"themes/butterfly/layout/includes/page/tags.pug","hash":"8f43fdeaf8cff4a35bab74b48c963786ca015620","modified":1650361750914},{"_id":"themes/butterfly/layout/includes/post/post-copyright.pug","hash":"6ec54b77e3a90e148e66e317e5bb6c89624fddca","modified":1650361750914},{"_id":"themes/butterfly/layout/includes/post/reward.pug","hash":"594626a18b7efbf771232855dfbce143fb244bc6","modified":1650361750915},{"_id":"themes/butterfly/layout/includes/third-party/aplayer.pug","hash":"bee06b3f01fa1f0d8fa08c154234b452da425101","modified":1650361750915},{"_id":"themes/butterfly/layout/includes/third-party/effect.pug","hash":"4c3da5a89b4e6fd3ab527f5c6d27790359d57f71","modified":1650361750922},{"_id":"themes/butterfly/layout/includes/third-party/pangu.pug","hash":"d06dafe7faf3a2e328ef62f26166a51ffe7a5579","modified":1650361750925},{"_id":"themes/butterfly/layout/includes/third-party/pjax.pug","hash":"61a220bf134201bdf49430b578305191421c547c","modified":1650361750925},{"_id":"themes/butterfly/layout/includes/third-party/prismjs.pug","hash":"2448b243ded58aa1d5fc22fd115e6d06b636f9fd","modified":1650361750925},{"_id":"themes/butterfly/layout/includes/third-party/subtitle.pug","hash":"311d883dede2a6838bf24ba9e4b3f69e62d5b3f1","modified":1650361750928},{"_id":"themes/butterfly/layout/includes/widget/card_ad.pug","hash":"a8312b527493dabbadbb1280760168d3bc909a3b","modified":1650361750928},{"_id":"themes/butterfly/layout/includes/widget/card_announcement.pug","hash":"21e019bdc3b1e796bb00976bb29af2d51f873624","modified":1650361750929},{"_id":"themes/butterfly/layout/includes/widget/card_archives.pug","hash":"73d33b6930e7944187a4b3403daf25d27077a2dd","modified":1650361750929},{"_id":"themes/butterfly/layout/includes/widget/card_bottom_self.pug","hash":"1dba77d250eeebfb6e293d504352c7e9ea31980b","modified":1650361750929},{"_id":"themes/butterfly/layout/includes/widget/card_author.pug","hash":"935dde9cf4c1fef0214dbb9935ecb71805735be0","modified":1650361750929},{"_id":"themes/butterfly/layout/includes/widget/card_categories.pug","hash":"66e383b4ef374951eb87dd1bf4cdb7a667193fb5","modified":1650361750930},{"_id":"themes/butterfly/layout/includes/widget/card_post_toc.pug","hash":"59d979702fa21d960443824198614d63aaf69662","modified":1650361750930},{"_id":"themes/butterfly/layout/includes/widget/card_newest_comment.pug","hash":"c02b1779bd0ebca6749f195be096b6ca574bfa29","modified":1650361750930},{"_id":"themes/butterfly/layout/includes/widget/card_top_self.pug","hash":"7b5ae404a1205546b7de4be42291315cf918f2b3","modified":1650361750931},{"_id":"themes/butterfly/layout/includes/widget/card_recent_post.pug","hash":"471b20e71a19db1f5115727082e5188200c49383","modified":1650361750930},{"_id":"themes/butterfly/layout/includes/widget/card_tags.pug","hash":"9755cac8424dc578e9ec07dbcaa429fddbedd392","modified":1650361750931},{"_id":"themes/butterfly/layout/includes/widget/card_webinfo.pug","hash":"62adef7998fb9bebc5891a49472cfea944a1bf7a","modified":1650361750931},{"_id":"themes/butterfly/layout/includes/widget/index.pug","hash":"5e0e9e9b2cd3c256d52423e2278e790aa387a53a","modified":1650361750932},{"_id":"themes/butterfly/source/css/_global/function.styl","hash":"d35d156b06f4da25a048872f1cfc35ad49092515","modified":1650361750941},{"_id":"themes/butterfly/source/css/_global/index.styl","hash":"b9d7d23dc8810542b8c8ffcbfbd3694318debcc6","modified":1650361750941},{"_id":"themes/butterfly/source/css/_layout/aside.styl","hash":"b62d41e079e45146f0019694156049c5f1be040a","modified":1650361750945},{"_id":"themes/butterfly/source/css/_layout/chat.styl","hash":"f27ad7b5d781c98bcac5c12c2d70b69b830e0374","modified":1650361750945},{"_id":"themes/butterfly/source/css/_layout/footer.styl","hash":"e931ef81754a7b9d999fa23d134c620e68e75491","modified":1650361750945},{"_id":"themes/butterfly/source/css/_layout/comments.styl","hash":"0abe05309a186682772a94e5e759b63f8028e61a","modified":1650361750945},{"_id":"themes/butterfly/source/css/_layout/head.styl","hash":"f3aac52defb3497079a313e8c63ac2f7ee24dfbe","modified":1650361750947},{"_id":"themes/butterfly/source/css/_layout/loading.styl","hash":"844858ae87c7278996ce484c6b456db354c48764","modified":1650361750947},{"_id":"themes/butterfly/source/css/_layout/pagination.styl","hash":"bd099f7d3adef4b7edd24c0a25a07415b156e587","modified":1650361750947},{"_id":"themes/butterfly/source/css/_layout/post.styl","hash":"35c7fa4e18cefe01b62e0caedccbdc0c26b3546c","modified":1650361750947},{"_id":"themes/butterfly/source/css/_layout/relatedposts.styl","hash":"6dcf19c0933c8828a439f801b0f4b256447dec07","modified":1650361750948},{"_id":"themes/butterfly/source/css/_layout/reward.styl","hash":"b5ba2c3339ad406ce611d12d3f8cc84f864fbc03","modified":1650361750949},{"_id":"themes/butterfly/source/css/_layout/rightside.styl","hash":"1c1c585ba99cb4004956b5e98fc044260b456f99","modified":1650361750949},{"_id":"themes/butterfly/source/css/_layout/sidebar.styl","hash":"4258fa2e590aeea704660008aed7f0362fac72d4","modified":1650361750949},{"_id":"themes/butterfly/source/css/_layout/third-party.styl","hash":"988a947f80c218d8c2279c9975f46d0c2a3d0b6e","modified":1650361750949},{"_id":"themes/butterfly/source/css/_highlight/highlight.styl","hash":"a2aa5caf338ff5323b6ff0601ebcc09e710d8398","modified":1650361750941},{"_id":"themes/butterfly/source/css/_highlight/theme.styl","hash":"3c178608406c31d768af355ef1d7326da37cc75f","modified":1650361750944},{"_id":"themes/butterfly/source/css/_mode/darkmode.styl","hash":"0bcd07ffbd2a86a1b24eaefabd7e278034b14ee2","modified":1650361750949},{"_id":"themes/butterfly/source/css/_mode/readmode.styl","hash":"1fed25162d7204480e9bcf476b3246e1717107ca","modified":1650361750950},{"_id":"themes/butterfly/source/css/_page/404.styl","hash":"a7223a8fcc4fa7b81e552c9a2554be7df9de312e","modified":1650361750950},{"_id":"themes/butterfly/source/css/_page/archives.styl","hash":"d72218cb5a6bfe048ae1c92009bd815a08a53d3a","modified":1650361750950},{"_id":"themes/butterfly/source/css/_page/categories.styl","hash":"68bc8cbea25dbb3cdc170f09f9b43ce130547717","modified":1650361750950},{"_id":"themes/butterfly/source/css/_page/flink.styl","hash":"ecc2b2e28c179eb9406fc2c6f00e141078249cdd","modified":1650361750952},{"_id":"themes/butterfly/source/css/_page/common.styl","hash":"a714776e3d585369f2285b6bb4e1564539c58d8b","modified":1650361750951},{"_id":"themes/butterfly/source/css/_page/homepage.styl","hash":"c42b872df237726483d93d6124b8751d4f64cf86","modified":1650361750952},{"_id":"themes/butterfly/source/css/_page/tags.styl","hash":"9e35f91847773b915c74a78b8aa66c7bdb950ad0","modified":1650361750952},{"_id":"themes/butterfly/source/css/_third-party/normalize.min.css","hash":"8549829fb7d3c21cd9e119884962e8c463a4a267","modified":1650361750958},{"_id":"themes/butterfly/source/css/_search/algolia.styl","hash":"f84268708a9ea3c417426bf194bdfea9f7374628","modified":1650361750953},{"_id":"themes/butterfly/source/css/_search/index.styl","hash":"f9bee6cac49de1171076560acf6a6eec96647c56","modified":1650361750953},{"_id":"themes/butterfly/source/css/_search/local-search.styl","hash":"107b9e586b12d1fe7bb5b6e53fcc8e31516ab3ba","modified":1650361750953},{"_id":"themes/butterfly/source/css/_tags/button.styl","hash":"62da1de0d5b8453fcecbfacddb16985265638ba5","modified":1650361750954},{"_id":"themes/butterfly/source/css/_tags/gallery.styl","hash":"84c42716e833d2d1dd47195ea996803ffa0e58ec","modified":1650361750954},{"_id":"themes/butterfly/source/css/_tags/hexo.styl","hash":"985b183db7b7bfd8f9bdb60494549fb7f850348b","modified":1650361750954},{"_id":"themes/butterfly/source/css/_tags/hide.styl","hash":"b7cf7753479fcf2fe07287ffdb0e568adbba4c18","modified":1650361750955},{"_id":"themes/butterfly/source/css/_tags/inlineImg.styl","hash":"5a873d01fabebcf7ddf7a6b1c2e2e5e2714097f4","modified":1650361750955},{"_id":"themes/butterfly/source/css/_tags/label.styl","hash":"2f83bd145b870d80d4b18b0ac603235229a5694e","modified":1650361750955},{"_id":"themes/butterfly/source/css/_tags/tabs.styl","hash":"ec81ea316c82b83d6aee31e52f248d329559d5d3","modified":1650361750957},{"_id":"themes/butterfly/source/css/_tags/note.styl","hash":"076cd87805207c9b5612ec9771f6994287f4c169","modified":1650361750957},{"_id":"themes/butterfly/source/css/_tags/timeline.styl","hash":"07ea7134db7a66c87658116f089fb1a2a6906563","modified":1650361750957},{"_id":"themes/butterfly/source/js/search/algolia.js","hash":"d684f2a60fe821d61761a01cf36fd2fb57c31c9c","modified":1650361750962},{"_id":"themes/butterfly/source/js/search/local-search.js","hash":"2086c6ad3c48ded263a36b230485ed0c15293f8e","modified":1650361750962},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/disqus.pug","hash":"f4d21dcbc3b00eed9b1f604e132c4c6811a0a059","modified":1650361750915},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/fb.pug","hash":"4eebb2d94ca75809ef0cf32d70f13e9bf1e87091","modified":1650361750916},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/valine.pug","hash":"896dc0b7480151562c5717771e3000c5a7fc1b16","modified":1650361750916},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/twikoo.pug","hash":"eb2d840fa42de3ec7a7fda0eaa30246d52f543e2","modified":1650361750916},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/waline.pug","hash":"f3db5c5e738e097a191dc0de59c61d3e1444f7c3","modified":1650361750916},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/index.pug","hash":"a18415004d03c0a1783eccac522fbcb6ce0ea1f1","modified":1650361750916},{"_id":"themes/butterfly/layout/includes/third-party/chat/chatra.pug","hash":"f3f6eaecbcf9352342e259f4a5a3ad7160f31fc9","modified":1650361750917},{"_id":"themes/butterfly/layout/includes/third-party/chat/crisp.pug","hash":"b741b5e942481d779a8a1fe94c45154a62a6b748","modified":1650361750917},{"_id":"themes/butterfly/layout/includes/third-party/chat/gitter.pug","hash":"794ce3911f17d354b7196deb8c36d191afac63fb","modified":1650361750917},{"_id":"themes/butterfly/layout/includes/third-party/chat/daovoice.pug","hash":"e5af55cdb87d1ffd3d8702bc77097159acf95b54","modified":1650361750917},{"_id":"themes/butterfly/layout/includes/third-party/chat/tidio.pug","hash":"cd7ab4a776be93eea96a6f6fd0a547977fbe1ea3","modified":1650361750918},{"_id":"themes/butterfly/layout/includes/third-party/chat/index.pug","hash":"bb467bb22f3d0775b33f9eacbfc086ecb7831e78","modified":1650361750918},{"_id":"themes/butterfly/layout/includes/third-party/comments/disqus.pug","hash":"d5f81fd5443a1b09efb165b5f4447a35949d14ad","modified":1650361750918},{"_id":"themes/butterfly/layout/includes/third-party/comments/disqusjs.pug","hash":"9ddfac9ae7071ecd982ca3808dcfd4d2d6098f33","modified":1650361750919},{"_id":"themes/butterfly/layout/includes/third-party/comments/gitalk.pug","hash":"b22ed23c78fb372cbdc4cfd3f733beb2ebea5d74","modified":1650361750919},{"_id":"themes/butterfly/layout/includes/third-party/comments/giscus.pug","hash":"a780962b3a04cac4b296ce809ee7101e42cf3a37","modified":1650361750919},{"_id":"themes/butterfly/layout/includes/third-party/comments/facebook_comments.pug","hash":"e6d48579029c253b85f2abbba5997d6baf9a10ae","modified":1650361750919},{"_id":"themes/butterfly/layout/includes/third-party/comments/livere.pug","hash":"589f8503f264d4fda971c8daf2028f45c4f2867b","modified":1650361750920},{"_id":"themes/butterfly/layout/includes/third-party/comments/js.pug","hash":"810e8ca2669433f649329859922aabbb30d76178","modified":1650361750920},{"_id":"themes/butterfly/layout/includes/third-party/comments/twikoo.pug","hash":"3f10e67c7618615cc85d50e4a3694f3d8b262952","modified":1650361750921},{"_id":"themes/butterfly/layout/includes/third-party/comments/index.pug","hash":"414f876d28f8497d6d551363a89c5c69bf1533eb","modified":1650361750920},{"_id":"themes/butterfly/layout/includes/third-party/comments/utterances.pug","hash":"21098eba47237ec003228e7fa70a5fbb14d6c804","modified":1650361750921},{"_id":"themes/butterfly/layout/includes/third-party/comments/valine.pug","hash":"d1ac48307e4999be08c63c673e98fe3fcee5bfce","modified":1650361750922},{"_id":"themes/butterfly/layout/includes/third-party/comments/waline.pug","hash":"0f287b10408b4455d946a69677549fcfd302e8c0","modified":1650361750922},{"_id":"themes/butterfly/layout/includes/third-party/math/katex.pug","hash":"266caf985dc0703ff81b871b8f8d206f57db6e79","modified":1650361750922},{"_id":"themes/butterfly/layout/includes/third-party/math/index.pug","hash":"2afa4c21dd19890f47fb568cfb0d90efb676a253","modified":1650361750922},{"_id":"themes/butterfly/layout/includes/third-party/math/mermaid.pug","hash":"6dd420ea858f3237d8a7353e8541df665dd6fdf1","modified":1650361750923},{"_id":"themes/butterfly/layout/includes/third-party/math/mathjax.pug","hash":"87e40f0c315407ab88571a2b3450d640f15c96bc","modified":1650361750923},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/disqus-comment.pug","hash":"cd1ce86441dc508e4c3dbf8b829046455ba8a6b4","modified":1650361750923},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/index.pug","hash":"16cf05cf9649322da57e9b8d316573bb65f8d8d8","modified":1650361750924},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/github-issues.pug","hash":"b2ede1f6b41026ebd233ac076a405889a6eec76b","modified":1650361750924},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/valine.pug","hash":"3b42d3b8468431655112705bff7530ce647f8c05","modified":1650361750924},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/twikoo-comment.pug","hash":"444820bc7e4a9a033062bcd8cd71b10b49d1968a","modified":1650361750924},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/waline.pug","hash":"c9e6e14770317a3516e2e2f320654cd52b1bd73a","modified":1650361750925},{"_id":"themes/butterfly/layout/includes/third-party/search/algolia.pug","hash":"a5aa867697578660fe78a0d9b0f245d09b571110","modified":1650361750926},{"_id":"themes/butterfly/layout/includes/third-party/search/index.pug","hash":"ff3727c3ec698ec61a28c55cbc8c8508f0efb0a0","modified":1650361750926},{"_id":"themes/butterfly/layout/includes/third-party/share/addtoany.pug","hash":"fbac21a6c5924fb2f8d1190fd634105fdbc603d4","modified":1650361750927},{"_id":"themes/butterfly/layout/includes/third-party/search/local-search.pug","hash":"7ce18e4b22c41dcfd84835e89b47030fc5f4a394","modified":1650361750926},{"_id":"themes/butterfly/layout/includes/third-party/share/add-this.pug","hash":"8b4034e53ca5bf85097f681a6e76a53ce685c205","modified":1650361750927},{"_id":"themes/butterfly/layout/includes/third-party/share/index.pug","hash":"4898a09d8e67fb358ffd74b3a1f0014f555dd856","modified":1650361750928},{"_id":"themes/butterfly/layout/includes/third-party/share/share-js.pug","hash":"7e9a7347dd8ca4c33c564fb62512743b6012bb2d","modified":1650361750928},{"_id":"themes/butterfly/source/css/_highlight/highlight/diff.styl","hash":"6e77f1ca0cfb0db6b028f5c0238780e66d344f3d","modified":1650361750943},{"_id":"themes/butterfly/source/css/_highlight/highlight/index.styl","hash":"fc702a4614d0562a381907b083f71ba63d301d86","modified":1650361750943},{"_id":"themes/butterfly/source/css/_highlight/prismjs/index.styl","hash":"01ff9e77eb1bd454bec65a6ff5972c8e219bc708","modified":1650361750944},{"_id":"themes/butterfly/source/css/_highlight/prismjs/diff.styl","hash":"1309292f1c8c53d96cd7333507b106bcc24ca8fc","modified":1650361750944},{"_id":"themes/butterfly/source/css/_highlight/prismjs/line-number.styl","hash":"0b8aea62d1550113e1fcc237fae1b03743190208","modified":1650361750944},{"_id":"public/753b5415.html","hash":"d4976b562a60fc262d434288ff18c963a756f6b8","modified":1651743968351},{"_id":"public/5e9df9d6.html","hash":"7920a4462b695ba1c8ce0621b6c0cab13c28fb5e","modified":1724231664090},{"_id":"public/edba0ae4.html","hash":"0523c2097837985cd12f2055343f2220b8efb564","modified":1724231664090},{"_id":"public/tags/index.html","hash":"9376c35503d5b4b7d81e38a2e186246682d1da2c","modified":1724232111765},{"_id":"public/archives/2022/05/index.html","hash":"5a627ae7c656827507b91f0a5ff3be435a494966","modified":1724232111765},{"_id":"public/tags/Vite/index.html","hash":"c587d627bd922fa1f09281bcf8e39998d7024d9c","modified":1724232111765},{"_id":"public/tags/TypeScript/index.html","hash":"da78b5372fc1d9f4f51ec3064fd195f117cd84a9","modified":1724232111765},{"_id":"public/tags/WeiXinPay/index.html","hash":"2e468e71a2384aebc071e7bcbcce30817deeb9d5","modified":1724232111765},{"_id":"public/tags/Vue/index.html","hash":"53aa1d4a4431d818eff8cbabef1ebb8c204ae051","modified":1724232111765},{"_id":"public/tags/微信小程序/index.html","hash":"a918422244149d65e079ee6bbe3a74aaa6be5774","modified":1724232111765},{"_id":"public/7705a76.html","hash":"6892cd78dce260da1f9895fd13a0deb641bb65f9","modified":1724231664090},{"_id":"public/4a17b158.html","hash":"3e6e94f5860b3ab79a43f9900b02d8ebf2a66385","modified":1724231664090},{"_id":"public/4a17b166.html","hash":"7f185ddce9726920b48782ea171b63a99eb17d20","modified":1724231664090},{"_id":"public/archives/index.html","hash":"e161addee699ddf1c47c38d3b31129e66a592036","modified":1724232111765},{"_id":"public/archives/2022/index.html","hash":"a8019dfbdcff8cefdc7f770f58d6570dadabfa7e","modified":1724232111765},{"_id":"public/archives/2022/04/index.html","hash":"51c857e20f2da2ade30a7ed7b9be63d883447ea5","modified":1724232111765},{"_id":"public/index.html","hash":"0e4ca0500dd90ab4a49644f422b082dbbda76ebd","modified":1724232111765},{"_id":"public/img/favicon.png","hash":"3cf89864b4f6c9b532522a4d260a2e887971c92d","modified":1651743968351},{"_id":"public/img/404.jpg","hash":"fb4489bc1d30c93d28f7332158c1c6c1416148de","modified":1651743968351},{"_id":"public/img/friend_404.gif","hash":"8d2d0ebef70a8eb07329f57e645889b0e420fa48","modified":1651743968351},{"_id":"public/css/var.css","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1651743968351},{"_id":"public/js/utils.js","hash":"0b95daada72abb5d64a1e3236049a60120e47cca","modified":1651743968351},{"_id":"public/js/search/algolia.js","hash":"aaa5e44125dcf321866bc2355a73773b11db8c9c","modified":1651743968351},{"_id":"public/js/search/local-search.js","hash":"ec62117f38e095425f295b1170c222c7a1399425","modified":1651743968351},{"_id":"public/css/index.css","hash":"7eb7667f35e6c34a3f8fda78dfbdbd9b344e96aa","modified":1651743968351},{"_id":"public/js/main.js","hash":"04efcbd28b37875cfec88eb87cab7256a9ebb327","modified":1651743968351},{"_id":"public/js/tw_cn.js","hash":"00053ce73210274b3679f42607edef1206eebc68","modified":1651743968351},{"_id":"public/826db4a2.html","hash":"532a6db51a0150f97f14b993ff1fc91dd85a4777","modified":1724231664090},{"_id":"source/_posts/pinia.md","hash":"5f3e962f28112af14e517f0c8a4719dfe135ec2b","modified":1652170628304},{"_id":"public/b51dc851.html","hash":"f968dc6126f2f902b4e4a65fefed03435f5bc87c","modified":1724231664090},{"_id":"source/_posts/router.md","hash":"655d4710813cac800ebab7d07c3a0ed865c655b0","modified":1652090763377},{"_id":"public/45d2f225.html","hash":"8e167995bc24070441053cf1df73eaea170013a8","modified":1724231664090},{"_id":"public/tags/Pinia/index.html","hash":"fd49959b21d8fec593c6f0acc05f36769804c70a","modified":1724232111765},{"_id":"source/_posts/web3.md","hash":"68fc1f4df666841a32a7e4b099afa7a15176f9f3","modified":1652170628333},{"_id":"public/71ab26c1.html","hash":"554c51c8eddac0d2f2aa31c1e0bfbd634e997bbf","modified":1724231664090},{"_id":"source/_posts/web3-2.md","hash":"a1e5bad8551fb0f9097fcf4d91e62bd715e55ec8","modified":1652171234214},{"_id":"public/eff061d5.html","hash":"98b0af32b4e19d4b927b6aee9dd988cb134ed58d","modified":1724231664090},{"_id":"public/tags/Web3-js/index.html","hash":"9a3a74469c01da1d127ebff0529489730d3df748","modified":1724232111765},{"_id":"source/_posts/css.md","hash":"841444904efd70da9ec3d63c128c4af868fbd909","modified":1652670167223},{"_id":"public/78cea6d8.html","hash":"156d9f498800aa66cf3858889d238330e1fb8f4d","modified":1724231664090},{"_id":"public/archives/page/2/index.html","hash":"473d9495f70f252ad2eb82edecab8b0f499af7e6","modified":1724232111765},{"_id":"public/page/2/index.html","hash":"e5d6654c0ed24057557bbf96ad5487dcceafb2b3","modified":1724232111765},{"_id":"public/archives/2022/page/2/index.html","hash":"385f47f8c7ab91d5ea56404dfb27aebdc3d659e1","modified":1724232111765},{"_id":"public/tags/Css/index.html","hash":"6bade24df631a705d5ace7b95d8965b4158b3a37","modified":1724232111765},{"_id":"source/_posts/css2.md","hash":"2fb09c60ad3ec5190bc7bb37928d9c865a4e8876","modified":1652672738780},{"_id":"public/8513d6fd.html","hash":"0260d42188671e43157d41b2ed58d02973f0b221","modified":1724231664090},{"_id":"source/_posts/创建UTXO.md","hash":"62c7cf124a82ac7e3d32ba2efd192ce38bd4d463","modified":1723112278401},{"_id":"source/_posts/播放Spine动画.md","hash":"14f7c78ac3b366973eb1f49e6090a83d2cf83def","modified":1723113214696},{"_id":"public/35eaf0f1.html","hash":"ce5fab0f17dd35539aadebace7f4eb751ab800e9","modified":1724231664090},{"_id":"public/e5a32ca1.html","hash":"21e285e1e27c475ac72fbf189bff2b876a1ed12e","modified":1724231664090},{"_id":"public/archives/2024/index.html","hash":"4cf8a73f5a3b94836405ab5018c84c8c39804f31","modified":1724232111765},{"_id":"public/archives/2024/08/index.html","hash":"e3875ba02027c478c7ac63cbbf662c426dc123c9","modified":1724232111765},{"_id":"public/tags/BTC/index.html","hash":"677b8ff0566a986257acdc0f8bd815dd3ebb7453","modified":1724232111765},{"_id":"public/tags/Animate/index.html","hash":"815235ba6a4f82c8362384c56043cd817f1c5593","modified":1724232111765},{"_id":"source/_posts/Wagmi返回合约完整错误日志.md","hash":"c084631f05953cfe3b764b40b25d06667785adab","modified":1723186625513},{"_id":"source/_posts/OKX登录BTC.md","hash":"c00cb5bc3729adcba07d62a0009fd8c0cac4c3c8","modified":1723429475136},{"_id":"public/4c3e688d.html","hash":"cb85d39e86105b49444798a92fdb8f45f853dc83","modified":1724231664090},{"_id":"public/c49bf0df.html","hash":"2903dce3287fb73a212010e8080fa6b848bece3b","modified":1724231664090},{"_id":"source/images/okx-banner.png","hash":"adfbcc67153979cadbc99a8d212625f6c16b3fdc","modified":1723429169451},{"_id":"public/images/okx-banner.png","hash":"adfbcc67153979cadbc99a8d212625f6c16b3fdc","modified":1723429633589},{"_id":"source/_posts/ts实现康威生命游戏.md","hash":"51467c255220f5e9164b38c0ce14272037f9ff6b","modified":1723435317779},{"_id":"public/8cc9b930.html","hash":"d40109f423b9a458c99039bd43ffb1281c18065e","modified":1724231664090},{"_id":"source/_posts/电脑共享VPN到手机方法.md","hash":"f667af94c34f5de0e32476e56ea1ab13c2ecd015","modified":1724231558078},{"_id":"source/images/vpn1.png","hash":"18f79698ae17dcebb1ccbc556db5a70b5ed17688","modified":1724231224058},{"_id":"source/images/vpn2.png","hash":"73aa2e1f4b26d0a7512c51e3f9c30b6dc692d5f5","modified":1724231292509},{"_id":"public/36de35a5.html","hash":"a2df28c0fc051d4cc8548bc3bcc7bd4deb28dd86","modified":1724231664090},{"_id":"public/tags/VPN/index.html","hash":"9a3f131dad94ae22431078e3adfb53c39ae8ed3e","modified":1724232111765},{"_id":"public/images/vpn1.png","hash":"18f79698ae17dcebb1ccbc556db5a70b5ed17688","modified":1724231664090},{"_id":"public/images/vpn2.png","hash":"73aa2e1f4b26d0a7512c51e3f9c30b6dc692d5f5","modified":1724231664090},{"_id":"source/_posts/Git推送失败443.md","hash":"b0cedf7fb86dfcfd794b40eccbbe1e7e5b0f1f69","modified":1724232164630}],"Category":[],"Data":[],"Page":[{"title":"tags","type":"tags","layout":"tags","date":"2022-04-29T08:12:20.000Z","_content":"","source":"tags/index.md","raw":"---\ntitle: tags\ntype: tags\nlayout: tags\ndate: 2022-04-29 16:12:20\n---\n","updated":"2022-04-29T09:22:44.006Z","path":"tags/index.html","comments":1,"_id":"cl2stpn4600000ovnfcs0chxt","content":"","site":{"data":{}},"cover":"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7","excerpt":"","more":""}],"Post":[{"title":"Vite+Vue3+TypeScript轻量级框架搭建(1)","cover":"https://s1.ax1x.com/2022/05/05/OeUDJA.jpg","top_img":"https://s1.ax1x.com/2022/05/05/OeUIWn.png","abbrlink":"5e9df9d6","date":"2022-05-05T06:54:34.000Z","_content":"### 初始化项目q\n```\nnpm init vite@latest\n√ Project name: vite+vue3+ts  // 项目名字\n√ Select a framework: » vue  // 框架语言\n√ Select a variant: » vue-ts  // 拓展语言\n```\n### 添加setup name增强插件\n安装\n```shell\npnpm install vite-plugin-vue-setup-extend -D\n```\n配置\n``` ts\nimport { defineConfig } from 'vite'\nimport vue from '@vitejs/plugin-vue'\nimport vueSetupExtend from 'vite-plugin-vue-setup-extend'\n// https://vitejs.dev/config/\nexport default defineConfig({\n  plugins: [vue(), vueSetupExtend()]\n})\n```\n使用\n``` vue\n<script setup name='abc'>\n</script>\n```\n### 为打包后的文件提供传统浏览器兼容性支持\n因为vite不提供传统浏览器兼容,如果有需要请添加此插件\n```shell\npnpm install @vitejs/plugin-legacy -D\n```\n配置\n```ts\nimport { defineConfig } from 'vite'\nimport vue from '@vitejs/plugin-vue'\nimport vueSetupExtend from 'vite-plugin-vue-setup-extend'\nimport legacy from '@vitejs/plugin-legacy'\n// https://vitejs.dev/config/\nexport default defineConfig({\n  plugins: [\n      vue(),\n    vueSetupExtend(),\n    legacy({\n      targets: ['defaults', 'not IE 11'],\n      additionalLegacyPolyfills: ['regenerator-runtime/runtime']\n    })\n  ]\n})\n```\n### vite-plugin-compression 压缩插件\n支持gzip等多种压缩算法\n```shell\npnpm install vite-plugin-compression -D\n```\n配置\n```ts\nimport { defineConfig } from 'vite'\nimport vue from '@vitejs/plugin-vue'\nimport vueSetupExtend from 'vite-plugin-vue-setup-extend'\nimport legacy from '@vitejs/plugin-legacy'\nimport compressPlugin from 'vite-plugin-compression'\n// https://vitejs.dev/config/\nexport default defineConfig({\n  plugins: [\n      vue(),\n    vueSetupExtend(),\n    legacy({\n      targets: ['defaults', 'not IE 11'],\n      additionalLegacyPolyfills: ['regenerator-runtime/runtime']\n    }),\n    compressPlugin({\n      verbose: false, // 是否在控制台输出压缩结果\n      disable: false, // 是否禁用\n      threshold: 10240, // 文件容量大于这个值进行压缩，它将被压缩，单位为b\n      algorithm: 'gzip', // 压缩算法 可选 ['gzip','brotliCompress' ,'deflate','deflateRaw']\n      ext: '.gz', // 生成的压缩包后缀\n    })\n  ]\n})\n```\n### vite-plugin-imagemin 图片压缩\n安装\n```shell\npnpm install vite-plugin-imagemin -D\n```\n配置\n```ts\nimport { defineConfig } from 'vite'\nimport vue from '@vitejs/plugin-vue'\nimport vueSetupExtend from 'vite-plugin-vue-setup-extend'\nimport legacy from '@vitejs/plugin-legacy'\nimport compressPlugin from 'vite-plugin-compression'\nimport viteImagemin from 'vite-plugin-imagemin'\n// https://vitejs.dev/config/\nexport default defineConfig({\n  plugins: [\n      vue(),\n    vueSetupExtend(),\n    legacy({\n      targets: ['defaults', 'not IE 11'],\n      additionalLegacyPolyfills: ['regenerator-runtime/runtime']\n    }),\n    compressPlugin({\n      verbose: false, // 是否在控制台输出压缩结果\n      disable: false, // 是否禁用\n      threshold: 10240, // 文件容量大于这个值进行压缩，它将被压缩，单位为b\n      algorithm: 'gzip', // 压缩算法 可选 ['gzip','brotliCompress' ,'deflate','deflateRaw']\n      ext: '.gz', // 生成的压缩包后缀\n    }),\n    viteImagemin({\n      gifsicle: {\n        optimizationLevel: 7,\n        interlaced: false,\n      },\n      optipng: {\n        optimizationLevel: 7,\n      },\n      mozjpeg: {\n        quality: 20,\n      },\n      pngquant: {\n        quality: [0.8, 0.9],\n        speed: 4,\n      },\n      svgo: {\n        plugins: [\n          {\n            name: 'removeViewBox',\n          },\n          {\n            name: 'removeEmptyAttrs',\n            active: false\n          }\n        ]\n      }\n    })\n  ]\n})\n```","source":"_posts/vite.md","raw":"---\ntitle: Vite+Vue3+TypeScript轻量级框架搭建(1)\ntags: Vite\ncover: 'https://s1.ax1x.com/2022/05/05/OeUDJA.jpg'\ntop_img: 'https://s1.ax1x.com/2022/05/05/OeUIWn.png'\nabbrlink: 5e9df9d6\ndate: 2022-05-05 14:54:34\n---\n### 初始化项目q\n```\nnpm init vite@latest\n√ Project name: vite+vue3+ts  // 项目名字\n√ Select a framework: » vue  // 框架语言\n√ Select a variant: » vue-ts  // 拓展语言\n```\n### 添加setup name增强插件\n安装\n```shell\npnpm install vite-plugin-vue-setup-extend -D\n```\n配置\n``` ts\nimport { defineConfig } from 'vite'\nimport vue from '@vitejs/plugin-vue'\nimport vueSetupExtend from 'vite-plugin-vue-setup-extend'\n// https://vitejs.dev/config/\nexport default defineConfig({\n  plugins: [vue(), vueSetupExtend()]\n})\n```\n使用\n``` vue\n<script setup name='abc'>\n</script>\n```\n### 为打包后的文件提供传统浏览器兼容性支持\n因为vite不提供传统浏览器兼容,如果有需要请添加此插件\n```shell\npnpm install @vitejs/plugin-legacy -D\n```\n配置\n```ts\nimport { defineConfig } from 'vite'\nimport vue from '@vitejs/plugin-vue'\nimport vueSetupExtend from 'vite-plugin-vue-setup-extend'\nimport legacy from '@vitejs/plugin-legacy'\n// https://vitejs.dev/config/\nexport default defineConfig({\n  plugins: [\n      vue(),\n    vueSetupExtend(),\n    legacy({\n      targets: ['defaults', 'not IE 11'],\n      additionalLegacyPolyfills: ['regenerator-runtime/runtime']\n    })\n  ]\n})\n```\n### vite-plugin-compression 压缩插件\n支持gzip等多种压缩算法\n```shell\npnpm install vite-plugin-compression -D\n```\n配置\n```ts\nimport { defineConfig } from 'vite'\nimport vue from '@vitejs/plugin-vue'\nimport vueSetupExtend from 'vite-plugin-vue-setup-extend'\nimport legacy from '@vitejs/plugin-legacy'\nimport compressPlugin from 'vite-plugin-compression'\n// https://vitejs.dev/config/\nexport default defineConfig({\n  plugins: [\n      vue(),\n    vueSetupExtend(),\n    legacy({\n      targets: ['defaults', 'not IE 11'],\n      additionalLegacyPolyfills: ['regenerator-runtime/runtime']\n    }),\n    compressPlugin({\n      verbose: false, // 是否在控制台输出压缩结果\n      disable: false, // 是否禁用\n      threshold: 10240, // 文件容量大于这个值进行压缩，它将被压缩，单位为b\n      algorithm: 'gzip', // 压缩算法 可选 ['gzip','brotliCompress' ,'deflate','deflateRaw']\n      ext: '.gz', // 生成的压缩包后缀\n    })\n  ]\n})\n```\n### vite-plugin-imagemin 图片压缩\n安装\n```shell\npnpm install vite-plugin-imagemin -D\n```\n配置\n```ts\nimport { defineConfig } from 'vite'\nimport vue from '@vitejs/plugin-vue'\nimport vueSetupExtend from 'vite-plugin-vue-setup-extend'\nimport legacy from '@vitejs/plugin-legacy'\nimport compressPlugin from 'vite-plugin-compression'\nimport viteImagemin from 'vite-plugin-imagemin'\n// https://vitejs.dev/config/\nexport default defineConfig({\n  plugins: [\n      vue(),\n    vueSetupExtend(),\n    legacy({\n      targets: ['defaults', 'not IE 11'],\n      additionalLegacyPolyfills: ['regenerator-runtime/runtime']\n    }),\n    compressPlugin({\n      verbose: false, // 是否在控制台输出压缩结果\n      disable: false, // 是否禁用\n      threshold: 10240, // 文件容量大于这个值进行压缩，它将被压缩，单位为b\n      algorithm: 'gzip', // 压缩算法 可选 ['gzip','brotliCompress' ,'deflate','deflateRaw']\n      ext: '.gz', // 生成的压缩包后缀\n    }),\n    viteImagemin({\n      gifsicle: {\n        optimizationLevel: 7,\n        interlaced: false,\n      },\n      optipng: {\n        optimizationLevel: 7,\n      },\n      mozjpeg: {\n        quality: 20,\n      },\n      pngquant: {\n        quality: [0.8, 0.9],\n        speed: 4,\n      },\n      svgo: {\n        plugins: [\n          {\n            name: 'removeViewBox',\n          },\n          {\n            name: 'removeEmptyAttrs',\n            active: false\n          }\n        ]\n      }\n    })\n  ]\n})\n```","slug":"vite","published":1,"updated":"2022-05-10T08:17:08.323Z","_id":"cl2stpn4900010ovn1qbp84m4","comments":1,"layout":"post","photos":[],"link":"","content":"<h3 id=\"初始化项目q\"><a href=\"#初始化项目q\" class=\"headerlink\" title=\"初始化项目q\"></a>初始化项目q</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm init vite@latest</span><br><span class=\"line\">√ Project name: vite+vue3+ts  // 项目名字</span><br><span class=\"line\">√ Select a framework: » vue  // 框架语言</span><br><span class=\"line\">√ Select a variant: » vue-ts  // 拓展语言</span><br></pre></td></tr></table></figure>\n<h3 id=\"添加setup-name增强插件\"><a href=\"#添加setup-name增强插件\" class=\"headerlink\" title=\"添加setup name增强插件\"></a>添加setup name增强插件</h3><p>安装</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pnpm install vite-plugin-vue-setup-extend -D</span><br></pre></td></tr></table></figure>\n<p>配置</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; defineConfig &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vue <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vueSetupExtend <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-vue-setup-extend&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">// https://vitejs.dev/config/</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title function_\">defineConfig</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [<span class=\"title function_\">vue</span>(), <span class=\"title function_\">vueSetupExtend</span>()]</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>使用</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script setup name=&#x27;abc&#x27;&gt;</span><br><span class=\"line\">&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"为打包后的文件提供传统浏览器兼容性支持\"><a href=\"#为打包后的文件提供传统浏览器兼容性支持\" class=\"headerlink\" title=\"为打包后的文件提供传统浏览器兼容性支持\"></a>为打包后的文件提供传统浏览器兼容性支持</h3><p>因为vite不提供传统浏览器兼容,如果有需要请添加此插件</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pnpm install @vitejs/plugin-legacy -D</span><br></pre></td></tr></table></figure>\n<p>配置</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; defineConfig &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vue <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vueSetupExtend <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-vue-setup-extend&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> legacy <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-legacy&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">// https://vitejs.dev/config/</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title function_\">defineConfig</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">      <span class=\"title function_\">vue</span>(),</span><br><span class=\"line\">    <span class=\"title function_\">vueSetupExtend</span>(),</span><br><span class=\"line\">    <span class=\"title function_\">legacy</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">targets</span>: [<span class=\"string\">&#x27;defaults&#x27;</span>, <span class=\"string\">&#x27;not IE 11&#x27;</span>],</span><br><span class=\"line\">      <span class=\"attr\">additionalLegacyPolyfills</span>: [<span class=\"string\">&#x27;regenerator-runtime/runtime&#x27;</span>]</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<h3 id=\"vite-plugin-compression-压缩插件\"><a href=\"#vite-plugin-compression-压缩插件\" class=\"headerlink\" title=\"vite-plugin-compression 压缩插件\"></a>vite-plugin-compression 压缩插件</h3><p>支持gzip等多种压缩算法</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pnpm install vite-plugin-compression -D</span><br></pre></td></tr></table></figure>\n<p>配置</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; defineConfig &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vue <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vueSetupExtend <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-vue-setup-extend&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> legacy <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-legacy&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> compressPlugin <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-compression&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">// https://vitejs.dev/config/</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title function_\">defineConfig</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">      <span class=\"title function_\">vue</span>(),</span><br><span class=\"line\">    <span class=\"title function_\">vueSetupExtend</span>(),</span><br><span class=\"line\">    <span class=\"title function_\">legacy</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">targets</span>: [<span class=\"string\">&#x27;defaults&#x27;</span>, <span class=\"string\">&#x27;not IE 11&#x27;</span>],</span><br><span class=\"line\">      <span class=\"attr\">additionalLegacyPolyfills</span>: [<span class=\"string\">&#x27;regenerator-runtime/runtime&#x27;</span>]</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"title function_\">compressPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">verbose</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 是否在控制台输出压缩结果</span></span><br><span class=\"line\">      <span class=\"attr\">disable</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 是否禁用</span></span><br><span class=\"line\">      <span class=\"attr\">threshold</span>: <span class=\"number\">10240</span>, <span class=\"comment\">// 文件容量大于这个值进行压缩，它将被压缩，单位为b</span></span><br><span class=\"line\">      <span class=\"attr\">algorithm</span>: <span class=\"string\">&#x27;gzip&#x27;</span>, <span class=\"comment\">// 压缩算法 可选 [&#x27;gzip&#x27;,&#x27;brotliCompress&#x27; ,&#x27;deflate&#x27;,&#x27;deflateRaw&#x27;]</span></span><br><span class=\"line\">      <span class=\"attr\">ext</span>: <span class=\"string\">&#x27;.gz&#x27;</span>, <span class=\"comment\">// 生成的压缩包后缀</span></span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<h3 id=\"vite-plugin-imagemin-图片压缩\"><a href=\"#vite-plugin-imagemin-图片压缩\" class=\"headerlink\" title=\"vite-plugin-imagemin 图片压缩\"></a>vite-plugin-imagemin 图片压缩</h3><p>安装</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pnpm install vite-plugin-imagemin -D</span><br></pre></td></tr></table></figure>\n<p>配置</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; defineConfig &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vue <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vueSetupExtend <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-vue-setup-extend&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> legacy <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-legacy&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> compressPlugin <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-compression&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> viteImagemin <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-imagemin&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">// https://vitejs.dev/config/</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title function_\">defineConfig</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">      <span class=\"title function_\">vue</span>(),</span><br><span class=\"line\">    <span class=\"title function_\">vueSetupExtend</span>(),</span><br><span class=\"line\">    <span class=\"title function_\">legacy</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">targets</span>: [<span class=\"string\">&#x27;defaults&#x27;</span>, <span class=\"string\">&#x27;not IE 11&#x27;</span>],</span><br><span class=\"line\">      <span class=\"attr\">additionalLegacyPolyfills</span>: [<span class=\"string\">&#x27;regenerator-runtime/runtime&#x27;</span>]</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"title function_\">compressPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">verbose</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 是否在控制台输出压缩结果</span></span><br><span class=\"line\">      <span class=\"attr\">disable</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 是否禁用</span></span><br><span class=\"line\">      <span class=\"attr\">threshold</span>: <span class=\"number\">10240</span>, <span class=\"comment\">// 文件容量大于这个值进行压缩，它将被压缩，单位为b</span></span><br><span class=\"line\">      <span class=\"attr\">algorithm</span>: <span class=\"string\">&#x27;gzip&#x27;</span>, <span class=\"comment\">// 压缩算法 可选 [&#x27;gzip&#x27;,&#x27;brotliCompress&#x27; ,&#x27;deflate&#x27;,&#x27;deflateRaw&#x27;]</span></span><br><span class=\"line\">      <span class=\"attr\">ext</span>: <span class=\"string\">&#x27;.gz&#x27;</span>, <span class=\"comment\">// 生成的压缩包后缀</span></span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"title function_\">viteImagemin</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">gifsicle</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">optimizationLevel</span>: <span class=\"number\">7</span>,</span><br><span class=\"line\">        <span class=\"attr\">interlaced</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">optipng</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">optimizationLevel</span>: <span class=\"number\">7</span>,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">mozjpeg</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">quality</span>: <span class=\"number\">20</span>,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">pngquant</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">quality</span>: [<span class=\"number\">0.8</span>, <span class=\"number\">0.9</span>],</span><br><span class=\"line\">        <span class=\"attr\">speed</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">svgo</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">name</span>: <span class=\"string\">&#x27;removeViewBox&#x27;</span>,</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">name</span>: <span class=\"string\">&#x27;removeEmptyAttrs&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">active</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"初始化项目q\"><a href=\"#初始化项目q\" class=\"headerlink\" title=\"初始化项目q\"></a>初始化项目q</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm init vite@latest</span><br><span class=\"line\">√ Project name: vite+vue3+ts  // 项目名字</span><br><span class=\"line\">√ Select a framework: » vue  // 框架语言</span><br><span class=\"line\">√ Select a variant: » vue-ts  // 拓展语言</span><br></pre></td></tr></table></figure>\n<h3 id=\"添加setup-name增强插件\"><a href=\"#添加setup-name增强插件\" class=\"headerlink\" title=\"添加setup name增强插件\"></a>添加setup name增强插件</h3><p>安装</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pnpm install vite-plugin-vue-setup-extend -D</span><br></pre></td></tr></table></figure>\n<p>配置</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; defineConfig &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vue <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vueSetupExtend <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-vue-setup-extend&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">// https://vitejs.dev/config/</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title function_\">defineConfig</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [<span class=\"title function_\">vue</span>(), <span class=\"title function_\">vueSetupExtend</span>()]</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>使用</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script setup name=&#x27;abc&#x27;&gt;</span><br><span class=\"line\">&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"为打包后的文件提供传统浏览器兼容性支持\"><a href=\"#为打包后的文件提供传统浏览器兼容性支持\" class=\"headerlink\" title=\"为打包后的文件提供传统浏览器兼容性支持\"></a>为打包后的文件提供传统浏览器兼容性支持</h3><p>因为vite不提供传统浏览器兼容,如果有需要请添加此插件</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pnpm install @vitejs/plugin-legacy -D</span><br></pre></td></tr></table></figure>\n<p>配置</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; defineConfig &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vue <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vueSetupExtend <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-vue-setup-extend&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> legacy <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-legacy&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">// https://vitejs.dev/config/</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title function_\">defineConfig</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">      <span class=\"title function_\">vue</span>(),</span><br><span class=\"line\">    <span class=\"title function_\">vueSetupExtend</span>(),</span><br><span class=\"line\">    <span class=\"title function_\">legacy</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">targets</span>: [<span class=\"string\">&#x27;defaults&#x27;</span>, <span class=\"string\">&#x27;not IE 11&#x27;</span>],</span><br><span class=\"line\">      <span class=\"attr\">additionalLegacyPolyfills</span>: [<span class=\"string\">&#x27;regenerator-runtime/runtime&#x27;</span>]</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<h3 id=\"vite-plugin-compression-压缩插件\"><a href=\"#vite-plugin-compression-压缩插件\" class=\"headerlink\" title=\"vite-plugin-compression 压缩插件\"></a>vite-plugin-compression 压缩插件</h3><p>支持gzip等多种压缩算法</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pnpm install vite-plugin-compression -D</span><br></pre></td></tr></table></figure>\n<p>配置</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; defineConfig &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vue <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vueSetupExtend <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-vue-setup-extend&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> legacy <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-legacy&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> compressPlugin <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-compression&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">// https://vitejs.dev/config/</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title function_\">defineConfig</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">      <span class=\"title function_\">vue</span>(),</span><br><span class=\"line\">    <span class=\"title function_\">vueSetupExtend</span>(),</span><br><span class=\"line\">    <span class=\"title function_\">legacy</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">targets</span>: [<span class=\"string\">&#x27;defaults&#x27;</span>, <span class=\"string\">&#x27;not IE 11&#x27;</span>],</span><br><span class=\"line\">      <span class=\"attr\">additionalLegacyPolyfills</span>: [<span class=\"string\">&#x27;regenerator-runtime/runtime&#x27;</span>]</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"title function_\">compressPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">verbose</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 是否在控制台输出压缩结果</span></span><br><span class=\"line\">      <span class=\"attr\">disable</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 是否禁用</span></span><br><span class=\"line\">      <span class=\"attr\">threshold</span>: <span class=\"number\">10240</span>, <span class=\"comment\">// 文件容量大于这个值进行压缩，它将被压缩，单位为b</span></span><br><span class=\"line\">      <span class=\"attr\">algorithm</span>: <span class=\"string\">&#x27;gzip&#x27;</span>, <span class=\"comment\">// 压缩算法 可选 [&#x27;gzip&#x27;,&#x27;brotliCompress&#x27; ,&#x27;deflate&#x27;,&#x27;deflateRaw&#x27;]</span></span><br><span class=\"line\">      <span class=\"attr\">ext</span>: <span class=\"string\">&#x27;.gz&#x27;</span>, <span class=\"comment\">// 生成的压缩包后缀</span></span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<h3 id=\"vite-plugin-imagemin-图片压缩\"><a href=\"#vite-plugin-imagemin-图片压缩\" class=\"headerlink\" title=\"vite-plugin-imagemin 图片压缩\"></a>vite-plugin-imagemin 图片压缩</h3><p>安装</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pnpm install vite-plugin-imagemin -D</span><br></pre></td></tr></table></figure>\n<p>配置</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; defineConfig &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vue <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vueSetupExtend <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-vue-setup-extend&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> legacy <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-legacy&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> compressPlugin <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-compression&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> viteImagemin <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-imagemin&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">// https://vitejs.dev/config/</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title function_\">defineConfig</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">      <span class=\"title function_\">vue</span>(),</span><br><span class=\"line\">    <span class=\"title function_\">vueSetupExtend</span>(),</span><br><span class=\"line\">    <span class=\"title function_\">legacy</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">targets</span>: [<span class=\"string\">&#x27;defaults&#x27;</span>, <span class=\"string\">&#x27;not IE 11&#x27;</span>],</span><br><span class=\"line\">      <span class=\"attr\">additionalLegacyPolyfills</span>: [<span class=\"string\">&#x27;regenerator-runtime/runtime&#x27;</span>]</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"title function_\">compressPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">verbose</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 是否在控制台输出压缩结果</span></span><br><span class=\"line\">      <span class=\"attr\">disable</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 是否禁用</span></span><br><span class=\"line\">      <span class=\"attr\">threshold</span>: <span class=\"number\">10240</span>, <span class=\"comment\">// 文件容量大于这个值进行压缩，它将被压缩，单位为b</span></span><br><span class=\"line\">      <span class=\"attr\">algorithm</span>: <span class=\"string\">&#x27;gzip&#x27;</span>, <span class=\"comment\">// 压缩算法 可选 [&#x27;gzip&#x27;,&#x27;brotliCompress&#x27; ,&#x27;deflate&#x27;,&#x27;deflateRaw&#x27;]</span></span><br><span class=\"line\">      <span class=\"attr\">ext</span>: <span class=\"string\">&#x27;.gz&#x27;</span>, <span class=\"comment\">// 生成的压缩包后缀</span></span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"title function_\">viteImagemin</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">gifsicle</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">optimizationLevel</span>: <span class=\"number\">7</span>,</span><br><span class=\"line\">        <span class=\"attr\">interlaced</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">optipng</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">optimizationLevel</span>: <span class=\"number\">7</span>,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">mozjpeg</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">quality</span>: <span class=\"number\">20</span>,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">pngquant</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">quality</span>: [<span class=\"number\">0.8</span>, <span class=\"number\">0.9</span>],</span><br><span class=\"line\">        <span class=\"attr\">speed</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">svgo</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">name</span>: <span class=\"string\">&#x27;removeViewBox&#x27;</span>,</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">name</span>: <span class=\"string\">&#x27;removeEmptyAttrs&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">active</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>"},{"title":"前端判断当前访问设备类型","abbrlink":"4a17b166","cover":"https://s1.ax1x.com/2022/05/05/OeYnqe.png","top_img":"https://s1.ax1x.com/2022/05/05/OeY4iR.png","_content":"### 在utils目录下创建一个isType文件\n\n``` ts\n  const ua = window.navigator.userAgent;\n  export const isWap = /Android|iPhone|ios|iPad|iPod|BlackBerry|IEMobile/i.test(ua); // 是否是移动端\n  export const isWeixin = /MicroMessenger/i.test(ua); // 是否是微信浏览器\n  export const isAlipay = /AlipayClient/i.test(ua); // 是否是支付宝浏览器\n  export const isAndroid = /Android/i.test(ua); // 是否安卓设备\n  export const isIOS = /iphone|ios|ipad|ipod/i.test(ua);\n  export const isMainClient = /aijiao100\\(newk12/i.test(ua);\n  export const isWeibo = /(weibo).*weibo__([\\d.]+)/i.test(ua);\n  export const isQQ = /qq\\/([\\d.]+)/i.test(ua);\n  export const isQQBrowser = /(qqbrowser)\\/([\\d.]+)/i.test(ua);\n  export const isQzone = /qzone\\/.*_qz_([\\d.]+)/i.test(ua);\n  export const isInApp = isWeixin || isAlipay || isWeibo || isQQ || isMainClient;\n  \n  // 安卓 chrome 浏览器，很多 app 都是在 chrome 的 ua 上进行扩展的\n  export const isOriginalChrome = /chrome\\/[\\d.]+ Mobile Safari\\/[\\d.]+/i.test(ua) && isAndroid;\n  \n  // chrome for ios 和 safari 的区别仅仅是将 Version/<VersionNum> 替换成了 CriOS/<ChromeRevision>\n  // ios 上很多 app 都包含 safari 标识，但它们都是以自己的 app 标识开头，而不是 Mozilla\n  \n  export const isSafari = /safari\\/([\\d.]+)$/i.test(ua) && /iphone|ios|ipad|ipod/i.test(ua) && ua.indexOf('Crios') < 0 && ua.indexOf('Mozilla') === 0;\n```\n### 使用方法\n``` ts\nimport { isWap } from './utils/isType';\nif (isWap) {\n    console.log('当前是移动端')\n} else {\n    console.log('当前是PC端')\n}\n```","source":"_posts/isType.md","raw":"---\ntitle: 前端判断当前访问设备类型\nabbrlink: 4a17b166\ncover: https://s1.ax1x.com/2022/05/05/OeYnqe.png\ntop_img: https://s1.ax1x.com/2022/05/05/OeY4iR.png\ntags: TypeScript\n---\n### 在utils目录下创建一个isType文件\n\n``` ts\n  const ua = window.navigator.userAgent;\n  export const isWap = /Android|iPhone|ios|iPad|iPod|BlackBerry|IEMobile/i.test(ua); // 是否是移动端\n  export const isWeixin = /MicroMessenger/i.test(ua); // 是否是微信浏览器\n  export const isAlipay = /AlipayClient/i.test(ua); // 是否是支付宝浏览器\n  export const isAndroid = /Android/i.test(ua); // 是否安卓设备\n  export const isIOS = /iphone|ios|ipad|ipod/i.test(ua);\n  export const isMainClient = /aijiao100\\(newk12/i.test(ua);\n  export const isWeibo = /(weibo).*weibo__([\\d.]+)/i.test(ua);\n  export const isQQ = /qq\\/([\\d.]+)/i.test(ua);\n  export const isQQBrowser = /(qqbrowser)\\/([\\d.]+)/i.test(ua);\n  export const isQzone = /qzone\\/.*_qz_([\\d.]+)/i.test(ua);\n  export const isInApp = isWeixin || isAlipay || isWeibo || isQQ || isMainClient;\n  \n  // 安卓 chrome 浏览器，很多 app 都是在 chrome 的 ua 上进行扩展的\n  export const isOriginalChrome = /chrome\\/[\\d.]+ Mobile Safari\\/[\\d.]+/i.test(ua) && isAndroid;\n  \n  // chrome for ios 和 safari 的区别仅仅是将 Version/<VersionNum> 替换成了 CriOS/<ChromeRevision>\n  // ios 上很多 app 都包含 safari 标识，但它们都是以自己的 app 标识开头，而不是 Mozilla\n  \n  export const isSafari = /safari\\/([\\d.]+)$/i.test(ua) && /iphone|ios|ipad|ipod/i.test(ua) && ua.indexOf('Crios') < 0 && ua.indexOf('Mozilla') === 0;\n```\n### 使用方法\n``` ts\nimport { isWap } from './utils/isType';\nif (isWap) {\n    console.log('当前是移动端')\n} else {\n    console.log('当前是PC端')\n}\n```","slug":"isType","published":1,"date":"2022-04-28T08:16:46.199Z","updated":"2022-05-05T06:37:49.920Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl2stpn4c00020ovn7ln844l9","content":"<h3 id=\"在utils目录下创建一个isType文件\"><a href=\"#在utils目录下创建一个isType文件\" class=\"headerlink\" title=\"在utils目录下创建一个isType文件\"></a>在utils目录下创建一个isType文件</h3><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> ua = <span class=\"variable language_\">window</span>.<span class=\"property\">navigator</span>.<span class=\"property\">userAgent</span>;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> isWap = <span class=\"regexp\">/Android|iPhone|ios|iPad|iPod|BlackBerry|IEMobile/i</span>.<span class=\"title function_\">test</span>(ua); <span class=\"comment\">// 是否是移动端</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> isWeixin = <span class=\"regexp\">/MicroMessenger/i</span>.<span class=\"title function_\">test</span>(ua); <span class=\"comment\">// 是否是微信浏览器</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> isAlipay = <span class=\"regexp\">/AlipayClient/i</span>.<span class=\"title function_\">test</span>(ua); <span class=\"comment\">// 是否是支付宝浏览器</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> isAndroid = <span class=\"regexp\">/Android/i</span>.<span class=\"title function_\">test</span>(ua); <span class=\"comment\">// 是否安卓设备</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> isIOS = <span class=\"regexp\">/iphone|ios|ipad|ipod/i</span>.<span class=\"title function_\">test</span>(ua);</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> isMainClient = <span class=\"regexp\">/aijiao100\\(newk12/i</span>.<span class=\"title function_\">test</span>(ua);</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> isWeibo = <span class=\"regexp\">/(weibo).*weibo__([\\d.]+)/i</span>.<span class=\"title function_\">test</span>(ua);</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> isQQ = <span class=\"regexp\">/qq\\/([\\d.]+)/i</span>.<span class=\"title function_\">test</span>(ua);</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> isQQBrowser = <span class=\"regexp\">/(qqbrowser)\\/([\\d.]+)/i</span>.<span class=\"title function_\">test</span>(ua);</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> isQzone = <span class=\"regexp\">/qzone\\/.*_qz_([\\d.]+)/i</span>.<span class=\"title function_\">test</span>(ua);</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> isInApp = isWeixin || isAlipay || isWeibo || isQQ || isMainClient;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 安卓 chrome 浏览器，很多 app 都是在 chrome 的 ua 上进行扩展的</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> isOriginalChrome = <span class=\"regexp\">/chrome\\/[\\d.]+ Mobile Safari\\/[\\d.]+/i</span>.<span class=\"title function_\">test</span>(ua) &amp;&amp; isAndroid;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// chrome for ios 和 safari 的区别仅仅是将 Version/&lt;VersionNum&gt; 替换成了 CriOS/&lt;ChromeRevision&gt;</span></span><br><span class=\"line\"><span class=\"comment\">// ios 上很多 app 都包含 safari 标识，但它们都是以自己的 app 标识开头，而不是 Mozilla</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> isSafari = <span class=\"regexp\">/safari\\/([\\d.]+)$/i</span>.<span class=\"title function_\">test</span>(ua) &amp;&amp; <span class=\"regexp\">/iphone|ios|ipad|ipod/i</span>.<span class=\"title function_\">test</span>(ua) &amp;&amp; ua.<span class=\"title function_\">indexOf</span>(<span class=\"string\">&#x27;Crios&#x27;</span>) &lt; <span class=\"number\">0</span> &amp;&amp; ua.<span class=\"title function_\">indexOf</span>(<span class=\"string\">&#x27;Mozilla&#x27;</span>) === <span class=\"number\">0</span>;</span><br></pre></td></tr></table></figure>\n<h3 id=\"使用方法\"><a href=\"#使用方法\" class=\"headerlink\" title=\"使用方法\"></a>使用方法</h3><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; isWap &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./utils/isType&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (isWap) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;当前是移动端&#x27;</span>)</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;当前是PC端&#x27;</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"在utils目录下创建一个isType文件\"><a href=\"#在utils目录下创建一个isType文件\" class=\"headerlink\" title=\"在utils目录下创建一个isType文件\"></a>在utils目录下创建一个isType文件</h3><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> ua = <span class=\"variable language_\">window</span>.<span class=\"property\">navigator</span>.<span class=\"property\">userAgent</span>;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> isWap = <span class=\"regexp\">/Android|iPhone|ios|iPad|iPod|BlackBerry|IEMobile/i</span>.<span class=\"title function_\">test</span>(ua); <span class=\"comment\">// 是否是移动端</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> isWeixin = <span class=\"regexp\">/MicroMessenger/i</span>.<span class=\"title function_\">test</span>(ua); <span class=\"comment\">// 是否是微信浏览器</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> isAlipay = <span class=\"regexp\">/AlipayClient/i</span>.<span class=\"title function_\">test</span>(ua); <span class=\"comment\">// 是否是支付宝浏览器</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> isAndroid = <span class=\"regexp\">/Android/i</span>.<span class=\"title function_\">test</span>(ua); <span class=\"comment\">// 是否安卓设备</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> isIOS = <span class=\"regexp\">/iphone|ios|ipad|ipod/i</span>.<span class=\"title function_\">test</span>(ua);</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> isMainClient = <span class=\"regexp\">/aijiao100\\(newk12/i</span>.<span class=\"title function_\">test</span>(ua);</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> isWeibo = <span class=\"regexp\">/(weibo).*weibo__([\\d.]+)/i</span>.<span class=\"title function_\">test</span>(ua);</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> isQQ = <span class=\"regexp\">/qq\\/([\\d.]+)/i</span>.<span class=\"title function_\">test</span>(ua);</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> isQQBrowser = <span class=\"regexp\">/(qqbrowser)\\/([\\d.]+)/i</span>.<span class=\"title function_\">test</span>(ua);</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> isQzone = <span class=\"regexp\">/qzone\\/.*_qz_([\\d.]+)/i</span>.<span class=\"title function_\">test</span>(ua);</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> isInApp = isWeixin || isAlipay || isWeibo || isQQ || isMainClient;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 安卓 chrome 浏览器，很多 app 都是在 chrome 的 ua 上进行扩展的</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> isOriginalChrome = <span class=\"regexp\">/chrome\\/[\\d.]+ Mobile Safari\\/[\\d.]+/i</span>.<span class=\"title function_\">test</span>(ua) &amp;&amp; isAndroid;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// chrome for ios 和 safari 的区别仅仅是将 Version/&lt;VersionNum&gt; 替换成了 CriOS/&lt;ChromeRevision&gt;</span></span><br><span class=\"line\"><span class=\"comment\">// ios 上很多 app 都包含 safari 标识，但它们都是以自己的 app 标识开头，而不是 Mozilla</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> isSafari = <span class=\"regexp\">/safari\\/([\\d.]+)$/i</span>.<span class=\"title function_\">test</span>(ua) &amp;&amp; <span class=\"regexp\">/iphone|ios|ipad|ipod/i</span>.<span class=\"title function_\">test</span>(ua) &amp;&amp; ua.<span class=\"title function_\">indexOf</span>(<span class=\"string\">&#x27;Crios&#x27;</span>) &lt; <span class=\"number\">0</span> &amp;&amp; ua.<span class=\"title function_\">indexOf</span>(<span class=\"string\">&#x27;Mozilla&#x27;</span>) === <span class=\"number\">0</span>;</span><br></pre></td></tr></table></figure>\n<h3 id=\"使用方法\"><a href=\"#使用方法\" class=\"headerlink\" title=\"使用方法\"></a>使用方法</h3><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; isWap &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./utils/isType&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (isWap) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;当前是移动端&#x27;</span>)</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;当前是PC端&#x27;</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"微信支付JSAPI前端调起支付","abbrlink":"4a17b158","cover":"https://s1.ax1x.com/2022/04/28/LOHQrF.jpg","_content":"在微信浏览器里面打开H5网页中执行JS调起支付。接口输入输出数据格式为JSON。\n## 注意：WeixinJSBridge内置对象在其他浏览器中无效。\n\n### 1、网页端接口请求参数列表\n\n``` ts\n{\n  appid: string, // appId为当前服务商号绑定的appid\n  timeStamp: string, // 当前的时间\n  nonceStr: string, // 随机字符串，不长于32位。\n  package: string, // 统一下单接口返回的prepay_id参数值\n  signType: string, // 签名类型，默认为MD5，支持HMAC-SHA256和MD5。\n  paySign: string // 签名\n}\n```\n\n以上参数皆是必填项统一由后端接口返回参数\n\n### 2、返回结果值说明\n\n``` ts\n get_brand_wcpay_request:ok // 支付成功\n get_brand_wcpay_request:cancel // 支付过程中用户取消\n get_brand_wcpay_request:fail // 支付失败\n```\n\n注：JS API的返回结果get_brand_wcpay_request:ok仅在用户成功完成支付时返回。由于前端交互复杂，get_brand_wcpay_request:cancel或者get_brand_wcpay_request:fail可以统一处理为用户遇到错误或者主动放弃，不必细化区分。\n\n### 3、前端封装方法\n\n``` ts\ndeclare let WeixinJSBridge: any;\n\n/**\n * @description: 通过JSAPI下单API成功获取预支付交易会话标识（prepay_id）后，需要通过JSAPI调起支付API来调起微信支付收银台\n * 注1：WeixinJSBridge内置对象在其他浏览器中无效\n * 注2：此API需要将请求参数进行签名（参与签名的参数为：appId、timeStamp、nonceStr、package，参数区分大小写）\n * @param {*}\n * @return {*}\n */\nfunction onBridgeReady (res: any)\n{\n  /* eslint-disable-next-line */\n  WeixinJSBridge.invoke('getBrandWCPayRequest', {\n      // 公众号ID，由商户传入\n      'appId': res.appId,\n      // 时间戳（转为String类型，兼容IOS “未传timeStamp”问题）\n      'timeStamp': String(res.timeStamp),\n      // 随机串\n      'nonceStr': res.nonceStr,\n      // 预支付交易会话标识\n      'package': res.package,\n      // 微信签名方式\n      'signType': res.signType,\n      // 微信签名\n      'paySign': res.paySign\n    },\n    function (result: any)\n    {\n      // 微信团队郑重提示：res.err_msg将在用户支付成功后返回ok，但并不保证它绝对可靠。\n\n      // 支付成功\n      if (result.err_msg === 'get_brand_wcpay_request:ok')\n      {\n        console.log('支付成功');\n      }\n\n      // 支付取消\n      if (result.err_msg === 'get_brand_wcpay_request:cancel')\n      {\n        console.log('支付取消');\n      }\n\n      // 支付失败\n      if (result.err_msg === 'get_brand_wcpay_request:fail')\n      {\n        console.log('支付失败');\n      }\n    })\n}\n\n/**\n * @description: 调起微信JSAPI支付\n * @param {*}\n * @return {*}\n */\nfunction bootWechatJSAPIPay (res: any)\n{\n  let document: any;\n  if (typeof WeixinJSBridge === 'undefined')\n  {\n    if (document.addEventListener)\n    {\n      document.addEventListener('WeixinJSBridgeReady', onBridgeReady, false);\n    }\n    else if (document.attachEvent)\n    {\n      document.attachEvent('WeixinJSBridgeReady', onBridgeReady);\n      document.attachEvent('onWeixinJSBridgeReady', onBridgeReady);\n    }\n  }\n  else {\n    onBridgeReady(res)\n  }\n}\n\n// 调起微信JSAPI支付\nexport {\n  bootWechatJSAPIPay\n}\n\n```\n\n以上typScript方法封装\n### 4、前端获取openID方法\n``` ts\nwindow.location.replace(`${baseURL}/api/v1/wechat/oauth?authorization=${sign}&returnUrl=${url.href}`)\n```\n### 5、文件内方法调用\n\n``` ts\nimport { bootWechatJSAPIPay } from 'src/hooks/pay'\nbootWechatJSAPIPay(param)\n```\n如果文档内容没有解决您的问题，您还可以前往 [微信开放社区](https://developers.weixin.qq.com/community/pay) 寻求帮助","source":"_posts/weixinpay.md","raw":"---\ntitle: 微信支付JSAPI前端调起支付\nabbrlink: 4a17b158\ncover: https://s1.ax1x.com/2022/04/28/LOHQrF.jpg\ntags: WeiXinPay\n---\n在微信浏览器里面打开H5网页中执行JS调起支付。接口输入输出数据格式为JSON。\n## 注意：WeixinJSBridge内置对象在其他浏览器中无效。\n\n### 1、网页端接口请求参数列表\n\n``` ts\n{\n  appid: string, // appId为当前服务商号绑定的appid\n  timeStamp: string, // 当前的时间\n  nonceStr: string, // 随机字符串，不长于32位。\n  package: string, // 统一下单接口返回的prepay_id参数值\n  signType: string, // 签名类型，默认为MD5，支持HMAC-SHA256和MD5。\n  paySign: string // 签名\n}\n```\n\n以上参数皆是必填项统一由后端接口返回参数\n\n### 2、返回结果值说明\n\n``` ts\n get_brand_wcpay_request:ok // 支付成功\n get_brand_wcpay_request:cancel // 支付过程中用户取消\n get_brand_wcpay_request:fail // 支付失败\n```\n\n注：JS API的返回结果get_brand_wcpay_request:ok仅在用户成功完成支付时返回。由于前端交互复杂，get_brand_wcpay_request:cancel或者get_brand_wcpay_request:fail可以统一处理为用户遇到错误或者主动放弃，不必细化区分。\n\n### 3、前端封装方法\n\n``` ts\ndeclare let WeixinJSBridge: any;\n\n/**\n * @description: 通过JSAPI下单API成功获取预支付交易会话标识（prepay_id）后，需要通过JSAPI调起支付API来调起微信支付收银台\n * 注1：WeixinJSBridge内置对象在其他浏览器中无效\n * 注2：此API需要将请求参数进行签名（参与签名的参数为：appId、timeStamp、nonceStr、package，参数区分大小写）\n * @param {*}\n * @return {*}\n */\nfunction onBridgeReady (res: any)\n{\n  /* eslint-disable-next-line */\n  WeixinJSBridge.invoke('getBrandWCPayRequest', {\n      // 公众号ID，由商户传入\n      'appId': res.appId,\n      // 时间戳（转为String类型，兼容IOS “未传timeStamp”问题）\n      'timeStamp': String(res.timeStamp),\n      // 随机串\n      'nonceStr': res.nonceStr,\n      // 预支付交易会话标识\n      'package': res.package,\n      // 微信签名方式\n      'signType': res.signType,\n      // 微信签名\n      'paySign': res.paySign\n    },\n    function (result: any)\n    {\n      // 微信团队郑重提示：res.err_msg将在用户支付成功后返回ok，但并不保证它绝对可靠。\n\n      // 支付成功\n      if (result.err_msg === 'get_brand_wcpay_request:ok')\n      {\n        console.log('支付成功');\n      }\n\n      // 支付取消\n      if (result.err_msg === 'get_brand_wcpay_request:cancel')\n      {\n        console.log('支付取消');\n      }\n\n      // 支付失败\n      if (result.err_msg === 'get_brand_wcpay_request:fail')\n      {\n        console.log('支付失败');\n      }\n    })\n}\n\n/**\n * @description: 调起微信JSAPI支付\n * @param {*}\n * @return {*}\n */\nfunction bootWechatJSAPIPay (res: any)\n{\n  let document: any;\n  if (typeof WeixinJSBridge === 'undefined')\n  {\n    if (document.addEventListener)\n    {\n      document.addEventListener('WeixinJSBridgeReady', onBridgeReady, false);\n    }\n    else if (document.attachEvent)\n    {\n      document.attachEvent('WeixinJSBridgeReady', onBridgeReady);\n      document.attachEvent('onWeixinJSBridgeReady', onBridgeReady);\n    }\n  }\n  else {\n    onBridgeReady(res)\n  }\n}\n\n// 调起微信JSAPI支付\nexport {\n  bootWechatJSAPIPay\n}\n\n```\n\n以上typScript方法封装\n### 4、前端获取openID方法\n``` ts\nwindow.location.replace(`${baseURL}/api/v1/wechat/oauth?authorization=${sign}&returnUrl=${url.href}`)\n```\n### 5、文件内方法调用\n\n``` ts\nimport { bootWechatJSAPIPay } from 'src/hooks/pay'\nbootWechatJSAPIPay(param)\n```\n如果文档内容没有解决您的问题，您还可以前往 [微信开放社区](https://developers.weixin.qq.com/community/pay) 寻求帮助","slug":"weixinpay","published":1,"date":"2022-04-28T06:03:37.308Z","updated":"2022-04-29T08:02:00.374Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl2stpn4f00040ovnanbwdeeo","content":"<p>在微信浏览器里面打开H5网页中执行JS调起支付。接口输入输出数据格式为JSON。</p>\n<h2 id=\"注意：WeixinJSBridge内置对象在其他浏览器中无效。\"><a href=\"#注意：WeixinJSBridge内置对象在其他浏览器中无效。\" class=\"headerlink\" title=\"注意：WeixinJSBridge内置对象在其他浏览器中无效。\"></a>注意：WeixinJSBridge内置对象在其他浏览器中无效。</h2><h3 id=\"1、网页端接口请求参数列表\"><a href=\"#1、网页端接口请求参数列表\" class=\"headerlink\" title=\"1、网页端接口请求参数列表\"></a>1、网页端接口请求参数列表</h3><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">appid</span>: <span class=\"built_in\">string</span>, <span class=\"comment\">// appId为当前服务商号绑定的appid</span></span><br><span class=\"line\">  <span class=\"attr\">timeStamp</span>: <span class=\"built_in\">string</span>, <span class=\"comment\">// 当前的时间</span></span><br><span class=\"line\">  <span class=\"attr\">nonceStr</span>: <span class=\"built_in\">string</span>, <span class=\"comment\">// 随机字符串，不长于32位。</span></span><br><span class=\"line\">  <span class=\"attr\">package</span>: <span class=\"built_in\">string</span>, <span class=\"comment\">// 统一下单接口返回的prepay_id参数值</span></span><br><span class=\"line\">  <span class=\"attr\">signType</span>: <span class=\"built_in\">string</span>, <span class=\"comment\">// 签名类型，默认为MD5，支持HMAC-SHA256和MD5。</span></span><br><span class=\"line\">  <span class=\"attr\">paySign</span>: <span class=\"built_in\">string</span> <span class=\"comment\">// 签名</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>以上参数皆是必填项统一由后端接口返回参数</p>\n<h3 id=\"2、返回结果值说明\"><a href=\"#2、返回结果值说明\" class=\"headerlink\" title=\"2、返回结果值说明\"></a>2、返回结果值说明</h3><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">get_brand_wcpay_request</span>:ok <span class=\"comment\">// 支付成功</span></span><br><span class=\"line\"><span class=\"attr\">get_brand_wcpay_request</span>:cancel <span class=\"comment\">// 支付过程中用户取消</span></span><br><span class=\"line\"><span class=\"attr\">get_brand_wcpay_request</span>:fail <span class=\"comment\">// 支付失败</span></span><br></pre></td></tr></table></figure>\n\n<p>注：JS API的返回结果get_brand_wcpay_request:ok仅在用户成功完成支付时返回。由于前端交互复杂，get_brand_wcpay_request:cancel或者get_brand_wcpay_request:fail可以统一处理为用户遇到错误或者主动放弃，不必细化区分。</p>\n<h3 id=\"3、前端封装方法\"><a href=\"#3、前端封装方法\" class=\"headerlink\" title=\"3、前端封装方法\"></a>3、前端封装方法</h3><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">declare</span> <span class=\"keyword\">let</span> <span class=\"title class_\">WeixinJSBridge</span>: <span class=\"built_in\">any</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@description</span>: 通过JSAPI下单API成功获取预支付交易会话标识（prepay_id）后，需要通过JSAPI调起支付API来调起微信支付收银台</span></span><br><span class=\"line\"><span class=\"comment\"> * 注1：WeixinJSBridge内置对象在其他浏览器中无效</span></span><br><span class=\"line\"><span class=\"comment\"> * 注2：此API需要将请求参数进行签名（参与签名的参数为：appId、timeStamp、nonceStr、package，参数区分大小写）</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">*</span>&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> &#123;<span class=\"type\">*</span>&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">onBridgeReady</span> (<span class=\"attr\">res</span>: <span class=\"built_in\">any</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"comment\">/* eslint-disable-next-line */</span></span><br><span class=\"line\">  <span class=\"title class_\">WeixinJSBridge</span>.<span class=\"title function_\">invoke</span>(<span class=\"string\">&#x27;getBrandWCPayRequest&#x27;</span>, &#123;</span><br><span class=\"line\">      <span class=\"comment\">// 公众号ID，由商户传入</span></span><br><span class=\"line\">      <span class=\"string\">&#x27;appId&#x27;</span>: res.<span class=\"property\">appId</span>,</span><br><span class=\"line\">      <span class=\"comment\">// 时间戳（转为String类型，兼容IOS “未传timeStamp”问题）</span></span><br><span class=\"line\">      <span class=\"string\">&#x27;timeStamp&#x27;</span>: <span class=\"title class_\">String</span>(res.<span class=\"property\">timeStamp</span>),</span><br><span class=\"line\">      <span class=\"comment\">// 随机串</span></span><br><span class=\"line\">      <span class=\"string\">&#x27;nonceStr&#x27;</span>: res.<span class=\"property\">nonceStr</span>,</span><br><span class=\"line\">      <span class=\"comment\">// 预支付交易会话标识</span></span><br><span class=\"line\">      <span class=\"string\">&#x27;package&#x27;</span>: res.<span class=\"property\">package</span>,</span><br><span class=\"line\">      <span class=\"comment\">// 微信签名方式</span></span><br><span class=\"line\">      <span class=\"string\">&#x27;signType&#x27;</span>: res.<span class=\"property\">signType</span>,</span><br><span class=\"line\">      <span class=\"comment\">// 微信签名</span></span><br><span class=\"line\">      <span class=\"string\">&#x27;paySign&#x27;</span>: res.<span class=\"property\">paySign</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"keyword\">function</span> (<span class=\"params\">result: <span class=\"built_in\">any</span></span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"comment\">// 微信团队郑重提示：res.err_msg将在用户支付成功后返回ok，但并不保证它绝对可靠。</span></span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">// 支付成功</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (result.<span class=\"property\">err_msg</span> === <span class=\"string\">&#x27;get_brand_wcpay_request:ok&#x27;</span>)</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;支付成功&#x27;</span>);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">// 支付取消</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (result.<span class=\"property\">err_msg</span> === <span class=\"string\">&#x27;get_brand_wcpay_request:cancel&#x27;</span>)</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;支付取消&#x27;</span>);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">// 支付失败</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (result.<span class=\"property\">err_msg</span> === <span class=\"string\">&#x27;get_brand_wcpay_request:fail&#x27;</span>)</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;支付失败&#x27;</span>);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@description</span>: 调起微信JSAPI支付</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">*</span>&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> &#123;<span class=\"type\">*</span>&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">bootWechatJSAPIPay</span> (<span class=\"attr\">res</span>: <span class=\"built_in\">any</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> <span class=\"attr\">document</span>: <span class=\"built_in\">any</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> <span class=\"title class_\">WeixinJSBridge</span> === <span class=\"string\">&#x27;undefined&#x27;</span>)</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">addEventListener</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">document</span>.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;WeixinJSBridgeReady&#x27;</span>, onBridgeReady, <span class=\"literal\">false</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">attachEvent</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">document</span>.<span class=\"title function_\">attachEvent</span>(<span class=\"string\">&#x27;WeixinJSBridgeReady&#x27;</span>, onBridgeReady);</span><br><span class=\"line\">      <span class=\"variable language_\">document</span>.<span class=\"title function_\">attachEvent</span>(<span class=\"string\">&#x27;onWeixinJSBridgeReady&#x27;</span>, onBridgeReady);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"title function_\">onBridgeReady</span>(res)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 调起微信JSAPI支付</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> &#123;</span><br><span class=\"line\">  bootWechatJSAPIPay</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>以上typScript方法封装</p>\n<h3 id=\"4、前端获取openID方法\"><a href=\"#4、前端获取openID方法\" class=\"headerlink\" title=\"4、前端获取openID方法\"></a>4、前端获取openID方法</h3><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">window</span>.<span class=\"property\">location</span>.<span class=\"title function_\">replace</span>(<span class=\"string\">`<span class=\"subst\">$&#123;baseURL&#125;</span>/api/v1/wechat/oauth?authorization=<span class=\"subst\">$&#123;sign&#125;</span>&amp;returnUrl=<span class=\"subst\">$&#123;url.href&#125;</span>`</span>)</span><br></pre></td></tr></table></figure>\n<h3 id=\"5、文件内方法调用\"><a href=\"#5、文件内方法调用\" class=\"headerlink\" title=\"5、文件内方法调用\"></a>5、文件内方法调用</h3><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; bootWechatJSAPIPay &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;src/hooks/pay&#x27;</span></span><br><span class=\"line\"><span class=\"title function_\">bootWechatJSAPIPay</span>(param)</span><br></pre></td></tr></table></figure>\n<p>如果文档内容没有解决您的问题，您还可以前往 <a href=\"https://developers.weixin.qq.com/community/pay\">微信开放社区</a> 寻求帮助</p>\n","site":{"data":{}},"excerpt":"","more":"<p>在微信浏览器里面打开H5网页中执行JS调起支付。接口输入输出数据格式为JSON。</p>\n<h2 id=\"注意：WeixinJSBridge内置对象在其他浏览器中无效。\"><a href=\"#注意：WeixinJSBridge内置对象在其他浏览器中无效。\" class=\"headerlink\" title=\"注意：WeixinJSBridge内置对象在其他浏览器中无效。\"></a>注意：WeixinJSBridge内置对象在其他浏览器中无效。</h2><h3 id=\"1、网页端接口请求参数列表\"><a href=\"#1、网页端接口请求参数列表\" class=\"headerlink\" title=\"1、网页端接口请求参数列表\"></a>1、网页端接口请求参数列表</h3><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">appid</span>: <span class=\"built_in\">string</span>, <span class=\"comment\">// appId为当前服务商号绑定的appid</span></span><br><span class=\"line\">  <span class=\"attr\">timeStamp</span>: <span class=\"built_in\">string</span>, <span class=\"comment\">// 当前的时间</span></span><br><span class=\"line\">  <span class=\"attr\">nonceStr</span>: <span class=\"built_in\">string</span>, <span class=\"comment\">// 随机字符串，不长于32位。</span></span><br><span class=\"line\">  <span class=\"attr\">package</span>: <span class=\"built_in\">string</span>, <span class=\"comment\">// 统一下单接口返回的prepay_id参数值</span></span><br><span class=\"line\">  <span class=\"attr\">signType</span>: <span class=\"built_in\">string</span>, <span class=\"comment\">// 签名类型，默认为MD5，支持HMAC-SHA256和MD5。</span></span><br><span class=\"line\">  <span class=\"attr\">paySign</span>: <span class=\"built_in\">string</span> <span class=\"comment\">// 签名</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>以上参数皆是必填项统一由后端接口返回参数</p>\n<h3 id=\"2、返回结果值说明\"><a href=\"#2、返回结果值说明\" class=\"headerlink\" title=\"2、返回结果值说明\"></a>2、返回结果值说明</h3><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">get_brand_wcpay_request</span>:ok <span class=\"comment\">// 支付成功</span></span><br><span class=\"line\"><span class=\"attr\">get_brand_wcpay_request</span>:cancel <span class=\"comment\">// 支付过程中用户取消</span></span><br><span class=\"line\"><span class=\"attr\">get_brand_wcpay_request</span>:fail <span class=\"comment\">// 支付失败</span></span><br></pre></td></tr></table></figure>\n\n<p>注：JS API的返回结果get_brand_wcpay_request:ok仅在用户成功完成支付时返回。由于前端交互复杂，get_brand_wcpay_request:cancel或者get_brand_wcpay_request:fail可以统一处理为用户遇到错误或者主动放弃，不必细化区分。</p>\n<h3 id=\"3、前端封装方法\"><a href=\"#3、前端封装方法\" class=\"headerlink\" title=\"3、前端封装方法\"></a>3、前端封装方法</h3><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">declare</span> <span class=\"keyword\">let</span> <span class=\"title class_\">WeixinJSBridge</span>: <span class=\"built_in\">any</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@description</span>: 通过JSAPI下单API成功获取预支付交易会话标识（prepay_id）后，需要通过JSAPI调起支付API来调起微信支付收银台</span></span><br><span class=\"line\"><span class=\"comment\"> * 注1：WeixinJSBridge内置对象在其他浏览器中无效</span></span><br><span class=\"line\"><span class=\"comment\"> * 注2：此API需要将请求参数进行签名（参与签名的参数为：appId、timeStamp、nonceStr、package，参数区分大小写）</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">*</span>&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> &#123;<span class=\"type\">*</span>&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">onBridgeReady</span> (<span class=\"attr\">res</span>: <span class=\"built_in\">any</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"comment\">/* eslint-disable-next-line */</span></span><br><span class=\"line\">  <span class=\"title class_\">WeixinJSBridge</span>.<span class=\"title function_\">invoke</span>(<span class=\"string\">&#x27;getBrandWCPayRequest&#x27;</span>, &#123;</span><br><span class=\"line\">      <span class=\"comment\">// 公众号ID，由商户传入</span></span><br><span class=\"line\">      <span class=\"string\">&#x27;appId&#x27;</span>: res.<span class=\"property\">appId</span>,</span><br><span class=\"line\">      <span class=\"comment\">// 时间戳（转为String类型，兼容IOS “未传timeStamp”问题）</span></span><br><span class=\"line\">      <span class=\"string\">&#x27;timeStamp&#x27;</span>: <span class=\"title class_\">String</span>(res.<span class=\"property\">timeStamp</span>),</span><br><span class=\"line\">      <span class=\"comment\">// 随机串</span></span><br><span class=\"line\">      <span class=\"string\">&#x27;nonceStr&#x27;</span>: res.<span class=\"property\">nonceStr</span>,</span><br><span class=\"line\">      <span class=\"comment\">// 预支付交易会话标识</span></span><br><span class=\"line\">      <span class=\"string\">&#x27;package&#x27;</span>: res.<span class=\"property\">package</span>,</span><br><span class=\"line\">      <span class=\"comment\">// 微信签名方式</span></span><br><span class=\"line\">      <span class=\"string\">&#x27;signType&#x27;</span>: res.<span class=\"property\">signType</span>,</span><br><span class=\"line\">      <span class=\"comment\">// 微信签名</span></span><br><span class=\"line\">      <span class=\"string\">&#x27;paySign&#x27;</span>: res.<span class=\"property\">paySign</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"keyword\">function</span> (<span class=\"params\">result: <span class=\"built_in\">any</span></span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"comment\">// 微信团队郑重提示：res.err_msg将在用户支付成功后返回ok，但并不保证它绝对可靠。</span></span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">// 支付成功</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (result.<span class=\"property\">err_msg</span> === <span class=\"string\">&#x27;get_brand_wcpay_request:ok&#x27;</span>)</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;支付成功&#x27;</span>);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">// 支付取消</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (result.<span class=\"property\">err_msg</span> === <span class=\"string\">&#x27;get_brand_wcpay_request:cancel&#x27;</span>)</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;支付取消&#x27;</span>);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">// 支付失败</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (result.<span class=\"property\">err_msg</span> === <span class=\"string\">&#x27;get_brand_wcpay_request:fail&#x27;</span>)</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;支付失败&#x27;</span>);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@description</span>: 调起微信JSAPI支付</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">*</span>&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> &#123;<span class=\"type\">*</span>&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">bootWechatJSAPIPay</span> (<span class=\"attr\">res</span>: <span class=\"built_in\">any</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> <span class=\"attr\">document</span>: <span class=\"built_in\">any</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> <span class=\"title class_\">WeixinJSBridge</span> === <span class=\"string\">&#x27;undefined&#x27;</span>)</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">addEventListener</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">document</span>.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;WeixinJSBridgeReady&#x27;</span>, onBridgeReady, <span class=\"literal\">false</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">attachEvent</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">document</span>.<span class=\"title function_\">attachEvent</span>(<span class=\"string\">&#x27;WeixinJSBridgeReady&#x27;</span>, onBridgeReady);</span><br><span class=\"line\">      <span class=\"variable language_\">document</span>.<span class=\"title function_\">attachEvent</span>(<span class=\"string\">&#x27;onWeixinJSBridgeReady&#x27;</span>, onBridgeReady);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"title function_\">onBridgeReady</span>(res)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 调起微信JSAPI支付</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> &#123;</span><br><span class=\"line\">  bootWechatJSAPIPay</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>以上typScript方法封装</p>\n<h3 id=\"4、前端获取openID方法\"><a href=\"#4、前端获取openID方法\" class=\"headerlink\" title=\"4、前端获取openID方法\"></a>4、前端获取openID方法</h3><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">window</span>.<span class=\"property\">location</span>.<span class=\"title function_\">replace</span>(<span class=\"string\">`<span class=\"subst\">$&#123;baseURL&#125;</span>/api/v1/wechat/oauth?authorization=<span class=\"subst\">$&#123;sign&#125;</span>&amp;returnUrl=<span class=\"subst\">$&#123;url.href&#125;</span>`</span>)</span><br></pre></td></tr></table></figure>\n<h3 id=\"5、文件内方法调用\"><a href=\"#5、文件内方法调用\" class=\"headerlink\" title=\"5、文件内方法调用\"></a>5、文件内方法调用</h3><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; bootWechatJSAPIPay &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;src/hooks/pay&#x27;</span></span><br><span class=\"line\"><span class=\"title function_\">bootWechatJSAPIPay</span>(param)</span><br></pre></td></tr></table></figure>\n<p>如果文档内容没有解决您的问题，您还可以前往 <a href=\"https://developers.weixin.qq.com/community/pay\">微信开放社区</a> 寻求帮助</p>\n"},{"title":"项目笔记","abbrlink":"7705a76","date":"2022-04-29T05:44:57.000Z","cover":"https://s1.ax1x.com/2022/04/29/LvoXHe.png","top_img":"https://s1.ax1x.com/2022/04/29/LvTVEQ.jpg","_content":"### 1、项目网络状态监听并跳转路由\n``` ts\nonMounted(() => {\n  window.addEventListener('offline', ()=>{\n    // 网络异常时触发\n    router.push({ name: 'Disconnect' })\n    sessionStorage.locationUrl=window.location.href;\n  });\n  window.addEventListener('online',()=>{\n    // 网络恢复正常时触发\n    window.location.href=sessionStorage.locationUrl\n  });\n})\n```\n### 2、H5项目每次跳转路由滚动条回到顶部\n在路由守卫中配置\n``` ts\ndocument.title = to.meta.title\nwindow.scrollTo(0,0)\n```","source":"_posts/项目笔记.md","raw":"---\ntitle: 项目笔记\nabbrlink: 7705a76\ndate: 2022-04-29 13:44:57\ncover: https://s1.ax1x.com/2022/04/29/LvoXHe.png\ntop_img: https://s1.ax1x.com/2022/04/29/LvTVEQ.jpg\ntags: Vue\n---\n### 1、项目网络状态监听并跳转路由\n``` ts\nonMounted(() => {\n  window.addEventListener('offline', ()=>{\n    // 网络异常时触发\n    router.push({ name: 'Disconnect' })\n    sessionStorage.locationUrl=window.location.href;\n  });\n  window.addEventListener('online',()=>{\n    // 网络恢复正常时触发\n    window.location.href=sessionStorage.locationUrl\n  });\n})\n```\n### 2、H5项目每次跳转路由滚动条回到顶部\n在路由守卫中配置\n``` ts\ndocument.title = to.meta.title\nwindow.scrollTo(0,0)\n```","slug":"项目笔记","published":1,"updated":"2022-04-29T07:36:31.999Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl2stpn4g00050ovnc0d93ipv","content":"<h3 id=\"1、项目网络状态监听并跳转路由\"><a href=\"#1、项目网络状态监听并跳转路由\" class=\"headerlink\" title=\"1、项目网络状态监听并跳转路由\"></a>1、项目网络状态监听并跳转路由</h3><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">onMounted</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">window</span>.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;offline&#x27;</span>, <span class=\"function\">()=&gt;</span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 网络异常时触发</span></span><br><span class=\"line\">    router.<span class=\"title function_\">push</span>(&#123; <span class=\"attr\">name</span>: <span class=\"string\">&#x27;Disconnect&#x27;</span> &#125;)</span><br><span class=\"line\">    sessionStorage.<span class=\"property\">locationUrl</span>=<span class=\"variable language_\">window</span>.<span class=\"property\">location</span>.<span class=\"property\">href</span>;</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">  <span class=\"variable language_\">window</span>.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;online&#x27;</span>,<span class=\"function\">()=&gt;</span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 网络恢复正常时触发</span></span><br><span class=\"line\">    <span class=\"variable language_\">window</span>.<span class=\"property\">location</span>.<span class=\"property\">href</span>=sessionStorage.<span class=\"property\">locationUrl</span></span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<h3 id=\"2、H5项目每次跳转路由滚动条回到顶部\"><a href=\"#2、H5项目每次跳转路由滚动条回到顶部\" class=\"headerlink\" title=\"2、H5项目每次跳转路由滚动条回到顶部\"></a>2、H5项目每次跳转路由滚动条回到顶部</h3><p>在路由守卫中配置</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">document</span>.<span class=\"property\">title</span> = to.<span class=\"property\">meta</span>.<span class=\"property\">title</span></span><br><span class=\"line\"><span class=\"variable language_\">window</span>.<span class=\"title function_\">scrollTo</span>(<span class=\"number\">0</span>,<span class=\"number\">0</span>)</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"1、项目网络状态监听并跳转路由\"><a href=\"#1、项目网络状态监听并跳转路由\" class=\"headerlink\" title=\"1、项目网络状态监听并跳转路由\"></a>1、项目网络状态监听并跳转路由</h3><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">onMounted</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">window</span>.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;offline&#x27;</span>, <span class=\"function\">()=&gt;</span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 网络异常时触发</span></span><br><span class=\"line\">    router.<span class=\"title function_\">push</span>(&#123; <span class=\"attr\">name</span>: <span class=\"string\">&#x27;Disconnect&#x27;</span> &#125;)</span><br><span class=\"line\">    sessionStorage.<span class=\"property\">locationUrl</span>=<span class=\"variable language_\">window</span>.<span class=\"property\">location</span>.<span class=\"property\">href</span>;</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">  <span class=\"variable language_\">window</span>.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;online&#x27;</span>,<span class=\"function\">()=&gt;</span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 网络恢复正常时触发</span></span><br><span class=\"line\">    <span class=\"variable language_\">window</span>.<span class=\"property\">location</span>.<span class=\"property\">href</span>=sessionStorage.<span class=\"property\">locationUrl</span></span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<h3 id=\"2、H5项目每次跳转路由滚动条回到顶部\"><a href=\"#2、H5项目每次跳转路由滚动条回到顶部\" class=\"headerlink\" title=\"2、H5项目每次跳转路由滚动条回到顶部\"></a>2、H5项目每次跳转路由滚动条回到顶部</h3><p>在路由守卫中配置</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">document</span>.<span class=\"property\">title</span> = to.<span class=\"property\">meta</span>.<span class=\"property\">title</span></span><br><span class=\"line\"><span class=\"variable language_\">window</span>.<span class=\"title function_\">scrollTo</span>(<span class=\"number\">0</span>,<span class=\"number\">0</span>)</span><br></pre></td></tr></table></figure>"},{"title":"小程序随手笔记","abbrlink":"edba0ae4","date":"2022-04-29T08:38:27.000Z","cover":"https://s1.ax1x.com/2022/04/29/LxC2JP.png","_content":"### 1、组件之间的传值、方法调用\n#### 1、子组件调用方法\n在父组件的json文件中注册子组件的路径\n```json\n{\n  \"usingComponents\": {\n    \"progress\": \"../componets/progress/progress\"\n  }\n}\n```\n直接在xml中使用就可以\n```xml\n<progress></progress>\n```\n#### 2、子组件调用父组件页面刷新方法\n需要子组件获取父组件的方法\n``` js\nmethods: {\n    switch: function(e) {\n        const page = getCurrentPages().pop(); // 当前所在的父组件页面\n        page.onShow() // 父组件页面刷新       \n    }\n}\n```\n","source":"_posts/小程序随手笔记.md","raw":"---\ntitle: 小程序随手笔记\nabbrlink: edba0ae4\ndate: 2022-04-29 16:38:27\ncover: https://s1.ax1x.com/2022/04/29/LxC2JP.png\ntags: 微信小程序\n---\n### 1、组件之间的传值、方法调用\n#### 1、子组件调用方法\n在父组件的json文件中注册子组件的路径\n```json\n{\n  \"usingComponents\": {\n    \"progress\": \"../componets/progress/progress\"\n  }\n}\n```\n直接在xml中使用就可以\n```xml\n<progress></progress>\n```\n#### 2、子组件调用父组件页面刷新方法\n需要子组件获取父组件的方法\n``` js\nmethods: {\n    switch: function(e) {\n        const page = getCurrentPages().pop(); // 当前所在的父组件页面\n        page.onShow() // 父组件页面刷新       \n    }\n}\n```\n","slug":"小程序随手笔记","published":1,"updated":"2022-05-05T06:32:23.154Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl2stpn4i00060ovncmom35t9","content":"<h3 id=\"1、组件之间的传值、方法调用\"><a href=\"#1、组件之间的传值、方法调用\" class=\"headerlink\" title=\"1、组件之间的传值、方法调用\"></a>1、组件之间的传值、方法调用</h3><h4 id=\"1、子组件调用方法\"><a href=\"#1、子组件调用方法\" class=\"headerlink\" title=\"1、子组件调用方法\"></a>1、子组件调用方法</h4><p>在父组件的json文件中注册子组件的路径</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;usingComponents&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;progress&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;../componets/progress/progress&quot;</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n<p>直接在xml中使用就可以</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">progress</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">progress</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"2、子组件调用父组件页面刷新方法\"><a href=\"#2、子组件调用父组件页面刷新方法\" class=\"headerlink\" title=\"2、子组件调用父组件页面刷新方法\"></a>2、子组件调用父组件页面刷新方法</h4><p>需要子组件获取父组件的方法</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">methods</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">switch</span>: <span class=\"keyword\">function</span>(<span class=\"params\">e</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> page = <span class=\"title function_\">getCurrentPages</span>().<span class=\"title function_\">pop</span>(); <span class=\"comment\">// 当前所在的父组件页面</span></span><br><span class=\"line\">        page.<span class=\"title function_\">onShow</span>() <span class=\"comment\">// 父组件页面刷新       </span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"1、组件之间的传值、方法调用\"><a href=\"#1、组件之间的传值、方法调用\" class=\"headerlink\" title=\"1、组件之间的传值、方法调用\"></a>1、组件之间的传值、方法调用</h3><h4 id=\"1、子组件调用方法\"><a href=\"#1、子组件调用方法\" class=\"headerlink\" title=\"1、子组件调用方法\"></a>1、子组件调用方法</h4><p>在父组件的json文件中注册子组件的路径</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;usingComponents&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;progress&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;../componets/progress/progress&quot;</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n<p>直接在xml中使用就可以</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">progress</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">progress</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"2、子组件调用父组件页面刷新方法\"><a href=\"#2、子组件调用父组件页面刷新方法\" class=\"headerlink\" title=\"2、子组件调用父组件页面刷新方法\"></a>2、子组件调用父组件页面刷新方法</h4><p>需要子组件获取父组件的方法</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">methods</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">switch</span>: <span class=\"keyword\">function</span>(<span class=\"params\">e</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> page = <span class=\"title function_\">getCurrentPages</span>().<span class=\"title function_\">pop</span>(); <span class=\"comment\">// 当前所在的父组件页面</span></span><br><span class=\"line\">        page.<span class=\"title function_\">onShow</span>() <span class=\"comment\">// 父组件页面刷新       </span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n"},{"title":"Vite+Vue3+TypeScript轻量级框架搭建(2)","cover":"https://s1.ax1x.com/2022/05/05/OeUDJA.jpg","top_img":"https://s1.ax1x.com/2022/05/05/OeUIWn.png","abbrlink":"826db4a2","date":"2022-05-05T09:44:30.000Z","_content":"### unplugin-vue-components - 自动导入、按需导入组件\n安装\n```shell\npnpm install unplugin-vue-components -D\n```\n配置\n```ts\n// vite.config.ts\nimport { defineConfig } from 'vite'\nimport vue from '@vitejs/plugin-vue'\nimport vueSetupExtend from 'vite-plugin-vue-setup-extend'\nimport legacy from '@vitejs/plugin-legacy'\nimport compressPlugin from 'vite-plugin-compression'\nimport viteImagemin from 'vite-plugin-imagemin'\nimport Components from 'unplugin-vue-components/vite'\nimport { ElementPlusResolver } from 'unplugin-vue-components/resolvers'\n// https://vitejs.dev/config/\nexport default defineConfig({\n  plugins: [\n    vue(),\n    ...省略插件配置,\n    Components({\n      dirs: ['src/components'],\n      resolvers: [ElementPlusResolver()],\n      // 组件的有效文件扩展名。\n      extensions: ['vue'],\n      // 允许子目录作为组件的命名空间前缀。\n      directoryAsNamespace: false,\n      deep: true,\n    })\n  ]\n})\n```\n现在已经注释掉HelloWorld组件引入,项目仍正常运行\n``` vue\n<script setup lang=\"ts\" name=\"App\">\n// This starter template is using Vue 3 <script setup> SFCs\n// Check out https://vuejs.org/api/sfc-script-setup.html#script-setup\n// import HelloWorld from './components/HelloWorld.vue'\n</script>\n\n<template>\n  <img alt=\"Vue logo\" src=\"./assets/logo.png\" />\n  <HelloWorld msg=\"Hello Vue 3 + TypeScript + Vite\" />\n</template>\n\n<style>\n</style>\n```\n运行或打包会自动生成components.d.ts文件内容如下：\n```ts\n// generated by unplugin-vue-components\n// We suggest you to commit this file into source control\n// Read more: https://github.com/vuejs/vue-next/pull/3399\nimport '@vue/runtime-core'\n\ndeclare module '@vue/runtime-core' {\n  export interface GlobalComponents {\n    HelloWorld: typeof import('./src/components/HelloWorld.vue')['default']\n  }\n}\nexport {}\n```\n### 安装Vant UI 组件库\n安装\n```shell\npnpm add vant\n```\n### vite-plugin-style-import - 按需引入组件库样式\n安装\n```shell\npnpm install vite-plugin-style-import consola -D\n```\n配置\n```ts\nimport { defineConfig } from 'vite'\nimport vue from '@vitejs/plugin-vue'\nimport vueSetupExtend from 'vite-plugin-vue-setup-extend'\nimport legacy from '@vitejs/plugin-legacy'\nimport compressPlugin from 'vite-plugin-compression'\nimport viteImagemin from 'vite-plugin-imagemin'\nimport Components from 'unplugin-vue-components/vite'\nimport { VantResolver } from 'unplugin-vue-components/resolvers'\nimport { createStyleImportPlugin, VantResolve } from 'vite-plugin-style-import'\n// https://vitejs.dev/config/\nexport default defineConfig({\n  plugins: [\n      vue(),\n    vueSetupExtend(),\n    legacy({\n      targets: ['defaults', 'not IE 11'],\n      additionalLegacyPolyfills: ['regenerator-runtime/runtime']\n    }),\n    compressPlugin({\n      verbose: false, // 是否在控制台输出压缩结果\n      disable: false, // 是否禁用\n      threshold: 10240, // 文件容量大于这个值进行压缩，它将被压缩，单位为b\n      algorithm: 'gzip', // 压缩算法 可选 ['gzip','brotliCompress' ,'deflate','deflateRaw']\n      ext: '.gz', // 生成的压缩包后缀\n    }),\n    viteImagemin({\n      gifsicle: {\n        optimizationLevel: 7,\n        interlaced: false,\n      },\n      optipng: {\n        optimizationLevel: 7,\n      },\n      mozjpeg: {\n        quality: 20,\n      },\n      pngquant: {\n        quality: [0.8, 0.9],\n        speed: 4,\n      },\n      svgo: {\n        plugins: [\n          {\n            name: 'removeViewBox',\n          },\n          {\n            name: 'removeEmptyAttrs',\n            active: false\n          }\n        ]\n      }\n    }),\n    Components({\n      dirs: ['src/components'],\n      resolvers: [VantResolver()],\n      // 组件的有效文件扩展名。\n      extensions: ['vue'],\n      // 允许子目录作为组件的命名空间前缀。\n      directoryAsNamespace: false,\n      deep: true,\n    }),\n    createStyleImportPlugin({ resolves: [VantResolve()] }),\n  ]\n})\n```\n使用vant组件不用手动引入,unplugin-vue-components 按需自动导入组件\n```html\n<van-button type=\"primary\">主要按钮</van-button>\n```\n### unplugin-auto-import - API自动导入\nsetup语法让我们不用再一个一个的把变量和方法都return出去就能在模板上使用，大大的解放了我们的双手。然而对于一些常用的VueAPI，比如ref、computed、watch等，还是每次都需要我们在页面上手动进行import { ref } from 'vue'。\n可以通过unplugin-auto-import实现自动导入，无需import即可在文件里使用Vue的API。\n```shell\npnpm install unplugin-auto-import -D\n```\n配置\n```ts\nimport { defineConfig } from 'vite'\nimport vue from '@vitejs/plugin-vue'\nimport vueSetupExtend from 'vite-plugin-vue-setup-extend'\nimport legacy from '@vitejs/plugin-legacy'\nimport compressPlugin from 'vite-plugin-compression'\nimport viteImagemin from 'vite-plugin-imagemin'\nimport Components from 'unplugin-vue-components/vite'\nimport { VantResolver } from 'unplugin-vue-components/resolvers'\nimport { createStyleImportPlugin, VantResolve } from 'vite-plugin-style-import'\nimport AutoImport from 'unplugin-auto-import/vite'\n// https://vitejs.dev/config/\nexport default defineConfig({\n  plugins: [\n      vue(),\n    vueSetupExtend(),\n    legacy({\n      targets: ['defaults', 'not IE 11'],\n      additionalLegacyPolyfills: ['regenerator-runtime/runtime']\n    }),\n    compressPlugin({\n      verbose: false, // 是否在控制台输出压缩结果\n      disable: false, // 是否禁用\n      threshold: 10240, // 文件容量大于这个值进行压缩，它将被压缩，单位为b\n      algorithm: 'gzip', // 压缩算法 可选 ['gzip','brotliCompress' ,'deflate','deflateRaw']\n      ext: '.gz', // 生成的压缩包后缀\n    }),\n    viteImagemin({\n      gifsicle: {\n        optimizationLevel: 7,\n        interlaced: false,\n      },\n      optipng: {\n        optimizationLevel: 7,\n      },\n      mozjpeg: {\n        quality: 20,\n      },\n      pngquant: {\n        quality: [0.8, 0.9],\n        speed: 4,\n      },\n      svgo: {\n        plugins: [\n          {\n            name: 'removeViewBox',\n          },\n          {\n            name: 'removeEmptyAttrs',\n            active: false\n          }\n        ]\n      }\n    }),\n    Components({\n      dirs: ['src/components'],\n      resolvers: [VantResolver()],\n      // 组件的有效文件扩展名。\n      extensions: ['vue'],\n      // 允许子目录作为组件的命名空间前缀。\n      directoryAsNamespace: false,\n      deep: true,\n    }),\n    createStyleImportPlugin({ resolves: [VantResolve()] }),\n    AutoImport({\n      imports: ['vue'],\n      resolvers: [VantResolver({ importStyle: false })]\n    })\n  ]\n})\n```\n使用\n``` vue\n<script setup lang=\"ts\">\nconst count = ref(0)\nconst state = reactive({\n  data: '321'\n})\nconst { data } = toRefs(state)\n</script>\n\n<template>\n  {{count}}\n  {{data}}\n</template>\n\n<style scoped>\n</style>\n```\n运行或打包会自动生成auto-imports.d.ts文件内容如下：\n```ts\n// Generated by 'unplugin-auto-import'\n// We suggest you to commit this file into source control\ndeclare global {\n  const computed: typeof import('vue')['computed']\n  const createApp: typeof import('vue')['createApp']\n  const customRef: typeof import('vue')['customRef']\n  const defineAsyncComponent: typeof import('vue')['defineAsyncComponent']\n  const defineComponent: typeof import('vue')['defineComponent']\n  const effectScope: typeof import('vue')['effectScope']\n  const EffectScope: typeof import('vue')['EffectScope']\n  const getCurrentInstance: typeof import('vue')['getCurrentInstance']\n  const getCurrentScope: typeof import('vue')['getCurrentScope']\n  const h: typeof import('vue')['h']\n  const inject: typeof import('vue')['inject']\n  const isReadonly: typeof import('vue')['isReadonly']\n  const isRef: typeof import('vue')['isRef']\n  const markRaw: typeof import('vue')['markRaw']\n  const nextTick: typeof import('vue')['nextTick']\n  const onActivated: typeof import('vue')['onActivated']\n  const onBeforeMount: typeof import('vue')['onBeforeMount']\n  const onBeforeUnmount: typeof import('vue')['onBeforeUnmount']\n  const onBeforeUpdate: typeof import('vue')['onBeforeUpdate']\n  const onDeactivated: typeof import('vue')['onDeactivated']\n  const onErrorCaptured: typeof import('vue')['onErrorCaptured']\n  const onMounted: typeof import('vue')['onMounted']\n  const onRenderTracked: typeof import('vue')['onRenderTracked']\n  const onRenderTriggered: typeof import('vue')['onRenderTriggered']\n  const onScopeDispose: typeof import('vue')['onScopeDispose']\n  const onServerPrefetch: typeof import('vue')['onServerPrefetch']\n  const onUnmounted: typeof import('vue')['onUnmounted']\n  const onUpdated: typeof import('vue')['onUpdated']\n  const provide: typeof import('vue')['provide']\n  const reactive: typeof import('vue')['reactive']\n  const readonly: typeof import('vue')['readonly']\n  const ref: typeof import('vue')['ref']\n  const resolveComponent: typeof import('vue')['resolveComponent']\n  const shallowReactive: typeof import('vue')['shallowReactive']\n  const shallowReadonly: typeof import('vue')['shallowReadonly']\n  const shallowRef: typeof import('vue')['shallowRef']\n  const toRaw: typeof import('vue')['toRaw']\n  const toRef: typeof import('vue')['toRef']\n  const toRefs: typeof import('vue')['toRefs']\n  const triggerRef: typeof import('vue')['triggerRef']\n  const unref: typeof import('vue')['unref']\n  const useAttrs: typeof import('vue')['useAttrs']\n  const useCssModule: typeof import('vue')['useCssModule']\n  const useCssVars: typeof import('vue')['useCssVars']\n  const useSlots: typeof import('vue')['useSlots']\n  const watch: typeof import('vue')['watch']\n  const watchEffect: typeof import('vue')['watchEffect']\n}\nexport {}\n```","source":"_posts/vite2.md","raw":"---\ntitle: Vite+Vue3+TypeScript轻量级框架搭建(2)\ntags: Vite\ncover: 'https://s1.ax1x.com/2022/05/05/OeUDJA.jpg'\ntop_img: 'https://s1.ax1x.com/2022/05/05/OeUIWn.png'\nabbrlink: 826db4a2\ndate: 2022-05-05 17:44:30\n---\n### unplugin-vue-components - 自动导入、按需导入组件\n安装\n```shell\npnpm install unplugin-vue-components -D\n```\n配置\n```ts\n// vite.config.ts\nimport { defineConfig } from 'vite'\nimport vue from '@vitejs/plugin-vue'\nimport vueSetupExtend from 'vite-plugin-vue-setup-extend'\nimport legacy from '@vitejs/plugin-legacy'\nimport compressPlugin from 'vite-plugin-compression'\nimport viteImagemin from 'vite-plugin-imagemin'\nimport Components from 'unplugin-vue-components/vite'\nimport { ElementPlusResolver } from 'unplugin-vue-components/resolvers'\n// https://vitejs.dev/config/\nexport default defineConfig({\n  plugins: [\n    vue(),\n    ...省略插件配置,\n    Components({\n      dirs: ['src/components'],\n      resolvers: [ElementPlusResolver()],\n      // 组件的有效文件扩展名。\n      extensions: ['vue'],\n      // 允许子目录作为组件的命名空间前缀。\n      directoryAsNamespace: false,\n      deep: true,\n    })\n  ]\n})\n```\n现在已经注释掉HelloWorld组件引入,项目仍正常运行\n``` vue\n<script setup lang=\"ts\" name=\"App\">\n// This starter template is using Vue 3 <script setup> SFCs\n// Check out https://vuejs.org/api/sfc-script-setup.html#script-setup\n// import HelloWorld from './components/HelloWorld.vue'\n</script>\n\n<template>\n  <img alt=\"Vue logo\" src=\"./assets/logo.png\" />\n  <HelloWorld msg=\"Hello Vue 3 + TypeScript + Vite\" />\n</template>\n\n<style>\n</style>\n```\n运行或打包会自动生成components.d.ts文件内容如下：\n```ts\n// generated by unplugin-vue-components\n// We suggest you to commit this file into source control\n// Read more: https://github.com/vuejs/vue-next/pull/3399\nimport '@vue/runtime-core'\n\ndeclare module '@vue/runtime-core' {\n  export interface GlobalComponents {\n    HelloWorld: typeof import('./src/components/HelloWorld.vue')['default']\n  }\n}\nexport {}\n```\n### 安装Vant UI 组件库\n安装\n```shell\npnpm add vant\n```\n### vite-plugin-style-import - 按需引入组件库样式\n安装\n```shell\npnpm install vite-plugin-style-import consola -D\n```\n配置\n```ts\nimport { defineConfig } from 'vite'\nimport vue from '@vitejs/plugin-vue'\nimport vueSetupExtend from 'vite-plugin-vue-setup-extend'\nimport legacy from '@vitejs/plugin-legacy'\nimport compressPlugin from 'vite-plugin-compression'\nimport viteImagemin from 'vite-plugin-imagemin'\nimport Components from 'unplugin-vue-components/vite'\nimport { VantResolver } from 'unplugin-vue-components/resolvers'\nimport { createStyleImportPlugin, VantResolve } from 'vite-plugin-style-import'\n// https://vitejs.dev/config/\nexport default defineConfig({\n  plugins: [\n      vue(),\n    vueSetupExtend(),\n    legacy({\n      targets: ['defaults', 'not IE 11'],\n      additionalLegacyPolyfills: ['regenerator-runtime/runtime']\n    }),\n    compressPlugin({\n      verbose: false, // 是否在控制台输出压缩结果\n      disable: false, // 是否禁用\n      threshold: 10240, // 文件容量大于这个值进行压缩，它将被压缩，单位为b\n      algorithm: 'gzip', // 压缩算法 可选 ['gzip','brotliCompress' ,'deflate','deflateRaw']\n      ext: '.gz', // 生成的压缩包后缀\n    }),\n    viteImagemin({\n      gifsicle: {\n        optimizationLevel: 7,\n        interlaced: false,\n      },\n      optipng: {\n        optimizationLevel: 7,\n      },\n      mozjpeg: {\n        quality: 20,\n      },\n      pngquant: {\n        quality: [0.8, 0.9],\n        speed: 4,\n      },\n      svgo: {\n        plugins: [\n          {\n            name: 'removeViewBox',\n          },\n          {\n            name: 'removeEmptyAttrs',\n            active: false\n          }\n        ]\n      }\n    }),\n    Components({\n      dirs: ['src/components'],\n      resolvers: [VantResolver()],\n      // 组件的有效文件扩展名。\n      extensions: ['vue'],\n      // 允许子目录作为组件的命名空间前缀。\n      directoryAsNamespace: false,\n      deep: true,\n    }),\n    createStyleImportPlugin({ resolves: [VantResolve()] }),\n  ]\n})\n```\n使用vant组件不用手动引入,unplugin-vue-components 按需自动导入组件\n```html\n<van-button type=\"primary\">主要按钮</van-button>\n```\n### unplugin-auto-import - API自动导入\nsetup语法让我们不用再一个一个的把变量和方法都return出去就能在模板上使用，大大的解放了我们的双手。然而对于一些常用的VueAPI，比如ref、computed、watch等，还是每次都需要我们在页面上手动进行import { ref } from 'vue'。\n可以通过unplugin-auto-import实现自动导入，无需import即可在文件里使用Vue的API。\n```shell\npnpm install unplugin-auto-import -D\n```\n配置\n```ts\nimport { defineConfig } from 'vite'\nimport vue from '@vitejs/plugin-vue'\nimport vueSetupExtend from 'vite-plugin-vue-setup-extend'\nimport legacy from '@vitejs/plugin-legacy'\nimport compressPlugin from 'vite-plugin-compression'\nimport viteImagemin from 'vite-plugin-imagemin'\nimport Components from 'unplugin-vue-components/vite'\nimport { VantResolver } from 'unplugin-vue-components/resolvers'\nimport { createStyleImportPlugin, VantResolve } from 'vite-plugin-style-import'\nimport AutoImport from 'unplugin-auto-import/vite'\n// https://vitejs.dev/config/\nexport default defineConfig({\n  plugins: [\n      vue(),\n    vueSetupExtend(),\n    legacy({\n      targets: ['defaults', 'not IE 11'],\n      additionalLegacyPolyfills: ['regenerator-runtime/runtime']\n    }),\n    compressPlugin({\n      verbose: false, // 是否在控制台输出压缩结果\n      disable: false, // 是否禁用\n      threshold: 10240, // 文件容量大于这个值进行压缩，它将被压缩，单位为b\n      algorithm: 'gzip', // 压缩算法 可选 ['gzip','brotliCompress' ,'deflate','deflateRaw']\n      ext: '.gz', // 生成的压缩包后缀\n    }),\n    viteImagemin({\n      gifsicle: {\n        optimizationLevel: 7,\n        interlaced: false,\n      },\n      optipng: {\n        optimizationLevel: 7,\n      },\n      mozjpeg: {\n        quality: 20,\n      },\n      pngquant: {\n        quality: [0.8, 0.9],\n        speed: 4,\n      },\n      svgo: {\n        plugins: [\n          {\n            name: 'removeViewBox',\n          },\n          {\n            name: 'removeEmptyAttrs',\n            active: false\n          }\n        ]\n      }\n    }),\n    Components({\n      dirs: ['src/components'],\n      resolvers: [VantResolver()],\n      // 组件的有效文件扩展名。\n      extensions: ['vue'],\n      // 允许子目录作为组件的命名空间前缀。\n      directoryAsNamespace: false,\n      deep: true,\n    }),\n    createStyleImportPlugin({ resolves: [VantResolve()] }),\n    AutoImport({\n      imports: ['vue'],\n      resolvers: [VantResolver({ importStyle: false })]\n    })\n  ]\n})\n```\n使用\n``` vue\n<script setup lang=\"ts\">\nconst count = ref(0)\nconst state = reactive({\n  data: '321'\n})\nconst { data } = toRefs(state)\n</script>\n\n<template>\n  {{count}}\n  {{data}}\n</template>\n\n<style scoped>\n</style>\n```\n运行或打包会自动生成auto-imports.d.ts文件内容如下：\n```ts\n// Generated by 'unplugin-auto-import'\n// We suggest you to commit this file into source control\ndeclare global {\n  const computed: typeof import('vue')['computed']\n  const createApp: typeof import('vue')['createApp']\n  const customRef: typeof import('vue')['customRef']\n  const defineAsyncComponent: typeof import('vue')['defineAsyncComponent']\n  const defineComponent: typeof import('vue')['defineComponent']\n  const effectScope: typeof import('vue')['effectScope']\n  const EffectScope: typeof import('vue')['EffectScope']\n  const getCurrentInstance: typeof import('vue')['getCurrentInstance']\n  const getCurrentScope: typeof import('vue')['getCurrentScope']\n  const h: typeof import('vue')['h']\n  const inject: typeof import('vue')['inject']\n  const isReadonly: typeof import('vue')['isReadonly']\n  const isRef: typeof import('vue')['isRef']\n  const markRaw: typeof import('vue')['markRaw']\n  const nextTick: typeof import('vue')['nextTick']\n  const onActivated: typeof import('vue')['onActivated']\n  const onBeforeMount: typeof import('vue')['onBeforeMount']\n  const onBeforeUnmount: typeof import('vue')['onBeforeUnmount']\n  const onBeforeUpdate: typeof import('vue')['onBeforeUpdate']\n  const onDeactivated: typeof import('vue')['onDeactivated']\n  const onErrorCaptured: typeof import('vue')['onErrorCaptured']\n  const onMounted: typeof import('vue')['onMounted']\n  const onRenderTracked: typeof import('vue')['onRenderTracked']\n  const onRenderTriggered: typeof import('vue')['onRenderTriggered']\n  const onScopeDispose: typeof import('vue')['onScopeDispose']\n  const onServerPrefetch: typeof import('vue')['onServerPrefetch']\n  const onUnmounted: typeof import('vue')['onUnmounted']\n  const onUpdated: typeof import('vue')['onUpdated']\n  const provide: typeof import('vue')['provide']\n  const reactive: typeof import('vue')['reactive']\n  const readonly: typeof import('vue')['readonly']\n  const ref: typeof import('vue')['ref']\n  const resolveComponent: typeof import('vue')['resolveComponent']\n  const shallowReactive: typeof import('vue')['shallowReactive']\n  const shallowReadonly: typeof import('vue')['shallowReadonly']\n  const shallowRef: typeof import('vue')['shallowRef']\n  const toRaw: typeof import('vue')['toRaw']\n  const toRef: typeof import('vue')['toRef']\n  const toRefs: typeof import('vue')['toRefs']\n  const triggerRef: typeof import('vue')['triggerRef']\n  const unref: typeof import('vue')['unref']\n  const useAttrs: typeof import('vue')['useAttrs']\n  const useCssModule: typeof import('vue')['useCssModule']\n  const useCssVars: typeof import('vue')['useCssVars']\n  const useSlots: typeof import('vue')['useSlots']\n  const watch: typeof import('vue')['watch']\n  const watchEffect: typeof import('vue')['watchEffect']\n}\nexport {}\n```","slug":"vite2","published":1,"updated":"2022-05-10T08:17:08.353Z","_id":"cl2stpn4j00090ovn01rv3qs1","comments":1,"layout":"post","photos":[],"link":"","content":"<h3 id=\"unplugin-vue-components-自动导入、按需导入组件\"><a href=\"#unplugin-vue-components-自动导入、按需导入组件\" class=\"headerlink\" title=\"unplugin-vue-components - 自动导入、按需导入组件\"></a>unplugin-vue-components - 自动导入、按需导入组件</h3><p>安装</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pnpm install unplugin-vue-components -D</span><br></pre></td></tr></table></figure>\n<p>配置</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// vite.config.ts</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; defineConfig &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vue <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vueSetupExtend <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-vue-setup-extend&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> legacy <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-legacy&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> compressPlugin <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-compression&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> viteImagemin <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-imagemin&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">Components</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;unplugin-vue-components/vite&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; <span class=\"title class_\">ElementPlusResolver</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;unplugin-vue-components/resolvers&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">// https://vitejs.dev/config/</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title function_\">defineConfig</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">    <span class=\"title function_\">vue</span>(),</span><br><span class=\"line\">    ...省略插件配置,</span><br><span class=\"line\">    <span class=\"title class_\">Components</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">dirs</span>: [<span class=\"string\">&#x27;src/components&#x27;</span>],</span><br><span class=\"line\">      <span class=\"attr\">resolvers</span>: [<span class=\"title class_\">ElementPlusResolver</span>()],</span><br><span class=\"line\">      <span class=\"comment\">// 组件的有效文件扩展名。</span></span><br><span class=\"line\">      <span class=\"attr\">extensions</span>: [<span class=\"string\">&#x27;vue&#x27;</span>],</span><br><span class=\"line\">      <span class=\"comment\">// 允许子目录作为组件的命名空间前缀。</span></span><br><span class=\"line\">      <span class=\"attr\">directoryAsNamespace</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">      <span class=\"attr\">deep</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>现在已经注释掉HelloWorld组件引入,项目仍正常运行</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script setup lang=&quot;ts&quot; name=&quot;App&quot;&gt;</span><br><span class=\"line\">// This starter template is using Vue 3 &lt;script setup&gt; SFCs</span><br><span class=\"line\">// Check out https://vuejs.org/api/sfc-script-setup.html#script-setup</span><br><span class=\"line\">// import HelloWorld from &#x27;./components/HelloWorld.vue&#x27;</span><br><span class=\"line\">&lt;/script&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">  &lt;img alt=&quot;Vue logo&quot; src=&quot;./assets/logo.png&quot; /&gt;</span><br><span class=\"line\">  &lt;HelloWorld msg=&quot;Hello Vue 3 + TypeScript + Vite&quot; /&gt;</span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;style&gt;</span><br><span class=\"line\">&lt;/style&gt;</span><br></pre></td></tr></table></figure>\n<p>运行或打包会自动生成components.d.ts文件内容如下：</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// generated by unplugin-vue-components</span></span><br><span class=\"line\"><span class=\"comment\">// We suggest you to commit this file into source control</span></span><br><span class=\"line\"><span class=\"comment\">// Read more: https://github.com/vuejs/vue-next/pull/3399</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">&#x27;@vue/runtime-core&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">declare</span> <span class=\"variable language_\">module</span> <span class=\"string\">&#x27;@vue/runtime-core&#x27;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">GlobalComponents</span> &#123;</span><br><span class=\"line\">    <span class=\"title class_\">HelloWorld</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;./src/components/HelloWorld.vue&#x27;</span>)[<span class=\"string\">&#x27;default&#x27;</span>]</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">export</span> &#123;&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"安装Vant-UI-组件库\"><a href=\"#安装Vant-UI-组件库\" class=\"headerlink\" title=\"安装Vant UI 组件库\"></a>安装Vant UI 组件库</h3><p>安装</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pnpm add vant</span><br></pre></td></tr></table></figure>\n<h3 id=\"vite-plugin-style-import-按需引入组件库样式\"><a href=\"#vite-plugin-style-import-按需引入组件库样式\" class=\"headerlink\" title=\"vite-plugin-style-import - 按需引入组件库样式\"></a>vite-plugin-style-import - 按需引入组件库样式</h3><p>安装</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pnpm install vite-plugin-style-import consola -D</span><br></pre></td></tr></table></figure>\n<p>配置</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; defineConfig &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vue <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vueSetupExtend <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-vue-setup-extend&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> legacy <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-legacy&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> compressPlugin <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-compression&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> viteImagemin <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-imagemin&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">Components</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;unplugin-vue-components/vite&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; <span class=\"title class_\">VantResolver</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;unplugin-vue-components/resolvers&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; createStyleImportPlugin, <span class=\"title class_\">VantResolve</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-style-import&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">// https://vitejs.dev/config/</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title function_\">defineConfig</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">      <span class=\"title function_\">vue</span>(),</span><br><span class=\"line\">    <span class=\"title function_\">vueSetupExtend</span>(),</span><br><span class=\"line\">    <span class=\"title function_\">legacy</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">targets</span>: [<span class=\"string\">&#x27;defaults&#x27;</span>, <span class=\"string\">&#x27;not IE 11&#x27;</span>],</span><br><span class=\"line\">      <span class=\"attr\">additionalLegacyPolyfills</span>: [<span class=\"string\">&#x27;regenerator-runtime/runtime&#x27;</span>]</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"title function_\">compressPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">verbose</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 是否在控制台输出压缩结果</span></span><br><span class=\"line\">      <span class=\"attr\">disable</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 是否禁用</span></span><br><span class=\"line\">      <span class=\"attr\">threshold</span>: <span class=\"number\">10240</span>, <span class=\"comment\">// 文件容量大于这个值进行压缩，它将被压缩，单位为b</span></span><br><span class=\"line\">      <span class=\"attr\">algorithm</span>: <span class=\"string\">&#x27;gzip&#x27;</span>, <span class=\"comment\">// 压缩算法 可选 [&#x27;gzip&#x27;,&#x27;brotliCompress&#x27; ,&#x27;deflate&#x27;,&#x27;deflateRaw&#x27;]</span></span><br><span class=\"line\">      <span class=\"attr\">ext</span>: <span class=\"string\">&#x27;.gz&#x27;</span>, <span class=\"comment\">// 生成的压缩包后缀</span></span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"title function_\">viteImagemin</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">gifsicle</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">optimizationLevel</span>: <span class=\"number\">7</span>,</span><br><span class=\"line\">        <span class=\"attr\">interlaced</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">optipng</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">optimizationLevel</span>: <span class=\"number\">7</span>,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">mozjpeg</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">quality</span>: <span class=\"number\">20</span>,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">pngquant</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">quality</span>: [<span class=\"number\">0.8</span>, <span class=\"number\">0.9</span>],</span><br><span class=\"line\">        <span class=\"attr\">speed</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">svgo</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">name</span>: <span class=\"string\">&#x27;removeViewBox&#x27;</span>,</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">name</span>: <span class=\"string\">&#x27;removeEmptyAttrs&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">active</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"title class_\">Components</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">dirs</span>: [<span class=\"string\">&#x27;src/components&#x27;</span>],</span><br><span class=\"line\">      <span class=\"attr\">resolvers</span>: [<span class=\"title class_\">VantResolver</span>()],</span><br><span class=\"line\">      <span class=\"comment\">// 组件的有效文件扩展名。</span></span><br><span class=\"line\">      <span class=\"attr\">extensions</span>: [<span class=\"string\">&#x27;vue&#x27;</span>],</span><br><span class=\"line\">      <span class=\"comment\">// 允许子目录作为组件的命名空间前缀。</span></span><br><span class=\"line\">      <span class=\"attr\">directoryAsNamespace</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">      <span class=\"attr\">deep</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"title function_\">createStyleImportPlugin</span>(&#123; <span class=\"attr\">resolves</span>: [<span class=\"title class_\">VantResolve</span>()] &#125;),</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>使用vant组件不用手动引入,unplugin-vue-components 按需自动导入组件</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">van-button</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;primary&quot;</span>&gt;</span>主要按钮<span class=\"tag\">&lt;/<span class=\"name\">van-button</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"unplugin-auto-import-API自动导入\"><a href=\"#unplugin-auto-import-API自动导入\" class=\"headerlink\" title=\"unplugin-auto-import - API自动导入\"></a>unplugin-auto-import - API自动导入</h3><p>setup语法让我们不用再一个一个的把变量和方法都return出去就能在模板上使用，大大的解放了我们的双手。然而对于一些常用的VueAPI，比如ref、computed、watch等，还是每次都需要我们在页面上手动进行import { ref } from ‘vue’。<br>可以通过unplugin-auto-import实现自动导入，无需import即可在文件里使用Vue的API。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pnpm install unplugin-auto-import -D</span><br></pre></td></tr></table></figure>\n<p>配置</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; defineConfig &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vue <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vueSetupExtend <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-vue-setup-extend&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> legacy <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-legacy&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> compressPlugin <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-compression&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> viteImagemin <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-imagemin&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">Components</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;unplugin-vue-components/vite&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; <span class=\"title class_\">VantResolver</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;unplugin-vue-components/resolvers&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; createStyleImportPlugin, <span class=\"title class_\">VantResolve</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-style-import&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">AutoImport</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;unplugin-auto-import/vite&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">// https://vitejs.dev/config/</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title function_\">defineConfig</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">      <span class=\"title function_\">vue</span>(),</span><br><span class=\"line\">    <span class=\"title function_\">vueSetupExtend</span>(),</span><br><span class=\"line\">    <span class=\"title function_\">legacy</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">targets</span>: [<span class=\"string\">&#x27;defaults&#x27;</span>, <span class=\"string\">&#x27;not IE 11&#x27;</span>],</span><br><span class=\"line\">      <span class=\"attr\">additionalLegacyPolyfills</span>: [<span class=\"string\">&#x27;regenerator-runtime/runtime&#x27;</span>]</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"title function_\">compressPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">verbose</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 是否在控制台输出压缩结果</span></span><br><span class=\"line\">      <span class=\"attr\">disable</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 是否禁用</span></span><br><span class=\"line\">      <span class=\"attr\">threshold</span>: <span class=\"number\">10240</span>, <span class=\"comment\">// 文件容量大于这个值进行压缩，它将被压缩，单位为b</span></span><br><span class=\"line\">      <span class=\"attr\">algorithm</span>: <span class=\"string\">&#x27;gzip&#x27;</span>, <span class=\"comment\">// 压缩算法 可选 [&#x27;gzip&#x27;,&#x27;brotliCompress&#x27; ,&#x27;deflate&#x27;,&#x27;deflateRaw&#x27;]</span></span><br><span class=\"line\">      <span class=\"attr\">ext</span>: <span class=\"string\">&#x27;.gz&#x27;</span>, <span class=\"comment\">// 生成的压缩包后缀</span></span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"title function_\">viteImagemin</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">gifsicle</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">optimizationLevel</span>: <span class=\"number\">7</span>,</span><br><span class=\"line\">        <span class=\"attr\">interlaced</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">optipng</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">optimizationLevel</span>: <span class=\"number\">7</span>,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">mozjpeg</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">quality</span>: <span class=\"number\">20</span>,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">pngquant</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">quality</span>: [<span class=\"number\">0.8</span>, <span class=\"number\">0.9</span>],</span><br><span class=\"line\">        <span class=\"attr\">speed</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">svgo</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">name</span>: <span class=\"string\">&#x27;removeViewBox&#x27;</span>,</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">name</span>: <span class=\"string\">&#x27;removeEmptyAttrs&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">active</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"title class_\">Components</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">dirs</span>: [<span class=\"string\">&#x27;src/components&#x27;</span>],</span><br><span class=\"line\">      <span class=\"attr\">resolvers</span>: [<span class=\"title class_\">VantResolver</span>()],</span><br><span class=\"line\">      <span class=\"comment\">// 组件的有效文件扩展名。</span></span><br><span class=\"line\">      <span class=\"attr\">extensions</span>: [<span class=\"string\">&#x27;vue&#x27;</span>],</span><br><span class=\"line\">      <span class=\"comment\">// 允许子目录作为组件的命名空间前缀。</span></span><br><span class=\"line\">      <span class=\"attr\">directoryAsNamespace</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">      <span class=\"attr\">deep</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"title function_\">createStyleImportPlugin</span>(&#123; <span class=\"attr\">resolves</span>: [<span class=\"title class_\">VantResolve</span>()] &#125;),</span><br><span class=\"line\">    <span class=\"title class_\">AutoImport</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">imports</span>: [<span class=\"string\">&#x27;vue&#x27;</span>],</span><br><span class=\"line\">      <span class=\"attr\">resolvers</span>: [<span class=\"title class_\">VantResolver</span>(&#123; <span class=\"attr\">importStyle</span>: <span class=\"literal\">false</span> &#125;)]</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>使用</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class=\"line\">const count = ref(0)</span><br><span class=\"line\">const state = reactive(&#123;</span><br><span class=\"line\">  data: &#x27;321&#x27;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">const &#123; data &#125; = toRefs(state)</span><br><span class=\"line\">&lt;/script&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">  &#123;&#123;count&#125;&#125;</span><br><span class=\"line\">  &#123;&#123;data&#125;&#125;</span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;style scoped&gt;</span><br><span class=\"line\">&lt;/style&gt;</span><br></pre></td></tr></table></figure>\n<p>运行或打包会自动生成auto-imports.d.ts文件内容如下：</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Generated by &#x27;unplugin-auto-import&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">// We suggest you to commit this file into source control</span></span><br><span class=\"line\"><span class=\"keyword\">declare</span> <span class=\"variable language_\">global</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">computed</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;computed&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">createApp</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;createApp&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">customRef</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;customRef&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">defineAsyncComponent</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;defineAsyncComponent&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">defineComponent</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;defineComponent&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">effectScope</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;effectScope&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"title class_\">EffectScope</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;EffectScope&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">getCurrentInstance</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;getCurrentInstance&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">getCurrentScope</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;getCurrentScope&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">h</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;h&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">inject</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;inject&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">isReadonly</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;isReadonly&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">isRef</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;isRef&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">markRaw</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;markRaw&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">nextTick</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;nextTick&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">onActivated</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;onActivated&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">onBeforeMount</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;onBeforeMount&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">onBeforeUnmount</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;onBeforeUnmount&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">onBeforeUpdate</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;onBeforeUpdate&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">onDeactivated</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;onDeactivated&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">onErrorCaptured</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;onErrorCaptured&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">onMounted</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;onMounted&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">onRenderTracked</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;onRenderTracked&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">onRenderTriggered</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;onRenderTriggered&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">onScopeDispose</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;onScopeDispose&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">onServerPrefetch</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;onServerPrefetch&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">onUnmounted</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;onUnmounted&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">onUpdated</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;onUpdated&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">provide</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;provide&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">reactive</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;reactive&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">readonly</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;readonly&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">ref</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;ref&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">resolveComponent</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;resolveComponent&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">shallowReactive</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;shallowReactive&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">shallowReadonly</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;shallowReadonly&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">shallowRef</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;shallowRef&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">toRaw</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;toRaw&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">toRef</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;toRef&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">toRefs</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;toRefs&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">triggerRef</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;triggerRef&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">unref</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;unref&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">useAttrs</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;useAttrs&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">useCssModule</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;useCssModule&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">useCssVars</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;useCssVars&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">useSlots</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;useSlots&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">watch</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;watch&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">watchEffect</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;watchEffect&#x27;</span>]</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">export</span> &#123;&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"unplugin-vue-components-自动导入、按需导入组件\"><a href=\"#unplugin-vue-components-自动导入、按需导入组件\" class=\"headerlink\" title=\"unplugin-vue-components - 自动导入、按需导入组件\"></a>unplugin-vue-components - 自动导入、按需导入组件</h3><p>安装</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pnpm install unplugin-vue-components -D</span><br></pre></td></tr></table></figure>\n<p>配置</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// vite.config.ts</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; defineConfig &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vue <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vueSetupExtend <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-vue-setup-extend&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> legacy <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-legacy&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> compressPlugin <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-compression&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> viteImagemin <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-imagemin&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">Components</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;unplugin-vue-components/vite&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; <span class=\"title class_\">ElementPlusResolver</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;unplugin-vue-components/resolvers&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">// https://vitejs.dev/config/</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title function_\">defineConfig</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">    <span class=\"title function_\">vue</span>(),</span><br><span class=\"line\">    ...省略插件配置,</span><br><span class=\"line\">    <span class=\"title class_\">Components</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">dirs</span>: [<span class=\"string\">&#x27;src/components&#x27;</span>],</span><br><span class=\"line\">      <span class=\"attr\">resolvers</span>: [<span class=\"title class_\">ElementPlusResolver</span>()],</span><br><span class=\"line\">      <span class=\"comment\">// 组件的有效文件扩展名。</span></span><br><span class=\"line\">      <span class=\"attr\">extensions</span>: [<span class=\"string\">&#x27;vue&#x27;</span>],</span><br><span class=\"line\">      <span class=\"comment\">// 允许子目录作为组件的命名空间前缀。</span></span><br><span class=\"line\">      <span class=\"attr\">directoryAsNamespace</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">      <span class=\"attr\">deep</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>现在已经注释掉HelloWorld组件引入,项目仍正常运行</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script setup lang=&quot;ts&quot; name=&quot;App&quot;&gt;</span><br><span class=\"line\">// This starter template is using Vue 3 &lt;script setup&gt; SFCs</span><br><span class=\"line\">// Check out https://vuejs.org/api/sfc-script-setup.html#script-setup</span><br><span class=\"line\">// import HelloWorld from &#x27;./components/HelloWorld.vue&#x27;</span><br><span class=\"line\">&lt;/script&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">  &lt;img alt=&quot;Vue logo&quot; src=&quot;./assets/logo.png&quot; /&gt;</span><br><span class=\"line\">  &lt;HelloWorld msg=&quot;Hello Vue 3 + TypeScript + Vite&quot; /&gt;</span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;style&gt;</span><br><span class=\"line\">&lt;/style&gt;</span><br></pre></td></tr></table></figure>\n<p>运行或打包会自动生成components.d.ts文件内容如下：</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// generated by unplugin-vue-components</span></span><br><span class=\"line\"><span class=\"comment\">// We suggest you to commit this file into source control</span></span><br><span class=\"line\"><span class=\"comment\">// Read more: https://github.com/vuejs/vue-next/pull/3399</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">&#x27;@vue/runtime-core&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">declare</span> <span class=\"variable language_\">module</span> <span class=\"string\">&#x27;@vue/runtime-core&#x27;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">export</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">GlobalComponents</span> &#123;</span><br><span class=\"line\">    <span class=\"title class_\">HelloWorld</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;./src/components/HelloWorld.vue&#x27;</span>)[<span class=\"string\">&#x27;default&#x27;</span>]</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">export</span> &#123;&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"安装Vant-UI-组件库\"><a href=\"#安装Vant-UI-组件库\" class=\"headerlink\" title=\"安装Vant UI 组件库\"></a>安装Vant UI 组件库</h3><p>安装</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pnpm add vant</span><br></pre></td></tr></table></figure>\n<h3 id=\"vite-plugin-style-import-按需引入组件库样式\"><a href=\"#vite-plugin-style-import-按需引入组件库样式\" class=\"headerlink\" title=\"vite-plugin-style-import - 按需引入组件库样式\"></a>vite-plugin-style-import - 按需引入组件库样式</h3><p>安装</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pnpm install vite-plugin-style-import consola -D</span><br></pre></td></tr></table></figure>\n<p>配置</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; defineConfig &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vue <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vueSetupExtend <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-vue-setup-extend&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> legacy <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-legacy&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> compressPlugin <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-compression&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> viteImagemin <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-imagemin&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">Components</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;unplugin-vue-components/vite&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; <span class=\"title class_\">VantResolver</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;unplugin-vue-components/resolvers&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; createStyleImportPlugin, <span class=\"title class_\">VantResolve</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-style-import&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">// https://vitejs.dev/config/</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title function_\">defineConfig</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">      <span class=\"title function_\">vue</span>(),</span><br><span class=\"line\">    <span class=\"title function_\">vueSetupExtend</span>(),</span><br><span class=\"line\">    <span class=\"title function_\">legacy</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">targets</span>: [<span class=\"string\">&#x27;defaults&#x27;</span>, <span class=\"string\">&#x27;not IE 11&#x27;</span>],</span><br><span class=\"line\">      <span class=\"attr\">additionalLegacyPolyfills</span>: [<span class=\"string\">&#x27;regenerator-runtime/runtime&#x27;</span>]</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"title function_\">compressPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">verbose</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 是否在控制台输出压缩结果</span></span><br><span class=\"line\">      <span class=\"attr\">disable</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 是否禁用</span></span><br><span class=\"line\">      <span class=\"attr\">threshold</span>: <span class=\"number\">10240</span>, <span class=\"comment\">// 文件容量大于这个值进行压缩，它将被压缩，单位为b</span></span><br><span class=\"line\">      <span class=\"attr\">algorithm</span>: <span class=\"string\">&#x27;gzip&#x27;</span>, <span class=\"comment\">// 压缩算法 可选 [&#x27;gzip&#x27;,&#x27;brotliCompress&#x27; ,&#x27;deflate&#x27;,&#x27;deflateRaw&#x27;]</span></span><br><span class=\"line\">      <span class=\"attr\">ext</span>: <span class=\"string\">&#x27;.gz&#x27;</span>, <span class=\"comment\">// 生成的压缩包后缀</span></span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"title function_\">viteImagemin</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">gifsicle</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">optimizationLevel</span>: <span class=\"number\">7</span>,</span><br><span class=\"line\">        <span class=\"attr\">interlaced</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">optipng</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">optimizationLevel</span>: <span class=\"number\">7</span>,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">mozjpeg</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">quality</span>: <span class=\"number\">20</span>,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">pngquant</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">quality</span>: [<span class=\"number\">0.8</span>, <span class=\"number\">0.9</span>],</span><br><span class=\"line\">        <span class=\"attr\">speed</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">svgo</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">name</span>: <span class=\"string\">&#x27;removeViewBox&#x27;</span>,</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">name</span>: <span class=\"string\">&#x27;removeEmptyAttrs&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">active</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"title class_\">Components</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">dirs</span>: [<span class=\"string\">&#x27;src/components&#x27;</span>],</span><br><span class=\"line\">      <span class=\"attr\">resolvers</span>: [<span class=\"title class_\">VantResolver</span>()],</span><br><span class=\"line\">      <span class=\"comment\">// 组件的有效文件扩展名。</span></span><br><span class=\"line\">      <span class=\"attr\">extensions</span>: [<span class=\"string\">&#x27;vue&#x27;</span>],</span><br><span class=\"line\">      <span class=\"comment\">// 允许子目录作为组件的命名空间前缀。</span></span><br><span class=\"line\">      <span class=\"attr\">directoryAsNamespace</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">      <span class=\"attr\">deep</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"title function_\">createStyleImportPlugin</span>(&#123; <span class=\"attr\">resolves</span>: [<span class=\"title class_\">VantResolve</span>()] &#125;),</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>使用vant组件不用手动引入,unplugin-vue-components 按需自动导入组件</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">van-button</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;primary&quot;</span>&gt;</span>主要按钮<span class=\"tag\">&lt;/<span class=\"name\">van-button</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"unplugin-auto-import-API自动导入\"><a href=\"#unplugin-auto-import-API自动导入\" class=\"headerlink\" title=\"unplugin-auto-import - API自动导入\"></a>unplugin-auto-import - API自动导入</h3><p>setup语法让我们不用再一个一个的把变量和方法都return出去就能在模板上使用，大大的解放了我们的双手。然而对于一些常用的VueAPI，比如ref、computed、watch等，还是每次都需要我们在页面上手动进行import { ref } from ‘vue’。<br>可以通过unplugin-auto-import实现自动导入，无需import即可在文件里使用Vue的API。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pnpm install unplugin-auto-import -D</span><br></pre></td></tr></table></figure>\n<p>配置</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; defineConfig &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vue <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> vueSetupExtend <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-vue-setup-extend&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> legacy <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@vitejs/plugin-legacy&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> compressPlugin <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-compression&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> viteImagemin <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-imagemin&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">Components</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;unplugin-vue-components/vite&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; <span class=\"title class_\">VantResolver</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;unplugin-vue-components/resolvers&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; createStyleImportPlugin, <span class=\"title class_\">VantResolve</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vite-plugin-style-import&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">AutoImport</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;unplugin-auto-import/vite&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">// https://vitejs.dev/config/</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title function_\">defineConfig</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">      <span class=\"title function_\">vue</span>(),</span><br><span class=\"line\">    <span class=\"title function_\">vueSetupExtend</span>(),</span><br><span class=\"line\">    <span class=\"title function_\">legacy</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">targets</span>: [<span class=\"string\">&#x27;defaults&#x27;</span>, <span class=\"string\">&#x27;not IE 11&#x27;</span>],</span><br><span class=\"line\">      <span class=\"attr\">additionalLegacyPolyfills</span>: [<span class=\"string\">&#x27;regenerator-runtime/runtime&#x27;</span>]</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"title function_\">compressPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">verbose</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 是否在控制台输出压缩结果</span></span><br><span class=\"line\">      <span class=\"attr\">disable</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 是否禁用</span></span><br><span class=\"line\">      <span class=\"attr\">threshold</span>: <span class=\"number\">10240</span>, <span class=\"comment\">// 文件容量大于这个值进行压缩，它将被压缩，单位为b</span></span><br><span class=\"line\">      <span class=\"attr\">algorithm</span>: <span class=\"string\">&#x27;gzip&#x27;</span>, <span class=\"comment\">// 压缩算法 可选 [&#x27;gzip&#x27;,&#x27;brotliCompress&#x27; ,&#x27;deflate&#x27;,&#x27;deflateRaw&#x27;]</span></span><br><span class=\"line\">      <span class=\"attr\">ext</span>: <span class=\"string\">&#x27;.gz&#x27;</span>, <span class=\"comment\">// 生成的压缩包后缀</span></span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"title function_\">viteImagemin</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">gifsicle</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">optimizationLevel</span>: <span class=\"number\">7</span>,</span><br><span class=\"line\">        <span class=\"attr\">interlaced</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">optipng</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">optimizationLevel</span>: <span class=\"number\">7</span>,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">mozjpeg</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">quality</span>: <span class=\"number\">20</span>,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">pngquant</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">quality</span>: [<span class=\"number\">0.8</span>, <span class=\"number\">0.9</span>],</span><br><span class=\"line\">        <span class=\"attr\">speed</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">svgo</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">name</span>: <span class=\"string\">&#x27;removeViewBox&#x27;</span>,</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">name</span>: <span class=\"string\">&#x27;removeEmptyAttrs&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">active</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"title class_\">Components</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">dirs</span>: [<span class=\"string\">&#x27;src/components&#x27;</span>],</span><br><span class=\"line\">      <span class=\"attr\">resolvers</span>: [<span class=\"title class_\">VantResolver</span>()],</span><br><span class=\"line\">      <span class=\"comment\">// 组件的有效文件扩展名。</span></span><br><span class=\"line\">      <span class=\"attr\">extensions</span>: [<span class=\"string\">&#x27;vue&#x27;</span>],</span><br><span class=\"line\">      <span class=\"comment\">// 允许子目录作为组件的命名空间前缀。</span></span><br><span class=\"line\">      <span class=\"attr\">directoryAsNamespace</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">      <span class=\"attr\">deep</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"title function_\">createStyleImportPlugin</span>(&#123; <span class=\"attr\">resolves</span>: [<span class=\"title class_\">VantResolve</span>()] &#125;),</span><br><span class=\"line\">    <span class=\"title class_\">AutoImport</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">imports</span>: [<span class=\"string\">&#x27;vue&#x27;</span>],</span><br><span class=\"line\">      <span class=\"attr\">resolvers</span>: [<span class=\"title class_\">VantResolver</span>(&#123; <span class=\"attr\">importStyle</span>: <span class=\"literal\">false</span> &#125;)]</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>使用</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class=\"line\">const count = ref(0)</span><br><span class=\"line\">const state = reactive(&#123;</span><br><span class=\"line\">  data: &#x27;321&#x27;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">const &#123; data &#125; = toRefs(state)</span><br><span class=\"line\">&lt;/script&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">  &#123;&#123;count&#125;&#125;</span><br><span class=\"line\">  &#123;&#123;data&#125;&#125;</span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;style scoped&gt;</span><br><span class=\"line\">&lt;/style&gt;</span><br></pre></td></tr></table></figure>\n<p>运行或打包会自动生成auto-imports.d.ts文件内容如下：</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Generated by &#x27;unplugin-auto-import&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">// We suggest you to commit this file into source control</span></span><br><span class=\"line\"><span class=\"keyword\">declare</span> <span class=\"variable language_\">global</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">computed</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;computed&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">createApp</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;createApp&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">customRef</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;customRef&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">defineAsyncComponent</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;defineAsyncComponent&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">defineComponent</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;defineComponent&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">effectScope</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;effectScope&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"title class_\">EffectScope</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;EffectScope&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">getCurrentInstance</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;getCurrentInstance&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">getCurrentScope</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;getCurrentScope&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">h</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;h&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">inject</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;inject&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">isReadonly</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;isReadonly&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">isRef</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;isRef&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">markRaw</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;markRaw&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">nextTick</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;nextTick&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">onActivated</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;onActivated&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">onBeforeMount</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;onBeforeMount&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">onBeforeUnmount</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;onBeforeUnmount&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">onBeforeUpdate</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;onBeforeUpdate&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">onDeactivated</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;onDeactivated&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">onErrorCaptured</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;onErrorCaptured&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">onMounted</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;onMounted&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">onRenderTracked</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;onRenderTracked&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">onRenderTriggered</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;onRenderTriggered&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">onScopeDispose</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;onScopeDispose&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">onServerPrefetch</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;onServerPrefetch&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">onUnmounted</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;onUnmounted&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">onUpdated</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;onUpdated&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">provide</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;provide&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">reactive</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;reactive&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">readonly</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;readonly&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">ref</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;ref&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">resolveComponent</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;resolveComponent&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">shallowReactive</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;shallowReactive&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">shallowReadonly</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;shallowReadonly&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">shallowRef</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;shallowRef&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">toRaw</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;toRaw&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">toRef</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;toRef&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">toRefs</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;toRefs&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">triggerRef</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;triggerRef&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">unref</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;unref&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">useAttrs</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;useAttrs&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">useCssModule</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;useCssModule&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">useCssVars</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;useCssVars&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">useSlots</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;useSlots&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">watch</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;watch&#x27;</span>]</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"attr\">watchEffect</span>: <span class=\"keyword\">typeof</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;vue&#x27;</span>)[<span class=\"string\">&#x27;watchEffect&#x27;</span>]</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">export</span> &#123;&#125;</span><br></pre></td></tr></table></figure>"},{"title":"pinia","abbrlink":"b51dc851","date":"2022-05-09T07:59:30.000Z","cover":"https://s1.ax1x.com/2022/05/09/OG6eoT.png","top_img":"https://s1.ax1x.com/2022/05/09/OG6YTK.png","_content":"### Pinia与Vuex的不同\nPinia是Vue.js团队开发的一个全新的状态管理库，并且Pinia符合Vuex5的提案，已被纳入官方GitHub。  \nVuex： State、Gettes、Mutations(同步)、Actions(异步)  \nPinia： State、Gettes、Actions(同步异步都支持)  \n### Pinia的核心特性\nPinia没有Mutations、Actions支持同步和异步、没有模块的嵌套结构（每个store互相独立）、更好的TypeScript支持、Vue2和Vue3都支持。\n### 安装\n```shell\npnpm add pinia\n```\n### Pinia初始化设置\nmain.ts文件\n```ts\nimport { createPinia } from 'pinia'\ncreateApp(App).use(createPinia()).mount('#app')\n```\n在store目录下面新建一个user.ts\n```ts\nimport { defineStore } from 'pinia'\nexport const userStore = defineStore('user', {\n    state: () => {\n        return { \n            count: 1\n        }\n    },\n    getters: {\n        getCount() {\n            return this.count\n        }\n    },\n    actions: {\n        doubleCount() {\n            this,count = this.count * 2\n        }\n    }\n})\n```\n### 访问state\n``` vue\n<script setup lang=\"ts\">\nimport { UserStore } from '../store/user'\nimport { computed } from 'vue'\nconst user = UserStore()\nconst count = computed(() => {\n  return user.count\n})\n</script>\n\n<template>\n  <van-button type='primary' @click='user.doubleCount'>Double</van-button>\n  <span>{{count}}</span>\n</template>\n\n<style>\n</style>\n```\n### 异步action\naction支持async/await的语法来支持异步处理的场景。\n``` ts\nimport { defineStore } from 'pinia'\nexport const userStore = defineStore('user', {\n    state: () => {\n        return { \n            count: 1\n        }\n    },\n    getters: {\n        getCount() {\n            return this.count\n        }\n    },\n    actions: {\n        doubleCount() {\n            this.count = this.count * 2\n        },\n        asycn login(account, passWord) {\n            const { data } = await api.login(account, passWord)\n            return data\n        }\n    }\n})\n```","source":"_posts/pinia.md","raw":"---\ntitle: pinia\nabbrlink: b51dc851\ndate: 2022-05-09 15:59:30\ncover: https://s1.ax1x.com/2022/05/09/OG6eoT.png\ntop_img: https://s1.ax1x.com/2022/05/09/OG6YTK.png\ntags: Pinia\n---\n### Pinia与Vuex的不同\nPinia是Vue.js团队开发的一个全新的状态管理库，并且Pinia符合Vuex5的提案，已被纳入官方GitHub。  \nVuex： State、Gettes、Mutations(同步)、Actions(异步)  \nPinia： State、Gettes、Actions(同步异步都支持)  \n### Pinia的核心特性\nPinia没有Mutations、Actions支持同步和异步、没有模块的嵌套结构（每个store互相独立）、更好的TypeScript支持、Vue2和Vue3都支持。\n### 安装\n```shell\npnpm add pinia\n```\n### Pinia初始化设置\nmain.ts文件\n```ts\nimport { createPinia } from 'pinia'\ncreateApp(App).use(createPinia()).mount('#app')\n```\n在store目录下面新建一个user.ts\n```ts\nimport { defineStore } from 'pinia'\nexport const userStore = defineStore('user', {\n    state: () => {\n        return { \n            count: 1\n        }\n    },\n    getters: {\n        getCount() {\n            return this.count\n        }\n    },\n    actions: {\n        doubleCount() {\n            this,count = this.count * 2\n        }\n    }\n})\n```\n### 访问state\n``` vue\n<script setup lang=\"ts\">\nimport { UserStore } from '../store/user'\nimport { computed } from 'vue'\nconst user = UserStore()\nconst count = computed(() => {\n  return user.count\n})\n</script>\n\n<template>\n  <van-button type='primary' @click='user.doubleCount'>Double</van-button>\n  <span>{{count}}</span>\n</template>\n\n<style>\n</style>\n```\n### 异步action\naction支持async/await的语法来支持异步处理的场景。\n``` ts\nimport { defineStore } from 'pinia'\nexport const userStore = defineStore('user', {\n    state: () => {\n        return { \n            count: 1\n        }\n    },\n    getters: {\n        getCount() {\n            return this.count\n        }\n    },\n    actions: {\n        doubleCount() {\n            this.count = this.count * 2\n        },\n        asycn login(account, passWord) {\n            const { data } = await api.login(account, passWord)\n            return data\n        }\n    }\n})\n```","slug":"pinia","published":1,"updated":"2022-05-10T08:17:08.304Z","_id":"cl2yfocqf0000bovnh1d51htu","comments":1,"layout":"post","photos":[],"link":"","content":"<h3 id=\"Pinia与Vuex的不同\"><a href=\"#Pinia与Vuex的不同\" class=\"headerlink\" title=\"Pinia与Vuex的不同\"></a>Pinia与Vuex的不同</h3><p>Pinia是Vue.js团队开发的一个全新的状态管理库，并且Pinia符合Vuex5的提案，已被纳入官方GitHub。<br>Vuex： State、Gettes、Mutations(同步)、Actions(异步)<br>Pinia： State、Gettes、Actions(同步异步都支持)  </p>\n<h3 id=\"Pinia的核心特性\"><a href=\"#Pinia的核心特性\" class=\"headerlink\" title=\"Pinia的核心特性\"></a>Pinia的核心特性</h3><p>Pinia没有Mutations、Actions支持同步和异步、没有模块的嵌套结构（每个store互相独立）、更好的TypeScript支持、Vue2和Vue3都支持。</p>\n<h3 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pnpm add pinia</span><br></pre></td></tr></table></figure>\n<h3 id=\"Pinia初始化设置\"><a href=\"#Pinia初始化设置\" class=\"headerlink\" title=\"Pinia初始化设置\"></a>Pinia初始化设置</h3><p>main.ts文件</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; createPinia &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;pinia&#x27;</span></span><br><span class=\"line\"><span class=\"title function_\">createApp</span>(<span class=\"title class_\">App</span>).<span class=\"title function_\">use</span>(<span class=\"title function_\">createPinia</span>()).<span class=\"title function_\">mount</span>(<span class=\"string\">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<p>在store目录下面新建一个user.ts</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; defineStore &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;pinia&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> userStore = <span class=\"title function_\">defineStore</span>(<span class=\"string\">&#x27;user&#x27;</span>, &#123;</span><br><span class=\"line\">    <span class=\"attr\">state</span>: <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> &#123; </span><br><span class=\"line\">            <span class=\"attr\">count</span>: <span class=\"number\">1</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">getters</span>: &#123;</span><br><span class=\"line\">        <span class=\"title function_\">getCount</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.<span class=\"property\">count</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">actions</span>: &#123;</span><br><span class=\"line\">        <span class=\"title function_\">doubleCount</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>,count = <span class=\"variable language_\">this</span>.<span class=\"property\">count</span> * <span class=\"number\">2</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<h3 id=\"访问state\"><a href=\"#访问state\" class=\"headerlink\" title=\"访问state\"></a>访问state</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class=\"line\">import &#123; UserStore &#125; from &#x27;../store/user&#x27;</span><br><span class=\"line\">import &#123; computed &#125; from &#x27;vue&#x27;</span><br><span class=\"line\">const user = UserStore()</span><br><span class=\"line\">const count = computed(() =&gt; &#123;</span><br><span class=\"line\">  return user.count</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">&lt;/script&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">  &lt;van-button type=&#x27;primary&#x27; @click=&#x27;user.doubleCount&#x27;&gt;Double&lt;/van-button&gt;</span><br><span class=\"line\">  &lt;span&gt;&#123;&#123;count&#125;&#125;&lt;/span&gt;</span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;style&gt;</span><br><span class=\"line\">&lt;/style&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"异步action\"><a href=\"#异步action\" class=\"headerlink\" title=\"异步action\"></a>异步action</h3><p>action支持async&#x2F;await的语法来支持异步处理的场景。</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; defineStore &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;pinia&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> userStore = <span class=\"title function_\">defineStore</span>(<span class=\"string\">&#x27;user&#x27;</span>, &#123;</span><br><span class=\"line\">    <span class=\"attr\">state</span>: <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> &#123; </span><br><span class=\"line\">            <span class=\"attr\">count</span>: <span class=\"number\">1</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">getters</span>: &#123;</span><br><span class=\"line\">        <span class=\"title function_\">getCount</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.<span class=\"property\">count</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">actions</span>: &#123;</span><br><span class=\"line\">        <span class=\"title function_\">doubleCount</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.<span class=\"property\">count</span> = <span class=\"variable language_\">this</span>.<span class=\"property\">count</span> * <span class=\"number\">2</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        asycn <span class=\"title function_\">login</span>(<span class=\"params\">account, passWord</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">const</span> &#123; data &#125; = <span class=\"keyword\">await</span> api.<span class=\"title function_\">login</span>(account, passWord)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> data</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"Pinia与Vuex的不同\"><a href=\"#Pinia与Vuex的不同\" class=\"headerlink\" title=\"Pinia与Vuex的不同\"></a>Pinia与Vuex的不同</h3><p>Pinia是Vue.js团队开发的一个全新的状态管理库，并且Pinia符合Vuex5的提案，已被纳入官方GitHub。<br>Vuex： State、Gettes、Mutations(同步)、Actions(异步)<br>Pinia： State、Gettes、Actions(同步异步都支持)  </p>\n<h3 id=\"Pinia的核心特性\"><a href=\"#Pinia的核心特性\" class=\"headerlink\" title=\"Pinia的核心特性\"></a>Pinia的核心特性</h3><p>Pinia没有Mutations、Actions支持同步和异步、没有模块的嵌套结构（每个store互相独立）、更好的TypeScript支持、Vue2和Vue3都支持。</p>\n<h3 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pnpm add pinia</span><br></pre></td></tr></table></figure>\n<h3 id=\"Pinia初始化设置\"><a href=\"#Pinia初始化设置\" class=\"headerlink\" title=\"Pinia初始化设置\"></a>Pinia初始化设置</h3><p>main.ts文件</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; createPinia &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;pinia&#x27;</span></span><br><span class=\"line\"><span class=\"title function_\">createApp</span>(<span class=\"title class_\">App</span>).<span class=\"title function_\">use</span>(<span class=\"title function_\">createPinia</span>()).<span class=\"title function_\">mount</span>(<span class=\"string\">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<p>在store目录下面新建一个user.ts</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; defineStore &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;pinia&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> userStore = <span class=\"title function_\">defineStore</span>(<span class=\"string\">&#x27;user&#x27;</span>, &#123;</span><br><span class=\"line\">    <span class=\"attr\">state</span>: <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> &#123; </span><br><span class=\"line\">            <span class=\"attr\">count</span>: <span class=\"number\">1</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">getters</span>: &#123;</span><br><span class=\"line\">        <span class=\"title function_\">getCount</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.<span class=\"property\">count</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">actions</span>: &#123;</span><br><span class=\"line\">        <span class=\"title function_\">doubleCount</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>,count = <span class=\"variable language_\">this</span>.<span class=\"property\">count</span> * <span class=\"number\">2</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<h3 id=\"访问state\"><a href=\"#访问state\" class=\"headerlink\" title=\"访问state\"></a>访问state</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class=\"line\">import &#123; UserStore &#125; from &#x27;../store/user&#x27;</span><br><span class=\"line\">import &#123; computed &#125; from &#x27;vue&#x27;</span><br><span class=\"line\">const user = UserStore()</span><br><span class=\"line\">const count = computed(() =&gt; &#123;</span><br><span class=\"line\">  return user.count</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">&lt;/script&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">  &lt;van-button type=&#x27;primary&#x27; @click=&#x27;user.doubleCount&#x27;&gt;Double&lt;/van-button&gt;</span><br><span class=\"line\">  &lt;span&gt;&#123;&#123;count&#125;&#125;&lt;/span&gt;</span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;style&gt;</span><br><span class=\"line\">&lt;/style&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"异步action\"><a href=\"#异步action\" class=\"headerlink\" title=\"异步action\"></a>异步action</h3><p>action支持async&#x2F;await的语法来支持异步处理的场景。</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; defineStore &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;pinia&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> userStore = <span class=\"title function_\">defineStore</span>(<span class=\"string\">&#x27;user&#x27;</span>, &#123;</span><br><span class=\"line\">    <span class=\"attr\">state</span>: <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> &#123; </span><br><span class=\"line\">            <span class=\"attr\">count</span>: <span class=\"number\">1</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">getters</span>: &#123;</span><br><span class=\"line\">        <span class=\"title function_\">getCount</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.<span class=\"property\">count</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">actions</span>: &#123;</span><br><span class=\"line\">        <span class=\"title function_\">doubleCount</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.<span class=\"property\">count</span> = <span class=\"variable language_\">this</span>.<span class=\"property\">count</span> * <span class=\"number\">2</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        asycn <span class=\"title function_\">login</span>(<span class=\"params\">account, passWord</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">const</span> &#123; data &#125; = <span class=\"keyword\">await</span> api.<span class=\"title function_\">login</span>(account, passWord)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> data</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>"},{"title":"router","abbrlink":"45d2f225","date":"2022-05-09T09:28:11.000Z","cover":"https://s1.ax1x.com/2022/04/29/LvoXHe.png","top_img":"https://s1.ax1x.com/2022/04/29/LvTVEQ.jpg","_content":"vite现在创建的vue项目已经默认为vue3了，但是在引入vue-router时，可能会有vue-router报错问题，一直提示createRouter为undefined或者其他的关于vue-router报错的问题，主要原始是vue-router版本问题，直接升级到最新版本即可：\n```shell\npnpm add vue-router@next\n```\n### 项目配置\n创建router目录新建index.ts\n```ts\nimport { createRouter, createWebHistory, RouteRecordRaw } from 'vue-router'\nconst routes: Array<RouteRecordRaw> = [\n    {\n        path: '/',\n        name: 'Home',\n        component: () => import('../views/page1.vue'),\n        meta: {\n            title: 'Home'\n        }\n    },\n    {\n        path: '/page2',\n        name: 'Page2',\n        component: () => import('../views/page2.vue'),\n        meta: {\n            title: 'Page2'\n        }\n    }\n]\nconst router = createRouter({\n    history: createWebHistory(),\n    routes\n})\nexport default router\n```\n### main.ts文件配置\n```ts\nimport { createApp } from 'vue'\nimport App from './App.vue'\nimport router from './router'\nimport { setupStore } from './store'\n\nasync function bootStrap() {\n  const app = createApp(App)\n  setupStore(app)\n  app.use(router).mount('#app')\n}\nbootStrap()\n```\n### 路由守卫配置\nrouter目录下创建guard.ts\n```ts\nimport { Router } from 'vue-router'\n\nexport const setupRouterGuard = (router: Router) => {\n  router.beforeEach((to, from, next) => {\n    // @ts-ignore\n    document.title = to.meta.title // 路由对应的网页标签title\n    next()\n  })\n}\n```\nrouter目录下的index.ts文件配置\n```ts\nimport { createRouter, createWebHistory, RouteRecordRaw } from 'vue-router'\nimport { setupRouterGuard } from './guard'\nconst routes: Array<RouteRecordRaw> = [\n  {\n    path: '/',\n    name: 'Home',\n    component: () => import('../views/page1.vue'),\n    meta: {\n      title: 'Home'\n    }\n  },\n  {\n    path: '/page2',\n    name: 'Page2',\n    component: () => import('../views/page2.vue'),\n    meta: {\n      title: 'Page2'\n    }\n  }\n]\nconst router = createRouter({\n  history: createWebHistory(),\n  routes\n})\nsetupRouterGuard(router)\nexport default router\n```","source":"_posts/router.md","raw":"---\ntitle: router\nabbrlink: 45d2f225\ndate: 2022-05-09 17:28:11\ntags: Vue\ncover: https://s1.ax1x.com/2022/04/29/LvoXHe.png\ntop_img: https://s1.ax1x.com/2022/04/29/LvTVEQ.jpg\n---\nvite现在创建的vue项目已经默认为vue3了，但是在引入vue-router时，可能会有vue-router报错问题，一直提示createRouter为undefined或者其他的关于vue-router报错的问题，主要原始是vue-router版本问题，直接升级到最新版本即可：\n```shell\npnpm add vue-router@next\n```\n### 项目配置\n创建router目录新建index.ts\n```ts\nimport { createRouter, createWebHistory, RouteRecordRaw } from 'vue-router'\nconst routes: Array<RouteRecordRaw> = [\n    {\n        path: '/',\n        name: 'Home',\n        component: () => import('../views/page1.vue'),\n        meta: {\n            title: 'Home'\n        }\n    },\n    {\n        path: '/page2',\n        name: 'Page2',\n        component: () => import('../views/page2.vue'),\n        meta: {\n            title: 'Page2'\n        }\n    }\n]\nconst router = createRouter({\n    history: createWebHistory(),\n    routes\n})\nexport default router\n```\n### main.ts文件配置\n```ts\nimport { createApp } from 'vue'\nimport App from './App.vue'\nimport router from './router'\nimport { setupStore } from './store'\n\nasync function bootStrap() {\n  const app = createApp(App)\n  setupStore(app)\n  app.use(router).mount('#app')\n}\nbootStrap()\n```\n### 路由守卫配置\nrouter目录下创建guard.ts\n```ts\nimport { Router } from 'vue-router'\n\nexport const setupRouterGuard = (router: Router) => {\n  router.beforeEach((to, from, next) => {\n    // @ts-ignore\n    document.title = to.meta.title // 路由对应的网页标签title\n    next()\n  })\n}\n```\nrouter目录下的index.ts文件配置\n```ts\nimport { createRouter, createWebHistory, RouteRecordRaw } from 'vue-router'\nimport { setupRouterGuard } from './guard'\nconst routes: Array<RouteRecordRaw> = [\n  {\n    path: '/',\n    name: 'Home',\n    component: () => import('../views/page1.vue'),\n    meta: {\n      title: 'Home'\n    }\n  },\n  {\n    path: '/page2',\n    name: 'Page2',\n    component: () => import('../views/page2.vue'),\n    meta: {\n      title: 'Page2'\n    }\n  }\n]\nconst router = createRouter({\n  history: createWebHistory(),\n  routes\n})\nsetupRouterGuard(router)\nexport default router\n```","slug":"router","published":1,"updated":"2022-05-09T10:06:03.377Z","_id":"cl2yiuekw00006kvn4ah61oxw","comments":1,"layout":"post","photos":[],"link":"","content":"<p>vite现在创建的vue项目已经默认为vue3了，但是在引入vue-router时，可能会有vue-router报错问题，一直提示createRouter为undefined或者其他的关于vue-router报错的问题，主要原始是vue-router版本问题，直接升级到最新版本即可：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pnpm add vue-router@next</span><br></pre></td></tr></table></figure>\n<h3 id=\"项目配置\"><a href=\"#项目配置\" class=\"headerlink\" title=\"项目配置\"></a>项目配置</h3><p>创建router目录新建index.ts</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; createRouter, createWebHistory, <span class=\"title class_\">RouteRecordRaw</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue-router&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"attr\">routes</span>: <span class=\"title class_\">Array</span>&lt;<span class=\"title class_\">RouteRecordRaw</span>&gt; = [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"attr\">path</span>: <span class=\"string\">&#x27;/&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">name</span>: <span class=\"string\">&#x27;Home&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">component</span>: <span class=\"function\">() =&gt;</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;../views/page1.vue&#x27;</span>),</span><br><span class=\"line\">        <span class=\"attr\">meta</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">title</span>: <span class=\"string\">&#x27;Home&#x27;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"attr\">path</span>: <span class=\"string\">&#x27;/page2&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">name</span>: <span class=\"string\">&#x27;Page2&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">component</span>: <span class=\"function\">() =&gt;</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;../views/page2.vue&#x27;</span>),</span><br><span class=\"line\">        <span class=\"attr\">meta</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">title</span>: <span class=\"string\">&#x27;Page2&#x27;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">]</span><br><span class=\"line\"><span class=\"keyword\">const</span> router = <span class=\"title function_\">createRouter</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">history</span>: <span class=\"title function_\">createWebHistory</span>(),</span><br><span class=\"line\">    routes</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> router</span><br></pre></td></tr></table></figure>\n<h3 id=\"main-ts文件配置\"><a href=\"#main-ts文件配置\" class=\"headerlink\" title=\"main.ts文件配置\"></a>main.ts文件配置</h3><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; createApp &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">App</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./App.vue&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> router <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./router&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; setupStore &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./store&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">async</span> <span class=\"keyword\">function</span> <span class=\"title function_\">bootStrap</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> app = <span class=\"title function_\">createApp</span>(<span class=\"title class_\">App</span>)</span><br><span class=\"line\">  <span class=\"title function_\">setupStore</span>(app)</span><br><span class=\"line\">  app.<span class=\"title function_\">use</span>(router).<span class=\"title function_\">mount</span>(<span class=\"string\">&#x27;#app&#x27;</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"title function_\">bootStrap</span>()</span><br></pre></td></tr></table></figure>\n<h3 id=\"路由守卫配置\"><a href=\"#路由守卫配置\" class=\"headerlink\" title=\"路由守卫配置\"></a>路由守卫配置</h3><p>router目录下创建guard.ts</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; <span class=\"title class_\">Router</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue-router&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> <span class=\"title function_\">setupRouterGuard</span> = (<span class=\"params\">router: Router</span>) =&gt; &#123;</span><br><span class=\"line\">  router.<span class=\"title function_\">beforeEach</span>(<span class=\"function\">(<span class=\"params\">to, <span class=\"keyword\">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// @ts-ignore</span></span><br><span class=\"line\">    <span class=\"variable language_\">document</span>.<span class=\"property\">title</span> = to.<span class=\"property\">meta</span>.<span class=\"property\">title</span> <span class=\"comment\">// 路由对应的网页标签title</span></span><br><span class=\"line\">    <span class=\"title function_\">next</span>()</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>router目录下的index.ts文件配置</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; createRouter, createWebHistory, <span class=\"title class_\">RouteRecordRaw</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue-router&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; setupRouterGuard &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./guard&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"attr\">routes</span>: <span class=\"title class_\">Array</span>&lt;<span class=\"title class_\">RouteRecordRaw</span>&gt; = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"attr\">path</span>: <span class=\"string\">&#x27;/&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">&#x27;Home&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">component</span>: <span class=\"function\">() =&gt;</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;../views/page1.vue&#x27;</span>),</span><br><span class=\"line\">    <span class=\"attr\">meta</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">title</span>: <span class=\"string\">&#x27;Home&#x27;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"attr\">path</span>: <span class=\"string\">&#x27;/page2&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">&#x27;Page2&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">component</span>: <span class=\"function\">() =&gt;</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;../views/page2.vue&#x27;</span>),</span><br><span class=\"line\">    <span class=\"attr\">meta</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">title</span>: <span class=\"string\">&#x27;Page2&#x27;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">]</span><br><span class=\"line\"><span class=\"keyword\">const</span> router = <span class=\"title function_\">createRouter</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">history</span>: <span class=\"title function_\">createWebHistory</span>(),</span><br><span class=\"line\">  routes</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"title function_\">setupRouterGuard</span>(router)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> router</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<p>vite现在创建的vue项目已经默认为vue3了，但是在引入vue-router时，可能会有vue-router报错问题，一直提示createRouter为undefined或者其他的关于vue-router报错的问题，主要原始是vue-router版本问题，直接升级到最新版本即可：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pnpm add vue-router@next</span><br></pre></td></tr></table></figure>\n<h3 id=\"项目配置\"><a href=\"#项目配置\" class=\"headerlink\" title=\"项目配置\"></a>项目配置</h3><p>创建router目录新建index.ts</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; createRouter, createWebHistory, <span class=\"title class_\">RouteRecordRaw</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue-router&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"attr\">routes</span>: <span class=\"title class_\">Array</span>&lt;<span class=\"title class_\">RouteRecordRaw</span>&gt; = [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"attr\">path</span>: <span class=\"string\">&#x27;/&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">name</span>: <span class=\"string\">&#x27;Home&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">component</span>: <span class=\"function\">() =&gt;</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;../views/page1.vue&#x27;</span>),</span><br><span class=\"line\">        <span class=\"attr\">meta</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">title</span>: <span class=\"string\">&#x27;Home&#x27;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"attr\">path</span>: <span class=\"string\">&#x27;/page2&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">name</span>: <span class=\"string\">&#x27;Page2&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">component</span>: <span class=\"function\">() =&gt;</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;../views/page2.vue&#x27;</span>),</span><br><span class=\"line\">        <span class=\"attr\">meta</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">title</span>: <span class=\"string\">&#x27;Page2&#x27;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">]</span><br><span class=\"line\"><span class=\"keyword\">const</span> router = <span class=\"title function_\">createRouter</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">history</span>: <span class=\"title function_\">createWebHistory</span>(),</span><br><span class=\"line\">    routes</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> router</span><br></pre></td></tr></table></figure>\n<h3 id=\"main-ts文件配置\"><a href=\"#main-ts文件配置\" class=\"headerlink\" title=\"main.ts文件配置\"></a>main.ts文件配置</h3><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; createApp &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">App</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./App.vue&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> router <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./router&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; setupStore &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./store&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">async</span> <span class=\"keyword\">function</span> <span class=\"title function_\">bootStrap</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> app = <span class=\"title function_\">createApp</span>(<span class=\"title class_\">App</span>)</span><br><span class=\"line\">  <span class=\"title function_\">setupStore</span>(app)</span><br><span class=\"line\">  app.<span class=\"title function_\">use</span>(router).<span class=\"title function_\">mount</span>(<span class=\"string\">&#x27;#app&#x27;</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"title function_\">bootStrap</span>()</span><br></pre></td></tr></table></figure>\n<h3 id=\"路由守卫配置\"><a href=\"#路由守卫配置\" class=\"headerlink\" title=\"路由守卫配置\"></a>路由守卫配置</h3><p>router目录下创建guard.ts</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; <span class=\"title class_\">Router</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue-router&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> <span class=\"title function_\">setupRouterGuard</span> = (<span class=\"params\">router: Router</span>) =&gt; &#123;</span><br><span class=\"line\">  router.<span class=\"title function_\">beforeEach</span>(<span class=\"function\">(<span class=\"params\">to, <span class=\"keyword\">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// @ts-ignore</span></span><br><span class=\"line\">    <span class=\"variable language_\">document</span>.<span class=\"property\">title</span> = to.<span class=\"property\">meta</span>.<span class=\"property\">title</span> <span class=\"comment\">// 路由对应的网页标签title</span></span><br><span class=\"line\">    <span class=\"title function_\">next</span>()</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>router目录下的index.ts文件配置</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; createRouter, createWebHistory, <span class=\"title class_\">RouteRecordRaw</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue-router&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; setupRouterGuard &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./guard&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"attr\">routes</span>: <span class=\"title class_\">Array</span>&lt;<span class=\"title class_\">RouteRecordRaw</span>&gt; = [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"attr\">path</span>: <span class=\"string\">&#x27;/&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">&#x27;Home&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">component</span>: <span class=\"function\">() =&gt;</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;../views/page1.vue&#x27;</span>),</span><br><span class=\"line\">    <span class=\"attr\">meta</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">title</span>: <span class=\"string\">&#x27;Home&#x27;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"attr\">path</span>: <span class=\"string\">&#x27;/page2&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">&#x27;Page2&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">component</span>: <span class=\"function\">() =&gt;</span> <span class=\"title function_\">import</span>(<span class=\"string\">&#x27;../views/page2.vue&#x27;</span>),</span><br><span class=\"line\">    <span class=\"attr\">meta</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">title</span>: <span class=\"string\">&#x27;Page2&#x27;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">]</span><br><span class=\"line\"><span class=\"keyword\">const</span> router = <span class=\"title function_\">createRouter</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">history</span>: <span class=\"title function_\">createWebHistory</span>(),</span><br><span class=\"line\">  routes</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"title function_\">setupRouterGuard</span>(router)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> router</span><br></pre></td></tr></table></figure>"},{"title":"Web3.js安装使用方法","abbrlink":"71ab26c1","date":"2022-05-10T07:52:10.000Z","cover":"https://s1.ax1x.com/2022/05/10/OtyPTx.jpg","top_img":"https://s1.ax1x.com/2022/05/10/OtyvUP.jpg","_content":"### web3.js 库是一系列模块的集合，服务于以太坊生态系统的各个功能，如：\nweb3-eth 用来与以太坊区块链及合约的交互  \nweb3-shh Whisper 协议相关，进行p2p通信和广播  \nweb3-bzz swarm 协议（去中心化文件存储）相关  \nweb3-utils 包含一些对 DApp 开发者有用的方法  \n### 引入web3.js\n```shell\npnpm add web3\n```\n### 项目构建web3文件\n在utils目录下新建useWeb3.ts\n```ts\nimport { UserStore } from 'store/modules/user'\nexport function useWeb3() {\n    // 获取钱包地址\n    async function getAccount(): Promise<any> {\n        return new Promise((async (resolve, reject) => {\n            await isMetamask()\n                .then((res: string) => {\n                    // 获取钱包地址授权\n                    window.ethereum.request({method: 'eth_requestAccounts'})\n                        .then((res: string[]) => {\n                            resolve(res)\n                        })\n                        .catch((res: string[]) => {\n                            reject(res)\n                        })\n                })\n                .catch((res: string) => {\n                    reject(res)\n                })\n        }))\n    }\n    function isMetamask(): Promise<string> {\n        return new Promise((resolve, reject) => {\n            // 这一步骤是判断当前访问浏览器是否安装MetaMask\n            if (typeof window.ethereum !== 'undefined') {\n                resolve('MetaMask is installed!')\n            } else {\n                reject('MetaMask is uninstalled!')\n            }\n        })\n    }\n    return {\n        getAccount\n    }\n}\n```\n### 配合store使用，将钱包地址存储到store里面并显示出来\nstore.ts文件\n```ts\nimport { defineStore } from 'pinia'\nimport { useWeb3 } from 'src/utils/useWeb3'\nimport { store } from '../index'\ninterface UserState {\n  walletAddress: string | null\n}\nexport const useUserStore = defineStore({\n  id: 'app-user',\n  state: (): UserState => ({\n    walletAddress: null\n  }),\n  getters: {\n    getWalletAddress(): string | null {\n        // 将store里存储的钱包地址Return出去\n      return this.walletAddress\n    }\n  },\n  actions: {\n    setWalletAddress(walletAddress: any | null) {\n        // 获取钱包地址后存储到store里面\n      this.walletAddress = walletAddress\n    },\n    async getWallet () {\n        // 获取小狐狸授权，并获取钱包地址\n      const { getAccount } = useWeb3()\n      const account = await getAccount()\n      this.setWalletAddress(account[0])\n    }\n  }\n})\nexport function UserStore() {\n  return useUserStore(store)\n}\n```\n### 项目文件使用方法\n``` vue\n<script setup lang=\"ts\">\nimport { UserStore } from 'store/modules/user'\nimport { computed } from 'vue'\nconst user = UserStore()\nconst getAddress = async () => {\n  await user.getWallet()\n}\nconst walletAddress = computed((): string | null => {\n  return user.getWalletAddress\n})\n</script>\n\n<template>\n  <ElButton @click=\"getAddress\" type=\"primary\">连接钱包</ElButton>\n  <div>钱包地址：{{walletAddress}}</div>\n</template>\n\n<style scoped>\n</style>\n```","source":"_posts/web3.md","raw":"---\ntitle: Web3.js安装使用方法\nabbrlink: 71ab26c1\ndate: 2022-05-10 15:52:10\ncover: https://s1.ax1x.com/2022/05/10/OtyPTx.jpg\ntop_img: https://s1.ax1x.com/2022/05/10/OtyvUP.jpg\ntags: Web3.js\n---\n### web3.js 库是一系列模块的集合，服务于以太坊生态系统的各个功能，如：\nweb3-eth 用来与以太坊区块链及合约的交互  \nweb3-shh Whisper 协议相关，进行p2p通信和广播  \nweb3-bzz swarm 协议（去中心化文件存储）相关  \nweb3-utils 包含一些对 DApp 开发者有用的方法  \n### 引入web3.js\n```shell\npnpm add web3\n```\n### 项目构建web3文件\n在utils目录下新建useWeb3.ts\n```ts\nimport { UserStore } from 'store/modules/user'\nexport function useWeb3() {\n    // 获取钱包地址\n    async function getAccount(): Promise<any> {\n        return new Promise((async (resolve, reject) => {\n            await isMetamask()\n                .then((res: string) => {\n                    // 获取钱包地址授权\n                    window.ethereum.request({method: 'eth_requestAccounts'})\n                        .then((res: string[]) => {\n                            resolve(res)\n                        })\n                        .catch((res: string[]) => {\n                            reject(res)\n                        })\n                })\n                .catch((res: string) => {\n                    reject(res)\n                })\n        }))\n    }\n    function isMetamask(): Promise<string> {\n        return new Promise((resolve, reject) => {\n            // 这一步骤是判断当前访问浏览器是否安装MetaMask\n            if (typeof window.ethereum !== 'undefined') {\n                resolve('MetaMask is installed!')\n            } else {\n                reject('MetaMask is uninstalled!')\n            }\n        })\n    }\n    return {\n        getAccount\n    }\n}\n```\n### 配合store使用，将钱包地址存储到store里面并显示出来\nstore.ts文件\n```ts\nimport { defineStore } from 'pinia'\nimport { useWeb3 } from 'src/utils/useWeb3'\nimport { store } from '../index'\ninterface UserState {\n  walletAddress: string | null\n}\nexport const useUserStore = defineStore({\n  id: 'app-user',\n  state: (): UserState => ({\n    walletAddress: null\n  }),\n  getters: {\n    getWalletAddress(): string | null {\n        // 将store里存储的钱包地址Return出去\n      return this.walletAddress\n    }\n  },\n  actions: {\n    setWalletAddress(walletAddress: any | null) {\n        // 获取钱包地址后存储到store里面\n      this.walletAddress = walletAddress\n    },\n    async getWallet () {\n        // 获取小狐狸授权，并获取钱包地址\n      const { getAccount } = useWeb3()\n      const account = await getAccount()\n      this.setWalletAddress(account[0])\n    }\n  }\n})\nexport function UserStore() {\n  return useUserStore(store)\n}\n```\n### 项目文件使用方法\n``` vue\n<script setup lang=\"ts\">\nimport { UserStore } from 'store/modules/user'\nimport { computed } from 'vue'\nconst user = UserStore()\nconst getAddress = async () => {\n  await user.getWallet()\n}\nconst walletAddress = computed((): string | null => {\n  return user.getWalletAddress\n})\n</script>\n\n<template>\n  <ElButton @click=\"getAddress\" type=\"primary\">连接钱包</ElButton>\n  <div>钱包地址：{{walletAddress}}</div>\n</template>\n\n<style scoped>\n</style>\n```","slug":"web3","published":1,"updated":"2022-05-10T08:17:08.333Z","_id":"cl2zuujf60000a8vn4331bbhv","comments":1,"layout":"post","photos":[],"link":"","content":"<h3 id=\"web3-js-库是一系列模块的集合，服务于以太坊生态系统的各个功能，如：\"><a href=\"#web3-js-库是一系列模块的集合，服务于以太坊生态系统的各个功能，如：\" class=\"headerlink\" title=\"web3.js 库是一系列模块的集合，服务于以太坊生态系统的各个功能，如：\"></a>web3.js 库是一系列模块的集合，服务于以太坊生态系统的各个功能，如：</h3><p>web3-eth 用来与以太坊区块链及合约的交互<br>web3-shh Whisper 协议相关，进行p2p通信和广播<br>web3-bzz swarm 协议（去中心化文件存储）相关<br>web3-utils 包含一些对 DApp 开发者有用的方法  </p>\n<h3 id=\"引入web3-js\"><a href=\"#引入web3-js\" class=\"headerlink\" title=\"引入web3.js\"></a>引入web3.js</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pnpm add web3</span><br></pre></td></tr></table></figure>\n<h3 id=\"项目构建web3文件\"><a href=\"#项目构建web3文件\" class=\"headerlink\" title=\"项目构建web3文件\"></a>项目构建web3文件</h3><p>在utils目录下新建useWeb3.ts</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; <span class=\"title class_\">UserStore</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;store/modules/user&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">function</span> <span class=\"title function_\">useWeb3</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 获取钱包地址</span></span><br><span class=\"line\">    <span class=\"keyword\">async</span> <span class=\"keyword\">function</span> <span class=\"title function_\">getAccount</span>(<span class=\"params\"></span>): <span class=\"title class_\">Promise</span>&lt;<span class=\"built_in\">any</span>&gt; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>((<span class=\"keyword\">async</span> (resolve, reject) =&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">await</span> <span class=\"title function_\">isMetamask</span>()</span><br><span class=\"line\">                .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res: <span class=\"built_in\">string</span></span>) =&gt;</span> &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// 获取钱包地址授权</span></span><br><span class=\"line\">                    <span class=\"variable language_\">window</span>.<span class=\"property\">ethereum</span>.<span class=\"title function_\">request</span>(&#123;<span class=\"attr\">method</span>: <span class=\"string\">&#x27;eth_requestAccounts&#x27;</span>&#125;)</span><br><span class=\"line\">                        .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res: <span class=\"built_in\">string</span>[]</span>) =&gt;</span> &#123;</span><br><span class=\"line\">                            <span class=\"title function_\">resolve</span>(res)</span><br><span class=\"line\">                        &#125;)</span><br><span class=\"line\">                        .<span class=\"title function_\">catch</span>(<span class=\"function\">(<span class=\"params\">res: <span class=\"built_in\">string</span>[]</span>) =&gt;</span> &#123;</span><br><span class=\"line\">                            <span class=\"title function_\">reject</span>(res)</span><br><span class=\"line\">                        &#125;)</span><br><span class=\"line\">                &#125;)</span><br><span class=\"line\">                .<span class=\"title function_\">catch</span>(<span class=\"function\">(<span class=\"params\">res: <span class=\"built_in\">string</span></span>) =&gt;</span> &#123;</span><br><span class=\"line\">                    <span class=\"title function_\">reject</span>(res)</span><br><span class=\"line\">                &#125;)</span><br><span class=\"line\">        &#125;))</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">function</span> <span class=\"title function_\">isMetamask</span>(<span class=\"params\"></span>): <span class=\"title class_\">Promise</span>&lt;<span class=\"built_in\">string</span>&gt; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 这一步骤是判断当前访问浏览器是否安装MetaMask</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> <span class=\"variable language_\">window</span>.<span class=\"property\">ethereum</span> !== <span class=\"string\">&#x27;undefined&#x27;</span>) &#123;</span><br><span class=\"line\">                <span class=\"title function_\">resolve</span>(<span class=\"string\">&#x27;MetaMask is installed!&#x27;</span>)</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"title function_\">reject</span>(<span class=\"string\">&#x27;MetaMask is uninstalled!&#x27;</span>)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">        getAccount</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"配合store使用，将钱包地址存储到store里面并显示出来\"><a href=\"#配合store使用，将钱包地址存储到store里面并显示出来\" class=\"headerlink\" title=\"配合store使用，将钱包地址存储到store里面并显示出来\"></a>配合store使用，将钱包地址存储到store里面并显示出来</h3><p>store.ts文件</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; defineStore &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;pinia&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; useWeb3 &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;src/utils/useWeb3&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; store &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;../index&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">interface</span> <span class=\"title class_\">UserState</span> &#123;</span><br><span class=\"line\">  <span class=\"attr\">walletAddress</span>: <span class=\"built_in\">string</span> | <span class=\"literal\">null</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> useUserStore = <span class=\"title function_\">defineStore</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">id</span>: <span class=\"string\">&#x27;app-user&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">state</span>: (): <span class=\"function\"><span class=\"params\">UserState</span> =&gt;</span> (&#123;</span><br><span class=\"line\">    <span class=\"attr\">walletAddress</span>: <span class=\"literal\">null</span></span><br><span class=\"line\">  &#125;),</span><br><span class=\"line\">  <span class=\"attr\">getters</span>: &#123;</span><br><span class=\"line\">    <span class=\"title function_\">getWalletAddress</span>(): <span class=\"built_in\">string</span> | <span class=\"literal\">null</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 将store里存储的钱包地址Return出去</span></span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.<span class=\"property\">walletAddress</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">actions</span>: &#123;</span><br><span class=\"line\">    <span class=\"title function_\">setWalletAddress</span>(<span class=\"params\">walletAddress: <span class=\"built_in\">any</span> | <span class=\"literal\">null</span></span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 获取钱包地址后存储到store里面</span></span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">walletAddress</span> = walletAddress</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"keyword\">async</span> getWallet () &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 获取小狐狸授权，并获取钱包地址</span></span><br><span class=\"line\">      <span class=\"keyword\">const</span> &#123; getAccount &#125; = <span class=\"title function_\">useWeb3</span>()</span><br><span class=\"line\">      <span class=\"keyword\">const</span> account = <span class=\"keyword\">await</span> <span class=\"title function_\">getAccount</span>()</span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"title function_\">setWalletAddress</span>(account[<span class=\"number\">0</span>])</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">function</span> <span class=\"title function_\">UserStore</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"title function_\">useUserStore</span>(store)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"项目文件使用方法\"><a href=\"#项目文件使用方法\" class=\"headerlink\" title=\"项目文件使用方法\"></a>项目文件使用方法</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class=\"line\">import &#123; UserStore &#125; from &#x27;store/modules/user&#x27;</span><br><span class=\"line\">import &#123; computed &#125; from &#x27;vue&#x27;</span><br><span class=\"line\">const user = UserStore()</span><br><span class=\"line\">const getAddress = async () =&gt; &#123;</span><br><span class=\"line\">  await user.getWallet()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">const walletAddress = computed((): string | null =&gt; &#123;</span><br><span class=\"line\">  return user.getWalletAddress</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">&lt;/script&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">  &lt;ElButton @click=&quot;getAddress&quot; type=&quot;primary&quot;&gt;连接钱包&lt;/ElButton&gt;</span><br><span class=\"line\">  &lt;div&gt;钱包地址：&#123;&#123;walletAddress&#125;&#125;&lt;/div&gt;</span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;style scoped&gt;</span><br><span class=\"line\">&lt;/style&gt;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"web3-js-库是一系列模块的集合，服务于以太坊生态系统的各个功能，如：\"><a href=\"#web3-js-库是一系列模块的集合，服务于以太坊生态系统的各个功能，如：\" class=\"headerlink\" title=\"web3.js 库是一系列模块的集合，服务于以太坊生态系统的各个功能，如：\"></a>web3.js 库是一系列模块的集合，服务于以太坊生态系统的各个功能，如：</h3><p>web3-eth 用来与以太坊区块链及合约的交互<br>web3-shh Whisper 协议相关，进行p2p通信和广播<br>web3-bzz swarm 协议（去中心化文件存储）相关<br>web3-utils 包含一些对 DApp 开发者有用的方法  </p>\n<h3 id=\"引入web3-js\"><a href=\"#引入web3-js\" class=\"headerlink\" title=\"引入web3.js\"></a>引入web3.js</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pnpm add web3</span><br></pre></td></tr></table></figure>\n<h3 id=\"项目构建web3文件\"><a href=\"#项目构建web3文件\" class=\"headerlink\" title=\"项目构建web3文件\"></a>项目构建web3文件</h3><p>在utils目录下新建useWeb3.ts</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; <span class=\"title class_\">UserStore</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;store/modules/user&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">function</span> <span class=\"title function_\">useWeb3</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 获取钱包地址</span></span><br><span class=\"line\">    <span class=\"keyword\">async</span> <span class=\"keyword\">function</span> <span class=\"title function_\">getAccount</span>(<span class=\"params\"></span>): <span class=\"title class_\">Promise</span>&lt;<span class=\"built_in\">any</span>&gt; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>((<span class=\"keyword\">async</span> (resolve, reject) =&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">await</span> <span class=\"title function_\">isMetamask</span>()</span><br><span class=\"line\">                .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res: <span class=\"built_in\">string</span></span>) =&gt;</span> &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// 获取钱包地址授权</span></span><br><span class=\"line\">                    <span class=\"variable language_\">window</span>.<span class=\"property\">ethereum</span>.<span class=\"title function_\">request</span>(&#123;<span class=\"attr\">method</span>: <span class=\"string\">&#x27;eth_requestAccounts&#x27;</span>&#125;)</span><br><span class=\"line\">                        .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res: <span class=\"built_in\">string</span>[]</span>) =&gt;</span> &#123;</span><br><span class=\"line\">                            <span class=\"title function_\">resolve</span>(res)</span><br><span class=\"line\">                        &#125;)</span><br><span class=\"line\">                        .<span class=\"title function_\">catch</span>(<span class=\"function\">(<span class=\"params\">res: <span class=\"built_in\">string</span>[]</span>) =&gt;</span> &#123;</span><br><span class=\"line\">                            <span class=\"title function_\">reject</span>(res)</span><br><span class=\"line\">                        &#125;)</span><br><span class=\"line\">                &#125;)</span><br><span class=\"line\">                .<span class=\"title function_\">catch</span>(<span class=\"function\">(<span class=\"params\">res: <span class=\"built_in\">string</span></span>) =&gt;</span> &#123;</span><br><span class=\"line\">                    <span class=\"title function_\">reject</span>(res)</span><br><span class=\"line\">                &#125;)</span><br><span class=\"line\">        &#125;))</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">function</span> <span class=\"title function_\">isMetamask</span>(<span class=\"params\"></span>): <span class=\"title class_\">Promise</span>&lt;<span class=\"built_in\">string</span>&gt; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 这一步骤是判断当前访问浏览器是否安装MetaMask</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> <span class=\"variable language_\">window</span>.<span class=\"property\">ethereum</span> !== <span class=\"string\">&#x27;undefined&#x27;</span>) &#123;</span><br><span class=\"line\">                <span class=\"title function_\">resolve</span>(<span class=\"string\">&#x27;MetaMask is installed!&#x27;</span>)</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"title function_\">reject</span>(<span class=\"string\">&#x27;MetaMask is uninstalled!&#x27;</span>)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">        getAccount</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"配合store使用，将钱包地址存储到store里面并显示出来\"><a href=\"#配合store使用，将钱包地址存储到store里面并显示出来\" class=\"headerlink\" title=\"配合store使用，将钱包地址存储到store里面并显示出来\"></a>配合store使用，将钱包地址存储到store里面并显示出来</h3><p>store.ts文件</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; defineStore &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;pinia&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; useWeb3 &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;src/utils/useWeb3&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; store &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;../index&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">interface</span> <span class=\"title class_\">UserState</span> &#123;</span><br><span class=\"line\">  <span class=\"attr\">walletAddress</span>: <span class=\"built_in\">string</span> | <span class=\"literal\">null</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> useUserStore = <span class=\"title function_\">defineStore</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">id</span>: <span class=\"string\">&#x27;app-user&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">state</span>: (): <span class=\"function\"><span class=\"params\">UserState</span> =&gt;</span> (&#123;</span><br><span class=\"line\">    <span class=\"attr\">walletAddress</span>: <span class=\"literal\">null</span></span><br><span class=\"line\">  &#125;),</span><br><span class=\"line\">  <span class=\"attr\">getters</span>: &#123;</span><br><span class=\"line\">    <span class=\"title function_\">getWalletAddress</span>(): <span class=\"built_in\">string</span> | <span class=\"literal\">null</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 将store里存储的钱包地址Return出去</span></span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.<span class=\"property\">walletAddress</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">actions</span>: &#123;</span><br><span class=\"line\">    <span class=\"title function_\">setWalletAddress</span>(<span class=\"params\">walletAddress: <span class=\"built_in\">any</span> | <span class=\"literal\">null</span></span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 获取钱包地址后存储到store里面</span></span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">walletAddress</span> = walletAddress</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"keyword\">async</span> getWallet () &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 获取小狐狸授权，并获取钱包地址</span></span><br><span class=\"line\">      <span class=\"keyword\">const</span> &#123; getAccount &#125; = <span class=\"title function_\">useWeb3</span>()</span><br><span class=\"line\">      <span class=\"keyword\">const</span> account = <span class=\"keyword\">await</span> <span class=\"title function_\">getAccount</span>()</span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"title function_\">setWalletAddress</span>(account[<span class=\"number\">0</span>])</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">function</span> <span class=\"title function_\">UserStore</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"title function_\">useUserStore</span>(store)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"项目文件使用方法\"><a href=\"#项目文件使用方法\" class=\"headerlink\" title=\"项目文件使用方法\"></a>项目文件使用方法</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class=\"line\">import &#123; UserStore &#125; from &#x27;store/modules/user&#x27;</span><br><span class=\"line\">import &#123; computed &#125; from &#x27;vue&#x27;</span><br><span class=\"line\">const user = UserStore()</span><br><span class=\"line\">const getAddress = async () =&gt; &#123;</span><br><span class=\"line\">  await user.getWallet()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">const walletAddress = computed((): string | null =&gt; &#123;</span><br><span class=\"line\">  return user.getWalletAddress</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">&lt;/script&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">  &lt;ElButton @click=&quot;getAddress&quot; type=&quot;primary&quot;&gt;连接钱包&lt;/ElButton&gt;</span><br><span class=\"line\">  &lt;div&gt;钱包地址：&#123;&#123;walletAddress&#125;&#125;&lt;/div&gt;</span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;style scoped&gt;</span><br><span class=\"line\">&lt;/style&gt;</span><br></pre></td></tr></table></figure>"},{"title":"web3.js监听用户切换钱包状态","cover":"https://s1.ax1x.com/2022/05/10/OtyPTx.jpg","top_img":"https://s1.ax1x.com/2022/05/10/OtyvUP.jpg","abbrlink":"eff061d5","date":"2022-05-10T08:17:38.000Z","_content":"### Web3js获取MetaMask钱包并监听切换\n官方API方法监听账号切换\n```ts\nimport { UserStore } from 'store/modules/user'\nexport function useWeb3() {\n    async function getAccount(): Promise<any> {\n        return new Promise((async (resolve, reject) => {\n            await isMetamask()\n                .then((res: string) => {\n                    console.log(res)\n                    window.ethereum\n                        .request({method: 'eth_requestAccounts'})\n                        .then((res: string[]) => {\n                            onEvents()\n                            resolve(res)\n                        })\n                        .catch((res: string[]) => {\n                            reject(res)\n                        })\n                })\n                .catch((res: string) => {\n                    reject(res)\n                })\n        }))\n    }\n    function isMetamask(): Promise<string> {\n        return new Promise((resolve, reject) => {\n            if (typeof window.ethereum !== 'undefined') {\n                resolve('MetaMask is installed!')\n            } else {\n                reject('MetaMask is uninstalled!')\n            }\n        })\n    }\n    async function onEvents () {\n        const user = UserStore()\n        //  一旦切换账号这里就会执行\n        window.ethereum.on(\"accountsChanged\", function(accounts: string[]) {\n            if (accounts.length > 0) {\n                // 账号切换后重新存储钱包地址\n                user.setWalletAddress(accounts[0])\n            }\n        })\n    }\n    return {\n        getAccount\n    }\n}\n```\n### 账号切换后使用新的钱包地址重新获取页面数据\n``` vue\n<script setup lang=\"ts\">\nimport { UserStore } from 'store/modules/user'\nimport { computed, watch } from 'vue'\nconst user = UserStore()\ndefineProps<{ msg: string }>()\nconst getAddress = async () => {\n  await user.getWallet()\n}\nconst walletAddress = computed((): string | null => {\n  return user.getWalletAddress\n})\nwatch( // 监听到用户钱包地址发生变化，重新执行获取钱包余额事件\n  () => user.getWalletAddress,\n  (walletAddress) => {\n    walletAddress && getBalance()\n  }\n)\n</script>\n\n<template>\n  <ElButton @click=\"getAddress\" type=\"primary\">连接钱包</ElButton>\n  <h1>{{ msg }}</h1>\n  <div>钱包地址：{{walletAddress}}</div>\n</template>\n\n<style scoped>\n</style>\n```","source":"_posts/web3-2.md","raw":"---\ntitle: web3.js监听用户切换钱包状态\ntags: Web3.js\ncover: 'https://s1.ax1x.com/2022/05/10/OtyPTx.jpg'\ntop_img: 'https://s1.ax1x.com/2022/05/10/OtyvUP.jpg'\nabbrlink: eff061d5\ndate: 2022-05-10 16:17:38\n---\n### Web3js获取MetaMask钱包并监听切换\n官方API方法监听账号切换\n```ts\nimport { UserStore } from 'store/modules/user'\nexport function useWeb3() {\n    async function getAccount(): Promise<any> {\n        return new Promise((async (resolve, reject) => {\n            await isMetamask()\n                .then((res: string) => {\n                    console.log(res)\n                    window.ethereum\n                        .request({method: 'eth_requestAccounts'})\n                        .then((res: string[]) => {\n                            onEvents()\n                            resolve(res)\n                        })\n                        .catch((res: string[]) => {\n                            reject(res)\n                        })\n                })\n                .catch((res: string) => {\n                    reject(res)\n                })\n        }))\n    }\n    function isMetamask(): Promise<string> {\n        return new Promise((resolve, reject) => {\n            if (typeof window.ethereum !== 'undefined') {\n                resolve('MetaMask is installed!')\n            } else {\n                reject('MetaMask is uninstalled!')\n            }\n        })\n    }\n    async function onEvents () {\n        const user = UserStore()\n        //  一旦切换账号这里就会执行\n        window.ethereum.on(\"accountsChanged\", function(accounts: string[]) {\n            if (accounts.length > 0) {\n                // 账号切换后重新存储钱包地址\n                user.setWalletAddress(accounts[0])\n            }\n        })\n    }\n    return {\n        getAccount\n    }\n}\n```\n### 账号切换后使用新的钱包地址重新获取页面数据\n``` vue\n<script setup lang=\"ts\">\nimport { UserStore } from 'store/modules/user'\nimport { computed, watch } from 'vue'\nconst user = UserStore()\ndefineProps<{ msg: string }>()\nconst getAddress = async () => {\n  await user.getWallet()\n}\nconst walletAddress = computed((): string | null => {\n  return user.getWalletAddress\n})\nwatch( // 监听到用户钱包地址发生变化，重新执行获取钱包余额事件\n  () => user.getWalletAddress,\n  (walletAddress) => {\n    walletAddress && getBalance()\n  }\n)\n</script>\n\n<template>\n  <ElButton @click=\"getAddress\" type=\"primary\">连接钱包</ElButton>\n  <h1>{{ msg }}</h1>\n  <div>钱包地址：{{walletAddress}}</div>\n</template>\n\n<style scoped>\n</style>\n```","slug":"web3-2","published":1,"updated":"2022-05-10T08:27:14.214Z","_id":"cl2zvsk5k0000xgvna1cu609j","comments":1,"layout":"post","photos":[],"link":"","content":"<h3 id=\"Web3js获取MetaMask钱包并监听切换\"><a href=\"#Web3js获取MetaMask钱包并监听切换\" class=\"headerlink\" title=\"Web3js获取MetaMask钱包并监听切换\"></a>Web3js获取MetaMask钱包并监听切换</h3><p>官方API方法监听账号切换</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; <span class=\"title class_\">UserStore</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;store/modules/user&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">function</span> <span class=\"title function_\">useWeb3</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">async</span> <span class=\"keyword\">function</span> <span class=\"title function_\">getAccount</span>(<span class=\"params\"></span>): <span class=\"title class_\">Promise</span>&lt;<span class=\"built_in\">any</span>&gt; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>((<span class=\"keyword\">async</span> (resolve, reject) =&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">await</span> <span class=\"title function_\">isMetamask</span>()</span><br><span class=\"line\">                .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res: <span class=\"built_in\">string</span></span>) =&gt;</span> &#123;</span><br><span class=\"line\">                    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(res)</span><br><span class=\"line\">                    <span class=\"variable language_\">window</span>.<span class=\"property\">ethereum</span></span><br><span class=\"line\">                        .<span class=\"title function_\">request</span>(&#123;<span class=\"attr\">method</span>: <span class=\"string\">&#x27;eth_requestAccounts&#x27;</span>&#125;)</span><br><span class=\"line\">                        .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res: <span class=\"built_in\">string</span>[]</span>) =&gt;</span> &#123;</span><br><span class=\"line\">                            <span class=\"title function_\">onEvents</span>()</span><br><span class=\"line\">                            <span class=\"title function_\">resolve</span>(res)</span><br><span class=\"line\">                        &#125;)</span><br><span class=\"line\">                        .<span class=\"title function_\">catch</span>(<span class=\"function\">(<span class=\"params\">res: <span class=\"built_in\">string</span>[]</span>) =&gt;</span> &#123;</span><br><span class=\"line\">                            <span class=\"title function_\">reject</span>(res)</span><br><span class=\"line\">                        &#125;)</span><br><span class=\"line\">                &#125;)</span><br><span class=\"line\">                .<span class=\"title function_\">catch</span>(<span class=\"function\">(<span class=\"params\">res: <span class=\"built_in\">string</span></span>) =&gt;</span> &#123;</span><br><span class=\"line\">                    <span class=\"title function_\">reject</span>(res)</span><br><span class=\"line\">                &#125;)</span><br><span class=\"line\">        &#125;))</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">function</span> <span class=\"title function_\">isMetamask</span>(<span class=\"params\"></span>): <span class=\"title class_\">Promise</span>&lt;<span class=\"built_in\">string</span>&gt; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> <span class=\"variable language_\">window</span>.<span class=\"property\">ethereum</span> !== <span class=\"string\">&#x27;undefined&#x27;</span>) &#123;</span><br><span class=\"line\">                <span class=\"title function_\">resolve</span>(<span class=\"string\">&#x27;MetaMask is installed!&#x27;</span>)</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"title function_\">reject</span>(<span class=\"string\">&#x27;MetaMask is uninstalled!&#x27;</span>)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">async</span> <span class=\"keyword\">function</span> <span class=\"title function_\">onEvents</span> () &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> user = <span class=\"title class_\">UserStore</span>()</span><br><span class=\"line\">        <span class=\"comment\">//  一旦切换账号这里就会执行</span></span><br><span class=\"line\">        <span class=\"variable language_\">window</span>.<span class=\"property\">ethereum</span>.<span class=\"title function_\">on</span>(<span class=\"string\">&quot;accountsChanged&quot;</span>, <span class=\"keyword\">function</span>(<span class=\"params\">accounts: <span class=\"built_in\">string</span>[]</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (accounts.<span class=\"property\">length</span> &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 账号切换后重新存储钱包地址</span></span><br><span class=\"line\">                user.<span class=\"title function_\">setWalletAddress</span>(accounts[<span class=\"number\">0</span>])</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">        getAccount</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"账号切换后使用新的钱包地址重新获取页面数据\"><a href=\"#账号切换后使用新的钱包地址重新获取页面数据\" class=\"headerlink\" title=\"账号切换后使用新的钱包地址重新获取页面数据\"></a>账号切换后使用新的钱包地址重新获取页面数据</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class=\"line\">import &#123; UserStore &#125; from &#x27;store/modules/user&#x27;</span><br><span class=\"line\">import &#123; computed, watch &#125; from &#x27;vue&#x27;</span><br><span class=\"line\">const user = UserStore()</span><br><span class=\"line\">defineProps&lt;&#123; msg: string &#125;&gt;()</span><br><span class=\"line\">const getAddress = async () =&gt; &#123;</span><br><span class=\"line\">  await user.getWallet()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">const walletAddress = computed((): string | null =&gt; &#123;</span><br><span class=\"line\">  return user.getWalletAddress</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">watch( // 监听到用户钱包地址发生变化，重新执行获取钱包余额事件</span><br><span class=\"line\">  () =&gt; user.getWalletAddress,</span><br><span class=\"line\">  (walletAddress) =&gt; &#123;</span><br><span class=\"line\">    walletAddress &amp;&amp; getBalance()</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">)</span><br><span class=\"line\">&lt;/script&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">  &lt;ElButton @click=&quot;getAddress&quot; type=&quot;primary&quot;&gt;连接钱包&lt;/ElButton&gt;</span><br><span class=\"line\">  &lt;h1&gt;&#123;&#123; msg &#125;&#125;&lt;/h1&gt;</span><br><span class=\"line\">  &lt;div&gt;钱包地址：&#123;&#123;walletAddress&#125;&#125;&lt;/div&gt;</span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;style scoped&gt;</span><br><span class=\"line\">&lt;/style&gt;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"Web3js获取MetaMask钱包并监听切换\"><a href=\"#Web3js获取MetaMask钱包并监听切换\" class=\"headerlink\" title=\"Web3js获取MetaMask钱包并监听切换\"></a>Web3js获取MetaMask钱包并监听切换</h3><p>官方API方法监听账号切换</p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; <span class=\"title class_\">UserStore</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;store/modules/user&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">function</span> <span class=\"title function_\">useWeb3</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">async</span> <span class=\"keyword\">function</span> <span class=\"title function_\">getAccount</span>(<span class=\"params\"></span>): <span class=\"title class_\">Promise</span>&lt;<span class=\"built_in\">any</span>&gt; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>((<span class=\"keyword\">async</span> (resolve, reject) =&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">await</span> <span class=\"title function_\">isMetamask</span>()</span><br><span class=\"line\">                .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res: <span class=\"built_in\">string</span></span>) =&gt;</span> &#123;</span><br><span class=\"line\">                    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(res)</span><br><span class=\"line\">                    <span class=\"variable language_\">window</span>.<span class=\"property\">ethereum</span></span><br><span class=\"line\">                        .<span class=\"title function_\">request</span>(&#123;<span class=\"attr\">method</span>: <span class=\"string\">&#x27;eth_requestAccounts&#x27;</span>&#125;)</span><br><span class=\"line\">                        .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res: <span class=\"built_in\">string</span>[]</span>) =&gt;</span> &#123;</span><br><span class=\"line\">                            <span class=\"title function_\">onEvents</span>()</span><br><span class=\"line\">                            <span class=\"title function_\">resolve</span>(res)</span><br><span class=\"line\">                        &#125;)</span><br><span class=\"line\">                        .<span class=\"title function_\">catch</span>(<span class=\"function\">(<span class=\"params\">res: <span class=\"built_in\">string</span>[]</span>) =&gt;</span> &#123;</span><br><span class=\"line\">                            <span class=\"title function_\">reject</span>(res)</span><br><span class=\"line\">                        &#125;)</span><br><span class=\"line\">                &#125;)</span><br><span class=\"line\">                .<span class=\"title function_\">catch</span>(<span class=\"function\">(<span class=\"params\">res: <span class=\"built_in\">string</span></span>) =&gt;</span> &#123;</span><br><span class=\"line\">                    <span class=\"title function_\">reject</span>(res)</span><br><span class=\"line\">                &#125;)</span><br><span class=\"line\">        &#125;))</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">function</span> <span class=\"title function_\">isMetamask</span>(<span class=\"params\"></span>): <span class=\"title class_\">Promise</span>&lt;<span class=\"built_in\">string</span>&gt; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> <span class=\"variable language_\">window</span>.<span class=\"property\">ethereum</span> !== <span class=\"string\">&#x27;undefined&#x27;</span>) &#123;</span><br><span class=\"line\">                <span class=\"title function_\">resolve</span>(<span class=\"string\">&#x27;MetaMask is installed!&#x27;</span>)</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"title function_\">reject</span>(<span class=\"string\">&#x27;MetaMask is uninstalled!&#x27;</span>)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">async</span> <span class=\"keyword\">function</span> <span class=\"title function_\">onEvents</span> () &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> user = <span class=\"title class_\">UserStore</span>()</span><br><span class=\"line\">        <span class=\"comment\">//  一旦切换账号这里就会执行</span></span><br><span class=\"line\">        <span class=\"variable language_\">window</span>.<span class=\"property\">ethereum</span>.<span class=\"title function_\">on</span>(<span class=\"string\">&quot;accountsChanged&quot;</span>, <span class=\"keyword\">function</span>(<span class=\"params\">accounts: <span class=\"built_in\">string</span>[]</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (accounts.<span class=\"property\">length</span> &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 账号切换后重新存储钱包地址</span></span><br><span class=\"line\">                user.<span class=\"title function_\">setWalletAddress</span>(accounts[<span class=\"number\">0</span>])</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">        getAccount</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"账号切换后使用新的钱包地址重新获取页面数据\"><a href=\"#账号切换后使用新的钱包地址重新获取页面数据\" class=\"headerlink\" title=\"账号切换后使用新的钱包地址重新获取页面数据\"></a>账号切换后使用新的钱包地址重新获取页面数据</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class=\"line\">import &#123; UserStore &#125; from &#x27;store/modules/user&#x27;</span><br><span class=\"line\">import &#123; computed, watch &#125; from &#x27;vue&#x27;</span><br><span class=\"line\">const user = UserStore()</span><br><span class=\"line\">defineProps&lt;&#123; msg: string &#125;&gt;()</span><br><span class=\"line\">const getAddress = async () =&gt; &#123;</span><br><span class=\"line\">  await user.getWallet()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">const walletAddress = computed((): string | null =&gt; &#123;</span><br><span class=\"line\">  return user.getWalletAddress</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">watch( // 监听到用户钱包地址发生变化，重新执行获取钱包余额事件</span><br><span class=\"line\">  () =&gt; user.getWalletAddress,</span><br><span class=\"line\">  (walletAddress) =&gt; &#123;</span><br><span class=\"line\">    walletAddress &amp;&amp; getBalance()</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">)</span><br><span class=\"line\">&lt;/script&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">  &lt;ElButton @click=&quot;getAddress&quot; type=&quot;primary&quot;&gt;连接钱包&lt;/ElButton&gt;</span><br><span class=\"line\">  &lt;h1&gt;&#123;&#123; msg &#125;&#125;&lt;/h1&gt;</span><br><span class=\"line\">  &lt;div&gt;钱包地址：&#123;&#123;walletAddress&#125;&#125;&lt;/div&gt;</span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;style scoped&gt;</span><br><span class=\"line\">&lt;/style&gt;</span><br></pre></td></tr></table></figure>"},{"title":"解决切换路由因高度不够出现滚动条导致页面抖动","cover":"https://s1.ax1x.com/2022/05/16/OW163t.jpg","top_img":"https://s1.ax1x.com/2022/05/16/OW1bvV.png","abbrlink":"78cea6d8","date":"2022-05-16T02:45:45.000Z","_content":"现在大多数页面都是采用主题内容水平居中布局，但是，这种布局存在一个问题。现在的浏览器滚动条默认是overflow:auto类型的，也就是说如果内容高度不足一屏，没有滚动条；  \n如果超出才会出现滚动条。滚动条也是占据屏幕尺寸的，从没有滚动条到有滚动条会使页面左右抖动一下。  \n现有三种解决方法：\n### 让垂直滚动条一直显示\n```css\nbody {\n    overflow-y: scroll;\n}\n```\n即使内容高度不足一屏也会显示滚动条，比较影响用户体验\n### 当内容高度超过一屏时，在浏览器左侧同时加上一个滚动条宽的的padding或margin\n```css\n.wrap-outer {\n    margin-left: calc(100vw - 100%);\n}\n```\nmargin换成padding一样可以生效\n### 推荐使用兼容写法\n```css\nhtml {\n    overflow-x: hidden;\n    overflow-y: auto;\n}\nbody {\n    width: 100vw;\n    overflow: hidden;\n}\n```","source":"_posts/css.md","raw":"---\ntitle: 解决切换路由因高度不够出现滚动条导致页面抖动\ntags: Css\ncover: https://s1.ax1x.com/2022/05/16/OW163t.jpg\ntop_img: https://s1.ax1x.com/2022/05/16/OW1bvV.png\nabbrlink: 78cea6d8\ndate: 2022-05-16 10:45:45\n---\n现在大多数页面都是采用主题内容水平居中布局，但是，这种布局存在一个问题。现在的浏览器滚动条默认是overflow:auto类型的，也就是说如果内容高度不足一屏，没有滚动条；  \n如果超出才会出现滚动条。滚动条也是占据屏幕尺寸的，从没有滚动条到有滚动条会使页面左右抖动一下。  \n现有三种解决方法：\n### 让垂直滚动条一直显示\n```css\nbody {\n    overflow-y: scroll;\n}\n```\n即使内容高度不足一屏也会显示滚动条，比较影响用户体验\n### 当内容高度超过一屏时，在浏览器左侧同时加上一个滚动条宽的的padding或margin\n```css\n.wrap-outer {\n    margin-left: calc(100vw - 100%);\n}\n```\nmargin换成padding一样可以生效\n### 推荐使用兼容写法\n```css\nhtml {\n    overflow-x: hidden;\n    overflow-y: auto;\n}\nbody {\n    width: 100vw;\n    overflow: hidden;\n}\n```","slug":"css","published":1,"updated":"2022-05-16T03:02:47.223Z","_id":"cl384kvze0000i8vndy6xemti","comments":1,"layout":"post","photos":[],"link":"","content":"<p>现在大多数页面都是采用主题内容水平居中布局，但是，这种布局存在一个问题。现在的浏览器滚动条默认是overflow:auto类型的，也就是说如果内容高度不足一屏，没有滚动条；<br>如果超出才会出现滚动条。滚动条也是占据屏幕尺寸的，从没有滚动条到有滚动条会使页面左右抖动一下。<br>现有三种解决方法：</p>\n<h3 id=\"让垂直滚动条一直显示\"><a href=\"#让垂直滚动条一直显示\" class=\"headerlink\" title=\"让垂直滚动条一直显示\"></a>让垂直滚动条一直显示</h3><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">body</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">overflow-y</span>: scroll;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>即使内容高度不足一屏也会显示滚动条，比较影响用户体验</p>\n<h3 id=\"当内容高度超过一屏时，在浏览器左侧同时加上一个滚动条宽的的padding或margin\"><a href=\"#当内容高度超过一屏时，在浏览器左侧同时加上一个滚动条宽的的padding或margin\" class=\"headerlink\" title=\"当内容高度超过一屏时，在浏览器左侧同时加上一个滚动条宽的的padding或margin\"></a>当内容高度超过一屏时，在浏览器左侧同时加上一个滚动条宽的的padding或margin</h3><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.wrap-outer</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">margin-left</span>: <span class=\"built_in\">calc</span>(<span class=\"number\">100vw</span> - <span class=\"number\">100%</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>margin换成padding一样可以生效</p>\n<h3 id=\"推荐使用兼容写法\"><a href=\"#推荐使用兼容写法\" class=\"headerlink\" title=\"推荐使用兼容写法\"></a>推荐使用兼容写法</h3><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">html</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">overflow-x</span>: hidden;</span><br><span class=\"line\">    <span class=\"attribute\">overflow-y</span>: auto;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-tag\">body</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">100vw</span>;</span><br><span class=\"line\">    <span class=\"attribute\">overflow</span>: hidden;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<p>现在大多数页面都是采用主题内容水平居中布局，但是，这种布局存在一个问题。现在的浏览器滚动条默认是overflow:auto类型的，也就是说如果内容高度不足一屏，没有滚动条；<br>如果超出才会出现滚动条。滚动条也是占据屏幕尺寸的，从没有滚动条到有滚动条会使页面左右抖动一下。<br>现有三种解决方法：</p>\n<h3 id=\"让垂直滚动条一直显示\"><a href=\"#让垂直滚动条一直显示\" class=\"headerlink\" title=\"让垂直滚动条一直显示\"></a>让垂直滚动条一直显示</h3><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">body</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">overflow-y</span>: scroll;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>即使内容高度不足一屏也会显示滚动条，比较影响用户体验</p>\n<h3 id=\"当内容高度超过一屏时，在浏览器左侧同时加上一个滚动条宽的的padding或margin\"><a href=\"#当内容高度超过一屏时，在浏览器左侧同时加上一个滚动条宽的的padding或margin\" class=\"headerlink\" title=\"当内容高度超过一屏时，在浏览器左侧同时加上一个滚动条宽的的padding或margin\"></a>当内容高度超过一屏时，在浏览器左侧同时加上一个滚动条宽的的padding或margin</h3><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.wrap-outer</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">margin-left</span>: <span class=\"built_in\">calc</span>(<span class=\"number\">100vw</span> - <span class=\"number\">100%</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>margin换成padding一样可以生效</p>\n<h3 id=\"推荐使用兼容写法\"><a href=\"#推荐使用兼容写法\" class=\"headerlink\" title=\"推荐使用兼容写法\"></a>推荐使用兼容写法</h3><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">html</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">overflow-x</span>: hidden;</span><br><span class=\"line\">    <span class=\"attribute\">overflow-y</span>: auto;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-tag\">body</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">100vw</span>;</span><br><span class=\"line\">    <span class=\"attribute\">overflow</span>: hidden;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"flex弹性盒子布局最后一行不满时左对齐实现思路","cover":"https://s1.ax1x.com/2022/05/16/OW163t.jpg","top_img":"https://s1.ax1x.com/2022/05/16/OW1bvV.png","abbrlink":"8513d6fd","date":"2022-05-16T03:03:44.000Z","_content":"只需要在弹性盒子的容器加一个伪类元素，大小就是盒子内容的宽高就可以实现。\n```vue\n<ul>\n  <li></li>\n  <li></li>\n  <li></li>\n  <li></li>\n  <li></li>\n</ul>\n```\n```css\n*{\n    padding: 0px;\n    list-style: none;\n}\nul{\n    width: 1000px;\n    height: 800px;\n    border: 1px solid #000;\n    display: flex;\n    flex-flow: row wrap;\n    justify-content: space-between;\n}\nli{\n    width: 300px;\n    height: 300px;\n    border: 1px solid #456;\n}\nul::after{\n    width: 300px;\n    height: 300px;\n    content: '';\n}\n```","source":"_posts/css2.md","raw":"---\ntitle: flex弹性盒子布局最后一行不满时左对齐实现思路\ntags: Css\ncover: 'https://s1.ax1x.com/2022/05/16/OW163t.jpg'\ntop_img: 'https://s1.ax1x.com/2022/05/16/OW1bvV.png'\nabbrlink: 8513d6fd\ndate: 2022-05-16 11:03:44\n---\n只需要在弹性盒子的容器加一个伪类元素，大小就是盒子内容的宽高就可以实现。\n```vue\n<ul>\n  <li></li>\n  <li></li>\n  <li></li>\n  <li></li>\n  <li></li>\n</ul>\n```\n```css\n*{\n    padding: 0px;\n    list-style: none;\n}\nul{\n    width: 1000px;\n    height: 800px;\n    border: 1px solid #000;\n    display: flex;\n    flex-flow: row wrap;\n    justify-content: space-between;\n}\nli{\n    width: 300px;\n    height: 300px;\n    border: 1px solid #456;\n}\nul::after{\n    width: 300px;\n    height: 300px;\n    content: '';\n}\n```","slug":"css2","published":1,"updated":"2022-05-16T03:45:38.780Z","_id":"cl386imhn0000gwvn9b8a48wt","comments":1,"layout":"post","photos":[],"link":"","content":"<p>只需要在弹性盒子的容器加一个伪类元素，大小就是盒子内容的宽高就可以实现。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;ul&gt;</span><br><span class=\"line\">  &lt;li&gt;&lt;/li&gt;</span><br><span class=\"line\">  &lt;li&gt;&lt;/li&gt;</span><br><span class=\"line\">  &lt;li&gt;&lt;/li&gt;</span><br><span class=\"line\">  &lt;li&gt;&lt;/li&gt;</span><br><span class=\"line\">  &lt;li&gt;&lt;/li&gt;</span><br><span class=\"line\">&lt;/ul&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">*&#123;</span><br><span class=\"line\">    <span class=\"attribute\">padding</span>: <span class=\"number\">0px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">list-style</span>: none;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-tag\">ul</span>&#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">1000px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">800px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border</span>: <span class=\"number\">1px</span> solid <span class=\"number\">#000</span>;</span><br><span class=\"line\">    <span class=\"attribute\">display</span>: flex;</span><br><span class=\"line\">    <span class=\"attribute\">flex-flow</span>: row wrap;</span><br><span class=\"line\">    <span class=\"attribute\">justify-content</span>: space-between;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-tag\">li</span>&#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">300px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">300px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border</span>: <span class=\"number\">1px</span> solid <span class=\"number\">#456</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-tag\">ul</span><span class=\"selector-pseudo\">::after</span>&#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">300px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">300px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">content</span>: <span class=\"string\">&#x27;&#x27;</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<p>只需要在弹性盒子的容器加一个伪类元素，大小就是盒子内容的宽高就可以实现。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;ul&gt;</span><br><span class=\"line\">  &lt;li&gt;&lt;/li&gt;</span><br><span class=\"line\">  &lt;li&gt;&lt;/li&gt;</span><br><span class=\"line\">  &lt;li&gt;&lt;/li&gt;</span><br><span class=\"line\">  &lt;li&gt;&lt;/li&gt;</span><br><span class=\"line\">  &lt;li&gt;&lt;/li&gt;</span><br><span class=\"line\">&lt;/ul&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">*&#123;</span><br><span class=\"line\">    <span class=\"attribute\">padding</span>: <span class=\"number\">0px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">list-style</span>: none;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-tag\">ul</span>&#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">1000px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">800px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border</span>: <span class=\"number\">1px</span> solid <span class=\"number\">#000</span>;</span><br><span class=\"line\">    <span class=\"attribute\">display</span>: flex;</span><br><span class=\"line\">    <span class=\"attribute\">flex-flow</span>: row wrap;</span><br><span class=\"line\">    <span class=\"attribute\">justify-content</span>: space-between;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-tag\">li</span>&#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">300px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">300px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border</span>: <span class=\"number\">1px</span> solid <span class=\"number\">#456</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-tag\">ul</span><span class=\"selector-pseudo\">::after</span>&#123;</span><br><span class=\"line\">    <span class=\"attribute\">width</span>: <span class=\"number\">300px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">height</span>: <span class=\"number\">300px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">content</span>: <span class=\"string\">&#x27;&#x27;</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"创建UTXO","abbrlink":"e5a32ca1","date":"2024-08-08T10:00:20.000Z","cover":"https://s21.ax1x.com/2024/08/08/pkzactO.png","top_img":"https://s21.ax1x.com/2024/08/08/pkzactO.png","_content":"## BTC创建UTXO并用Joy ID广播\n### 安装依赖\n```shell\npnpm install bitcoinjs-lib tiny-secp256k1 axios @joyid/bitcoin\n```\n### 获取剩余UTXO\n```ts\nconst getUtxos = async (address: string) => {\n    try {\n        const response = await axios.get(`https://blockstream.info/testnet/api/address/${address}/utxo`);\n        return response.data;\n    } catch (error) {\n        console.error('Error fetching UTXO:', error);\n        throw error;\n    }\n};\n```\n### 创建交易\n```ts\n    const [txHex, setTxHex] = useState('');\n    const createTransaction = async () => {\n    const network = bitcoin.networks.testnet; // 使用比特币测试网络\n    const senderAddress = address;\n    const recipientAddress = 'tb1qp4gpusm5vq7ysa38wa92a6n8ps89hp7ts2907m';\n    const amountToSend = 0.0001 * 1e8; // 发送的金额，单位是聪（satoshis）\n    // 获取 UTXO（未花费的交易输出）\n    const utxos = await getUtxos();\n\n    if (utxos.length === 0) {\n        throw new Error('No UTXOs available for the address.');\n    }\n    const utxo = utxos[0]; // 使用第一个 UTXO，实际应用中可能需要选择最佳 UTXO\n\n    // 检查 txid 是否有效\n    if (!/^[0-9a-fA-F]{64}$/.test(utxo.txid)) {\n        throw new TypeError('Invalid txid');\n    }\n    // 创建 PSBT\n    const psbt = new bitcoin.Psbt({ network });\n    try {\n        psbt.addInput({\n            hash: utxo.txid,\n            index: utxo.vout,\n            witnessUtxo: {\n                script: bitcoin.address.toOutputScript(senderAddress, network),\n                value: utxo.value,\n            },\n        });\n    } catch (error) {\n        throw error;\n    }\n    try {\n        psbt.addOutput({\n            address: recipientAddress,\n            value: amountToSend,\n        });\n    } catch (error) {\n        throw error;\n    }\n\n    // 找零地址和找零金额，如果有的话\n    const changeAddress = senderAddress;\n    const fee = 0.00001 * 1e8; // 示例费用\n    const changeValue = utxo.value - amountToSend - fee;\n\n    if (changeValue > 0) {\n        try {\n            psbt.addOutput({\n                address: changeAddress,\n                value: changeValue,\n            });\n        } catch (error) {\n            throw error;\n        }\n    }\n    const psbtHex = psbt.toHex();\n    setTxHex(psbtHex)\n};\n```\n### 监听到psbtHex创建完成捕获并使用JoyID广播\n```ts\nimport { sendPsbt } from \"@joyid/bitcoin\";\nconst sendContract = async () => {\n    const tx = await sendPsbt(txHex)\n    console.log(tx, 'tx');\n}\n```","source":"_posts/创建UTXO.md","raw":"---\ntitle: 创建UTXO\ntags: BTC\nabbrlink: e5a32ca1\ndate: 2024-08-08 18:00:20\ncover: https://s21.ax1x.com/2024/08/08/pkzactO.png\ntop_img: https://s21.ax1x.com/2024/08/08/pkzactO.png\n---\n## BTC创建UTXO并用Joy ID广播\n### 安装依赖\n```shell\npnpm install bitcoinjs-lib tiny-secp256k1 axios @joyid/bitcoin\n```\n### 获取剩余UTXO\n```ts\nconst getUtxos = async (address: string) => {\n    try {\n        const response = await axios.get(`https://blockstream.info/testnet/api/address/${address}/utxo`);\n        return response.data;\n    } catch (error) {\n        console.error('Error fetching UTXO:', error);\n        throw error;\n    }\n};\n```\n### 创建交易\n```ts\n    const [txHex, setTxHex] = useState('');\n    const createTransaction = async () => {\n    const network = bitcoin.networks.testnet; // 使用比特币测试网络\n    const senderAddress = address;\n    const recipientAddress = 'tb1qp4gpusm5vq7ysa38wa92a6n8ps89hp7ts2907m';\n    const amountToSend = 0.0001 * 1e8; // 发送的金额，单位是聪（satoshis）\n    // 获取 UTXO（未花费的交易输出）\n    const utxos = await getUtxos();\n\n    if (utxos.length === 0) {\n        throw new Error('No UTXOs available for the address.');\n    }\n    const utxo = utxos[0]; // 使用第一个 UTXO，实际应用中可能需要选择最佳 UTXO\n\n    // 检查 txid 是否有效\n    if (!/^[0-9a-fA-F]{64}$/.test(utxo.txid)) {\n        throw new TypeError('Invalid txid');\n    }\n    // 创建 PSBT\n    const psbt = new bitcoin.Psbt({ network });\n    try {\n        psbt.addInput({\n            hash: utxo.txid,\n            index: utxo.vout,\n            witnessUtxo: {\n                script: bitcoin.address.toOutputScript(senderAddress, network),\n                value: utxo.value,\n            },\n        });\n    } catch (error) {\n        throw error;\n    }\n    try {\n        psbt.addOutput({\n            address: recipientAddress,\n            value: amountToSend,\n        });\n    } catch (error) {\n        throw error;\n    }\n\n    // 找零地址和找零金额，如果有的话\n    const changeAddress = senderAddress;\n    const fee = 0.00001 * 1e8; // 示例费用\n    const changeValue = utxo.value - amountToSend - fee;\n\n    if (changeValue > 0) {\n        try {\n            psbt.addOutput({\n                address: changeAddress,\n                value: changeValue,\n            });\n        } catch (error) {\n            throw error;\n        }\n    }\n    const psbtHex = psbt.toHex();\n    setTxHex(psbtHex)\n};\n```\n### 监听到psbtHex创建完成捕获并使用JoyID广播\n```ts\nimport { sendPsbt } from \"@joyid/bitcoin\";\nconst sendContract = async () => {\n    const tx = await sendPsbt(txHex)\n    console.log(tx, 'tx');\n}\n```","slug":"创建UTXO","published":1,"updated":"2024-08-08T10:17:58.401Z","_id":"clzl40jfp0000uckv4x511y5w","comments":1,"layout":"post","photos":[],"link":"","content":"<h2 id=\"BTC创建UTXO并用Joy-ID广播\"><a href=\"#BTC创建UTXO并用Joy-ID广播\" class=\"headerlink\" title=\"BTC创建UTXO并用Joy ID广播\"></a>BTC创建UTXO并用Joy ID广播</h2><h3 id=\"安装依赖\"><a href=\"#安装依赖\" class=\"headerlink\" title=\"安装依赖\"></a>安装依赖</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pnpm install bitcoinjs-lib tiny-secp256k1 axios @joyid/bitcoin</span><br></pre></td></tr></table></figure>\n<h3 id=\"获取剩余UTXO\"><a href=\"#获取剩余UTXO\" class=\"headerlink\" title=\"获取剩余UTXO\"></a>获取剩余UTXO</h3><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">getUtxos</span> = <span class=\"keyword\">async</span> (<span class=\"params\"><span class=\"attr\">address</span>: <span class=\"built_in\">string</span></span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> response = <span class=\"keyword\">await</span> axios.<span class=\"title function_\">get</span>(<span class=\"string\">`https://blockstream.info/testnet/api/address/<span class=\"subst\">$&#123;address&#125;</span>/utxo`</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> response.<span class=\"property\">data</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (error) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">error</span>(<span class=\"string\">&#x27;Error fetching UTXO:&#x27;</span>, error);</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> error;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"创建交易\"><a href=\"#创建交易\" class=\"headerlink\" title=\"创建交易\"></a>创建交易</h3><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">    <span class=\"keyword\">const</span> [txHex, setTxHex] = <span class=\"title function_\">useState</span>(<span class=\"string\">&#x27;&#x27;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"title function_\">createTransaction</span> = <span class=\"keyword\">async</span> (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> network = bitcoin.<span class=\"property\">networks</span>.<span class=\"property\">testnet</span>; <span class=\"comment\">// 使用比特币测试网络</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> senderAddress = address;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> recipientAddress = <span class=\"string\">&#x27;tb1qp4gpusm5vq7ysa38wa92a6n8ps89hp7ts2907m&#x27;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> amountToSend = <span class=\"number\">0.0001</span> * <span class=\"number\">1e8</span>; <span class=\"comment\">// 发送的金额，单位是聪（satoshis）</span></span><br><span class=\"line\">    <span class=\"comment\">// 获取 UTXO（未花费的交易输出）</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> utxos = <span class=\"keyword\">await</span> <span class=\"title function_\">getUtxos</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (utxos.<span class=\"property\">length</span> === <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Error</span>(<span class=\"string\">&#x27;No UTXOs available for the address.&#x27;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> utxo = utxos[<span class=\"number\">0</span>]; <span class=\"comment\">// 使用第一个 UTXO，实际应用中可能需要选择最佳 UTXO</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 检查 txid 是否有效</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!<span class=\"regexp\">/^[0-9a-fA-F]&#123;64&#125;$/</span>.<span class=\"title function_\">test</span>(utxo.<span class=\"property\">txid</span>)) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">TypeError</span>(<span class=\"string\">&#x27;Invalid txid&#x27;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 创建 PSBT</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> psbt = <span class=\"keyword\">new</span> bitcoin.<span class=\"title class_\">Psbt</span>(&#123; network &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        psbt.<span class=\"title function_\">addInput</span>(&#123;</span><br><span class=\"line\">            <span class=\"attr\">hash</span>: utxo.<span class=\"property\">txid</span>,</span><br><span class=\"line\">            <span class=\"attr\">index</span>: utxo.<span class=\"property\">vout</span>,</span><br><span class=\"line\">            <span class=\"attr\">witnessUtxo</span>: &#123;</span><br><span class=\"line\">                <span class=\"attr\">script</span>: bitcoin.<span class=\"property\">address</span>.<span class=\"title function_\">toOutputScript</span>(senderAddress, network),</span><br><span class=\"line\">                <span class=\"attr\">value</span>: utxo.<span class=\"property\">value</span>,</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (error) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> error;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        psbt.<span class=\"title function_\">addOutput</span>(&#123;</span><br><span class=\"line\">            <span class=\"attr\">address</span>: recipientAddress,</span><br><span class=\"line\">            <span class=\"attr\">value</span>: amountToSend,</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (error) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> error;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 找零地址和找零金额，如果有的话</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> changeAddress = senderAddress;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> fee = <span class=\"number\">0.00001</span> * <span class=\"number\">1e8</span>; <span class=\"comment\">// 示例费用</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> changeValue = utxo.<span class=\"property\">value</span> - amountToSend - fee;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (changeValue &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            psbt.<span class=\"title function_\">addOutput</span>(&#123;</span><br><span class=\"line\">                <span class=\"attr\">address</span>: changeAddress,</span><br><span class=\"line\">                <span class=\"attr\">value</span>: changeValue,</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (error) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> error;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> psbtHex = psbt.<span class=\"title function_\">toHex</span>();</span><br><span class=\"line\">    <span class=\"title function_\">setTxHex</span>(psbtHex)</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"监听到psbtHex创建完成捕获并使用JoyID广播\"><a href=\"#监听到psbtHex创建完成捕获并使用JoyID广播\" class=\"headerlink\" title=\"监听到psbtHex创建完成捕获并使用JoyID广播\"></a>监听到psbtHex创建完成捕获并使用JoyID广播</h3><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; sendPsbt &#125; <span class=\"keyword\">from</span> <span class=\"string\">&quot;@joyid/bitcoin&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">sendContract</span> = <span class=\"keyword\">async</span> (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> tx = <span class=\"keyword\">await</span> <span class=\"title function_\">sendPsbt</span>(txHex)</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(tx, <span class=\"string\">&#x27;tx&#x27;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h2 id=\"BTC创建UTXO并用Joy-ID广播\"><a href=\"#BTC创建UTXO并用Joy-ID广播\" class=\"headerlink\" title=\"BTC创建UTXO并用Joy ID广播\"></a>BTC创建UTXO并用Joy ID广播</h2><h3 id=\"安装依赖\"><a href=\"#安装依赖\" class=\"headerlink\" title=\"安装依赖\"></a>安装依赖</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pnpm install bitcoinjs-lib tiny-secp256k1 axios @joyid/bitcoin</span><br></pre></td></tr></table></figure>\n<h3 id=\"获取剩余UTXO\"><a href=\"#获取剩余UTXO\" class=\"headerlink\" title=\"获取剩余UTXO\"></a>获取剩余UTXO</h3><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">getUtxos</span> = <span class=\"keyword\">async</span> (<span class=\"params\"><span class=\"attr\">address</span>: <span class=\"built_in\">string</span></span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> response = <span class=\"keyword\">await</span> axios.<span class=\"title function_\">get</span>(<span class=\"string\">`https://blockstream.info/testnet/api/address/<span class=\"subst\">$&#123;address&#125;</span>/utxo`</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> response.<span class=\"property\">data</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (error) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">error</span>(<span class=\"string\">&#x27;Error fetching UTXO:&#x27;</span>, error);</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> error;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"创建交易\"><a href=\"#创建交易\" class=\"headerlink\" title=\"创建交易\"></a>创建交易</h3><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">    <span class=\"keyword\">const</span> [txHex, setTxHex] = <span class=\"title function_\">useState</span>(<span class=\"string\">&#x27;&#x27;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"title function_\">createTransaction</span> = <span class=\"keyword\">async</span> (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> network = bitcoin.<span class=\"property\">networks</span>.<span class=\"property\">testnet</span>; <span class=\"comment\">// 使用比特币测试网络</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> senderAddress = address;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> recipientAddress = <span class=\"string\">&#x27;tb1qp4gpusm5vq7ysa38wa92a6n8ps89hp7ts2907m&#x27;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> amountToSend = <span class=\"number\">0.0001</span> * <span class=\"number\">1e8</span>; <span class=\"comment\">// 发送的金额，单位是聪（satoshis）</span></span><br><span class=\"line\">    <span class=\"comment\">// 获取 UTXO（未花费的交易输出）</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> utxos = <span class=\"keyword\">await</span> <span class=\"title function_\">getUtxos</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (utxos.<span class=\"property\">length</span> === <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Error</span>(<span class=\"string\">&#x27;No UTXOs available for the address.&#x27;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> utxo = utxos[<span class=\"number\">0</span>]; <span class=\"comment\">// 使用第一个 UTXO，实际应用中可能需要选择最佳 UTXO</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 检查 txid 是否有效</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!<span class=\"regexp\">/^[0-9a-fA-F]&#123;64&#125;$/</span>.<span class=\"title function_\">test</span>(utxo.<span class=\"property\">txid</span>)) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">TypeError</span>(<span class=\"string\">&#x27;Invalid txid&#x27;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 创建 PSBT</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> psbt = <span class=\"keyword\">new</span> bitcoin.<span class=\"title class_\">Psbt</span>(&#123; network &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        psbt.<span class=\"title function_\">addInput</span>(&#123;</span><br><span class=\"line\">            <span class=\"attr\">hash</span>: utxo.<span class=\"property\">txid</span>,</span><br><span class=\"line\">            <span class=\"attr\">index</span>: utxo.<span class=\"property\">vout</span>,</span><br><span class=\"line\">            <span class=\"attr\">witnessUtxo</span>: &#123;</span><br><span class=\"line\">                <span class=\"attr\">script</span>: bitcoin.<span class=\"property\">address</span>.<span class=\"title function_\">toOutputScript</span>(senderAddress, network),</span><br><span class=\"line\">                <span class=\"attr\">value</span>: utxo.<span class=\"property\">value</span>,</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (error) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> error;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        psbt.<span class=\"title function_\">addOutput</span>(&#123;</span><br><span class=\"line\">            <span class=\"attr\">address</span>: recipientAddress,</span><br><span class=\"line\">            <span class=\"attr\">value</span>: amountToSend,</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (error) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> error;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 找零地址和找零金额，如果有的话</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> changeAddress = senderAddress;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> fee = <span class=\"number\">0.00001</span> * <span class=\"number\">1e8</span>; <span class=\"comment\">// 示例费用</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> changeValue = utxo.<span class=\"property\">value</span> - amountToSend - fee;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (changeValue &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            psbt.<span class=\"title function_\">addOutput</span>(&#123;</span><br><span class=\"line\">                <span class=\"attr\">address</span>: changeAddress,</span><br><span class=\"line\">                <span class=\"attr\">value</span>: changeValue,</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (error) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> error;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> psbtHex = psbt.<span class=\"title function_\">toHex</span>();</span><br><span class=\"line\">    <span class=\"title function_\">setTxHex</span>(psbtHex)</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"监听到psbtHex创建完成捕获并使用JoyID广播\"><a href=\"#监听到psbtHex创建完成捕获并使用JoyID广播\" class=\"headerlink\" title=\"监听到psbtHex创建完成捕获并使用JoyID广播\"></a>监听到psbtHex创建完成捕获并使用JoyID广播</h3><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; sendPsbt &#125; <span class=\"keyword\">from</span> <span class=\"string\">&quot;@joyid/bitcoin&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">sendContract</span> = <span class=\"keyword\">async</span> (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> tx = <span class=\"keyword\">await</span> <span class=\"title function_\">sendPsbt</span>(txHex)</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(tx, <span class=\"string\">&#x27;tx&#x27;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"播放Spine动画","abbrlink":"35eaf0f1","date":"2024-08-08T10:20:44.000Z","cover":"https://zh.esotericsoftware.com/img/core/spine_logo_bright.svg","top_img":"https://zh.esotericsoftware.com/img/core/spine_logo_bright.svg","_content":"### 安装spine官方依赖\n```shell\npnpm add @esotericsoftware/spine-player\n```\n### 播放函数(需将动画文件传到CDN或保存到项目文件夹)\n```ts\nconst playerContainerRef: any = useRef<HTMLDivElement>(null);\n\nconst loadFiles = () => {\n    const skeletonJsonUrl = `https://xxx/atlas/box-gem/box.json`\n    const atlasUrl = `https://xxx/atlas/box-gem/box.atlas`\n    const player: any = new SpinePlayer(playerContainerRef.current, {\n        jsonUrl: skeletonJsonUrl,\n        atlasUrl: atlasUrl,\n        animation: 'idle',\n        alpha: true,\n        showLoading: false\n    } as any);\n    playerContainerRef.current.style.pointerEvents = 'none';\n};\n\nuseEffect(() => {\n    loadFiles()\n}, []);\n```\n","source":"_posts/播放Spine动画.md","raw":"---\ntitle: 播放Spine动画\nabbrlink: 35eaf0f1\ndate: 2024-08-08 18:20:44\ntags: Animate\ncover: https://zh.esotericsoftware.com/img/core/spine_logo_bright.svg\ntop_img: https://zh.esotericsoftware.com/img/core/spine_logo_bright.svg\n---\n### 安装spine官方依赖\n```shell\npnpm add @esotericsoftware/spine-player\n```\n### 播放函数(需将动画文件传到CDN或保存到项目文件夹)\n```ts\nconst playerContainerRef: any = useRef<HTMLDivElement>(null);\n\nconst loadFiles = () => {\n    const skeletonJsonUrl = `https://xxx/atlas/box-gem/box.json`\n    const atlasUrl = `https://xxx/atlas/box-gem/box.atlas`\n    const player: any = new SpinePlayer(playerContainerRef.current, {\n        jsonUrl: skeletonJsonUrl,\n        atlasUrl: atlasUrl,\n        animation: 'idle',\n        alpha: true,\n        showLoading: false\n    } as any);\n    playerContainerRef.current.style.pointerEvents = 'none';\n};\n\nuseEffect(() => {\n    loadFiles()\n}, []);\n```\n","slug":"播放Spine动画","published":1,"updated":"2024-08-08T10:33:34.696Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clzl55jzv0000k8kv9dao807d","content":"<h3 id=\"安装spine官方依赖\"><a href=\"#安装spine官方依赖\" class=\"headerlink\" title=\"安装spine官方依赖\"></a>安装spine官方依赖</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pnpm add @esotericsoftware/spine-player</span><br></pre></td></tr></table></figure>\n<h3 id=\"播放函数-需将动画文件传到CDN或保存到项目文件夹\"><a href=\"#播放函数-需将动画文件传到CDN或保存到项目文件夹\" class=\"headerlink\" title=\"播放函数(需将动画文件传到CDN或保存到项目文件夹)\"></a>播放函数(需将动画文件传到CDN或保存到项目文件夹)</h3><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"attr\">playerContainerRef</span>: <span class=\"built_in\">any</span> = useRef&lt;<span class=\"title class_\">HTMLDivElement</span>&gt;(<span class=\"literal\">null</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">loadFiles</span> = (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> skeletonJsonUrl = <span class=\"string\">`https://xxx/atlas/box-gem/box.json`</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> atlasUrl = <span class=\"string\">`https://xxx/atlas/box-gem/box.atlas`</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"attr\">player</span>: <span class=\"built_in\">any</span> = <span class=\"keyword\">new</span> <span class=\"title class_\">SpinePlayer</span>(playerContainerRef.<span class=\"property\">current</span>, &#123;</span><br><span class=\"line\">        <span class=\"attr\">jsonUrl</span>: skeletonJsonUrl,</span><br><span class=\"line\">        <span class=\"attr\">atlasUrl</span>: atlasUrl,</span><br><span class=\"line\">        <span class=\"attr\">animation</span>: <span class=\"string\">&#x27;idle&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">alpha</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">        <span class=\"attr\">showLoading</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">as</span> <span class=\"built_in\">any</span>);</span><br><span class=\"line\">    playerContainerRef.<span class=\"property\">current</span>.<span class=\"property\">style</span>.<span class=\"property\">pointerEvents</span> = <span class=\"string\">&#x27;none&#x27;</span>;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_\">useEffect</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"title function_\">loadFiles</span>()</span><br><span class=\"line\">&#125;, []);</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"安装spine官方依赖\"><a href=\"#安装spine官方依赖\" class=\"headerlink\" title=\"安装spine官方依赖\"></a>安装spine官方依赖</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pnpm add @esotericsoftware/spine-player</span><br></pre></td></tr></table></figure>\n<h3 id=\"播放函数-需将动画文件传到CDN或保存到项目文件夹\"><a href=\"#播放函数-需将动画文件传到CDN或保存到项目文件夹\" class=\"headerlink\" title=\"播放函数(需将动画文件传到CDN或保存到项目文件夹)\"></a>播放函数(需将动画文件传到CDN或保存到项目文件夹)</h3><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"attr\">playerContainerRef</span>: <span class=\"built_in\">any</span> = useRef&lt;<span class=\"title class_\">HTMLDivElement</span>&gt;(<span class=\"literal\">null</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">loadFiles</span> = (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> skeletonJsonUrl = <span class=\"string\">`https://xxx/atlas/box-gem/box.json`</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> atlasUrl = <span class=\"string\">`https://xxx/atlas/box-gem/box.atlas`</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"attr\">player</span>: <span class=\"built_in\">any</span> = <span class=\"keyword\">new</span> <span class=\"title class_\">SpinePlayer</span>(playerContainerRef.<span class=\"property\">current</span>, &#123;</span><br><span class=\"line\">        <span class=\"attr\">jsonUrl</span>: skeletonJsonUrl,</span><br><span class=\"line\">        <span class=\"attr\">atlasUrl</span>: atlasUrl,</span><br><span class=\"line\">        <span class=\"attr\">animation</span>: <span class=\"string\">&#x27;idle&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">alpha</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">        <span class=\"attr\">showLoading</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">as</span> <span class=\"built_in\">any</span>);</span><br><span class=\"line\">    playerContainerRef.<span class=\"property\">current</span>.<span class=\"property\">style</span>.<span class=\"property\">pointerEvents</span> = <span class=\"string\">&#x27;none&#x27;</span>;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_\">useEffect</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"title function_\">loadFiles</span>()</span><br><span class=\"line\">&#125;, []);</span><br></pre></td></tr></table></figure>\n"},{"title":"Wagmi返回合约完整错误日志","abbrlink":"c49bf0df","date":"2024-08-09T06:44:36.000Z","cover":"https://s1.ax1x.com/2022/05/10/OtyPTx.jpg","top_img":"https://s1.ax1x.com/2022/05/10/OtyvUP.jpg","_content":"### 使用Wallet Connect + Wagmi 集成EVM登录交易等操作遇到的一些问题\n#### 使用useWriteContract发起合约交易直接打印错误日志返回的信息不完整官方文档也没有给到完整的Error信息返回处理，搜也搜不到，去wagmi的discord下面找到了用户自己写的一个解析Wagmi的方法如下\n```ts\nimport { BaseError } from \"wagmi\";\n\nconst { data: hash, isPending, writeContractAsync, isSuccess: hashSuccess } = useWriteContract()\n\nconst massComputed = () => {\n    writeContractAsync({\n        address: contractAddress,\n        abi: abi,\n        functionName: 'contractFunction',\n        gas: gasLimit\n    })\n        .then((res: any) => {\n            console.log(res);\n        })\n        .catch((error: any) => {\n            if (error) {\n                const shortMessage = (error as BaseError)?.shortMessage;\n                console.log(shortMessage);\n            }\n        })\n}\n\n```\n### 目前react版本的解析方式是这样的vue版本目前没有好的办法，谁让这个框架是老外发明的呢，兼容性做的有点差","source":"_posts/Wagmi返回合约完整错误日志.md","raw":"---\ntitle: Wagmi返回合约完整错误日志\nabbrlink: c49bf0df\ndate: 2024-08-09 14:44:36\ntags: Web3.js\ncover: 'https://s1.ax1x.com/2022/05/10/OtyPTx.jpg'\ntop_img: 'https://s1.ax1x.com/2022/05/10/OtyvUP.jpg'\n---\n### 使用Wallet Connect + Wagmi 集成EVM登录交易等操作遇到的一些问题\n#### 使用useWriteContract发起合约交易直接打印错误日志返回的信息不完整官方文档也没有给到完整的Error信息返回处理，搜也搜不到，去wagmi的discord下面找到了用户自己写的一个解析Wagmi的方法如下\n```ts\nimport { BaseError } from \"wagmi\";\n\nconst { data: hash, isPending, writeContractAsync, isSuccess: hashSuccess } = useWriteContract()\n\nconst massComputed = () => {\n    writeContractAsync({\n        address: contractAddress,\n        abi: abi,\n        functionName: 'contractFunction',\n        gas: gasLimit\n    })\n        .then((res: any) => {\n            console.log(res);\n        })\n        .catch((error: any) => {\n            if (error) {\n                const shortMessage = (error as BaseError)?.shortMessage;\n                console.log(shortMessage);\n            }\n        })\n}\n\n```\n### 目前react版本的解析方式是这样的vue版本目前没有好的办法，谁让这个框架是老外发明的呢，兼容性做的有点差","slug":"Wagmi返回合约完整错误日志","published":1,"updated":"2024-08-09T06:57:05.513Z","_id":"clzmcegld000028kvfj3c8yfb","comments":1,"layout":"post","photos":[],"link":"","content":"<h3 id=\"使用Wallet-Connect-Wagmi-集成EVM登录交易等操作遇到的一些问题\"><a href=\"#使用Wallet-Connect-Wagmi-集成EVM登录交易等操作遇到的一些问题\" class=\"headerlink\" title=\"使用Wallet Connect + Wagmi 集成EVM登录交易等操作遇到的一些问题\"></a>使用Wallet Connect + Wagmi 集成EVM登录交易等操作遇到的一些问题</h3><h4 id=\"使用useWriteContract发起合约交易直接打印错误日志返回的信息不完整官方文档也没有给到完整的Error信息返回处理，搜也搜不到，去wagmi的discord下面找到了用户自己写的一个解析Wagmi的方法如下\"><a href=\"#使用useWriteContract发起合约交易直接打印错误日志返回的信息不完整官方文档也没有给到完整的Error信息返回处理，搜也搜不到，去wagmi的discord下面找到了用户自己写的一个解析Wagmi的方法如下\" class=\"headerlink\" title=\"使用useWriteContract发起合约交易直接打印错误日志返回的信息不完整官方文档也没有给到完整的Error信息返回处理，搜也搜不到，去wagmi的discord下面找到了用户自己写的一个解析Wagmi的方法如下\"></a>使用useWriteContract发起合约交易直接打印错误日志返回的信息不完整官方文档也没有给到完整的Error信息返回处理，搜也搜不到，去wagmi的discord下面找到了用户自己写的一个解析Wagmi的方法如下</h4><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; <span class=\"title class_\">BaseError</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&quot;wagmi&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> &#123; <span class=\"attr\">data</span>: hash, isPending, writeContractAsync, <span class=\"attr\">isSuccess</span>: hashSuccess &#125; = <span class=\"title function_\">useWriteContract</span>()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">massComputed</span> = (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"title function_\">writeContractAsync</span>(&#123;</span><br><span class=\"line\">        <span class=\"attr\">address</span>: contractAddress,</span><br><span class=\"line\">        <span class=\"attr\">abi</span>: abi,</span><br><span class=\"line\">        <span class=\"attr\">functionName</span>: <span class=\"string\">&#x27;contractFunction&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">gas</span>: gasLimit</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">        .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\"><span class=\"attr\">res</span>: <span class=\"built_in\">any</span></span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(res);</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .<span class=\"title function_\">catch</span>(<span class=\"function\">(<span class=\"params\"><span class=\"attr\">error</span>: <span class=\"built_in\">any</span></span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (error) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">const</span> shortMessage = (error <span class=\"keyword\">as</span> <span class=\"title class_\">BaseError</span>)?.<span class=\"property\">shortMessage</span>;</span><br><span class=\"line\">                <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(shortMessage);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"目前react版本的解析方式是这样的vue版本目前没有好的办法，谁让这个框架是老外发明的呢，兼容性做的有点差\"><a href=\"#目前react版本的解析方式是这样的vue版本目前没有好的办法，谁让这个框架是老外发明的呢，兼容性做的有点差\" class=\"headerlink\" title=\"目前react版本的解析方式是这样的vue版本目前没有好的办法，谁让这个框架是老外发明的呢，兼容性做的有点差\"></a>目前react版本的解析方式是这样的vue版本目前没有好的办法，谁让这个框架是老外发明的呢，兼容性做的有点差</h3>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"使用Wallet-Connect-Wagmi-集成EVM登录交易等操作遇到的一些问题\"><a href=\"#使用Wallet-Connect-Wagmi-集成EVM登录交易等操作遇到的一些问题\" class=\"headerlink\" title=\"使用Wallet Connect + Wagmi 集成EVM登录交易等操作遇到的一些问题\"></a>使用Wallet Connect + Wagmi 集成EVM登录交易等操作遇到的一些问题</h3><h4 id=\"使用useWriteContract发起合约交易直接打印错误日志返回的信息不完整官方文档也没有给到完整的Error信息返回处理，搜也搜不到，去wagmi的discord下面找到了用户自己写的一个解析Wagmi的方法如下\"><a href=\"#使用useWriteContract发起合约交易直接打印错误日志返回的信息不完整官方文档也没有给到完整的Error信息返回处理，搜也搜不到，去wagmi的discord下面找到了用户自己写的一个解析Wagmi的方法如下\" class=\"headerlink\" title=\"使用useWriteContract发起合约交易直接打印错误日志返回的信息不完整官方文档也没有给到完整的Error信息返回处理，搜也搜不到，去wagmi的discord下面找到了用户自己写的一个解析Wagmi的方法如下\"></a>使用useWriteContract发起合约交易直接打印错误日志返回的信息不完整官方文档也没有给到完整的Error信息返回处理，搜也搜不到，去wagmi的discord下面找到了用户自己写的一个解析Wagmi的方法如下</h4><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; <span class=\"title class_\">BaseError</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&quot;wagmi&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> &#123; <span class=\"attr\">data</span>: hash, isPending, writeContractAsync, <span class=\"attr\">isSuccess</span>: hashSuccess &#125; = <span class=\"title function_\">useWriteContract</span>()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">massComputed</span> = (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"title function_\">writeContractAsync</span>(&#123;</span><br><span class=\"line\">        <span class=\"attr\">address</span>: contractAddress,</span><br><span class=\"line\">        <span class=\"attr\">abi</span>: abi,</span><br><span class=\"line\">        <span class=\"attr\">functionName</span>: <span class=\"string\">&#x27;contractFunction&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">gas</span>: gasLimit</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">        .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\"><span class=\"attr\">res</span>: <span class=\"built_in\">any</span></span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(res);</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .<span class=\"title function_\">catch</span>(<span class=\"function\">(<span class=\"params\"><span class=\"attr\">error</span>: <span class=\"built_in\">any</span></span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (error) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">const</span> shortMessage = (error <span class=\"keyword\">as</span> <span class=\"title class_\">BaseError</span>)?.<span class=\"property\">shortMessage</span>;</span><br><span class=\"line\">                <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(shortMessage);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"目前react版本的解析方式是这样的vue版本目前没有好的办法，谁让这个框架是老外发明的呢，兼容性做的有点差\"><a href=\"#目前react版本的解析方式是这样的vue版本目前没有好的办法，谁让这个框架是老外发明的呢，兼容性做的有点差\" class=\"headerlink\" title=\"目前react版本的解析方式是这样的vue版本目前没有好的办法，谁让这个框架是老外发明的呢，兼容性做的有点差\"></a>目前react版本的解析方式是这样的vue版本目前没有好的办法，谁让这个框架是老外发明的呢，兼容性做的有点差</h3>"},{"title":"OKX插件登录BTC","abbrlink":"4c3e688d","date":"2024-08-09T07:05:01.000Z","cover":"/images/okx-banner.png","top_img":"/images/okx-banner.png","_content":"### 由于BTC网络的登录并不像wallet connect EVM网络那样使用现成的包直接可以建立连接器只要你浏览器内部装有OKX插件就可以直接唤起并登录具体方法如下\n\n#### PC端登录方法\n```ts\nconst connectBTC = () => {\n    if (typeof (window as any).okxwallet !== 'undefined') {\n        const res = await (window as any).okxwallet.bitcoin.requestAccounts();\n    } else {\n        console.log('OKX Wallet is not installed.');\n    }\n}\n```\n#### PC发起交易 目前仅支持BTC主网\n```ts\nconst sendBTC = () => {\n    try {\n        await (window as any).okxwallet.bitcoin.sendBitcoin(\n            acceptAddress, // 接收地址\n            6000, // 发送金额 单位：聪\n            {\n                feeRate: 10 // 指定费率\n            }\n        );\n    } catch (error) {\n        console.error(error)\n    }\n}\n```\n#### 移动端登录跟PC端登录有显著区别因为移动端浏览器没法装插件钱包需要跳转到OKX的App中再执行登录操作\n```ts\nconst checkOkxWallet = async () => {\n    // 检查是否监听到浏览器插件\n    if (typeof (window as any).okxwallet !== 'undefined') {\n        try {\n            const accounts = await (window as any).bitcoin.requestAccounts();\n        } catch (e) {\n            console.log('connect failed', e);\n        }\n    } else {\n        initOKXWallet()\n    }\n};\nconst initOKXWallet = () => {\n    // 调转到OKX App的内部浏览器\n    const encodedUrl = \"https://www.okx.com/download?deeplink=\" + encodeURIComponent(\"okx://wallet/dapp/url?dappUrl=\" + encodeURIComponent(location.href));\n    window.location.href = encodedUrl;\n}\n```\n#### 移动端OKX使用BTC发送交易\n```ts\n    const okxSend = async () => {\n    const acceptAddress = 'your btc address'\n    try {\n        const txid = await (window as any).bitcoin.sendBitcoin(\n            acceptAddress, // 收款地址\n            6000, // 金额单位：聪\n            {\n                feeRate: 10 // 费率\n            }\n        );\n        console.log(txid, 'tx');\n    } catch (error) {\n        console.log(error);\n    }\n}\n```\n#### 总的来说还是身份方便的，省去了构建UTXO的烦恼","source":"_posts/OKX登录BTC.md","raw":"---\ntitle: OKX插件登录BTC\nabbrlink: 4c3e688d\ndate: 2024-08-09 15:05:01\ntags: BTC\ncover: '/images/okx-banner.png'\ntop_img: '/images/okx-banner.png'\n---\n### 由于BTC网络的登录并不像wallet connect EVM网络那样使用现成的包直接可以建立连接器只要你浏览器内部装有OKX插件就可以直接唤起并登录具体方法如下\n\n#### PC端登录方法\n```ts\nconst connectBTC = () => {\n    if (typeof (window as any).okxwallet !== 'undefined') {\n        const res = await (window as any).okxwallet.bitcoin.requestAccounts();\n    } else {\n        console.log('OKX Wallet is not installed.');\n    }\n}\n```\n#### PC发起交易 目前仅支持BTC主网\n```ts\nconst sendBTC = () => {\n    try {\n        await (window as any).okxwallet.bitcoin.sendBitcoin(\n            acceptAddress, // 接收地址\n            6000, // 发送金额 单位：聪\n            {\n                feeRate: 10 // 指定费率\n            }\n        );\n    } catch (error) {\n        console.error(error)\n    }\n}\n```\n#### 移动端登录跟PC端登录有显著区别因为移动端浏览器没法装插件钱包需要跳转到OKX的App中再执行登录操作\n```ts\nconst checkOkxWallet = async () => {\n    // 检查是否监听到浏览器插件\n    if (typeof (window as any).okxwallet !== 'undefined') {\n        try {\n            const accounts = await (window as any).bitcoin.requestAccounts();\n        } catch (e) {\n            console.log('connect failed', e);\n        }\n    } else {\n        initOKXWallet()\n    }\n};\nconst initOKXWallet = () => {\n    // 调转到OKX App的内部浏览器\n    const encodedUrl = \"https://www.okx.com/download?deeplink=\" + encodeURIComponent(\"okx://wallet/dapp/url?dappUrl=\" + encodeURIComponent(location.href));\n    window.location.href = encodedUrl;\n}\n```\n#### 移动端OKX使用BTC发送交易\n```ts\n    const okxSend = async () => {\n    const acceptAddress = 'your btc address'\n    try {\n        const txid = await (window as any).bitcoin.sendBitcoin(\n            acceptAddress, // 收款地址\n            6000, // 金额单位：聪\n            {\n                feeRate: 10 // 费率\n            }\n        );\n        console.log(txid, 'tx');\n    } catch (error) {\n        console.log(error);\n    }\n}\n```\n#### 总的来说还是身份方便的，省去了构建UTXO的烦恼","slug":"OKX登录BTC","published":1,"updated":"2024-08-12T02:24:35.136Z","_id":"clzmd3xjv000228kv9864g8mc","comments":1,"layout":"post","photos":[],"link":"","content":"<h3 id=\"由于BTC网络的登录并不像wallet-connect-EVM网络那样使用现成的包直接可以建立连接器只要你浏览器内部装有OKX插件就可以直接唤起并登录具体方法如下\"><a href=\"#由于BTC网络的登录并不像wallet-connect-EVM网络那样使用现成的包直接可以建立连接器只要你浏览器内部装有OKX插件就可以直接唤起并登录具体方法如下\" class=\"headerlink\" title=\"由于BTC网络的登录并不像wallet connect EVM网络那样使用现成的包直接可以建立连接器只要你浏览器内部装有OKX插件就可以直接唤起并登录具体方法如下\"></a>由于BTC网络的登录并不像wallet connect EVM网络那样使用现成的包直接可以建立连接器只要你浏览器内部装有OKX插件就可以直接唤起并登录具体方法如下</h3><h4 id=\"PC端登录方法\"><a href=\"#PC端登录方法\" class=\"headerlink\" title=\"PC端登录方法\"></a>PC端登录方法</h4><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">connectBTC</span> = (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"title function_\">typeof</span> (<span class=\"variable language_\">window</span> <span class=\"keyword\">as</span> <span class=\"built_in\">any</span>).<span class=\"property\">okxwallet</span> !== <span class=\"string\">&#x27;undefined&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> res = <span class=\"title function_\">await</span> (<span class=\"variable language_\">window</span> <span class=\"keyword\">as</span> <span class=\"built_in\">any</span>).<span class=\"property\">okxwallet</span>.<span class=\"property\">bitcoin</span>.<span class=\"title function_\">requestAccounts</span>();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;OKX Wallet is not installed.&#x27;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"PC发起交易-目前仅支持BTC主网\"><a href=\"#PC发起交易-目前仅支持BTC主网\" class=\"headerlink\" title=\"PC发起交易 目前仅支持BTC主网\"></a>PC发起交易 目前仅支持BTC主网</h4><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">sendBTC</span> = (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"title function_\">await</span> (<span class=\"variable language_\">window</span> <span class=\"keyword\">as</span> <span class=\"built_in\">any</span>).<span class=\"property\">okxwallet</span>.<span class=\"property\">bitcoin</span>.<span class=\"title function_\">sendBitcoin</span>(</span><br><span class=\"line\">            acceptAddress, <span class=\"comment\">// 接收地址</span></span><br><span class=\"line\">            <span class=\"number\">6000</span>, <span class=\"comment\">// 发送金额 单位：聪</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"attr\">feeRate</span>: <span class=\"number\">10</span> <span class=\"comment\">// 指定费率</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        );</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (error) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">error</span>(error)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"移动端登录跟PC端登录有显著区别因为移动端浏览器没法装插件钱包需要跳转到OKX的App中再执行登录操作\"><a href=\"#移动端登录跟PC端登录有显著区别因为移动端浏览器没法装插件钱包需要跳转到OKX的App中再执行登录操作\" class=\"headerlink\" title=\"移动端登录跟PC端登录有显著区别因为移动端浏览器没法装插件钱包需要跳转到OKX的App中再执行登录操作\"></a>移动端登录跟PC端登录有显著区别因为移动端浏览器没法装插件钱包需要跳转到OKX的App中再执行登录操作</h4><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">checkOkxWallet</span> = <span class=\"keyword\">async</span> (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 检查是否监听到浏览器插件</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"title function_\">typeof</span> (<span class=\"variable language_\">window</span> <span class=\"keyword\">as</span> <span class=\"built_in\">any</span>).<span class=\"property\">okxwallet</span> !== <span class=\"string\">&#x27;undefined&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">const</span> accounts = <span class=\"title function_\">await</span> (<span class=\"variable language_\">window</span> <span class=\"keyword\">as</span> <span class=\"built_in\">any</span>).<span class=\"property\">bitcoin</span>.<span class=\"title function_\">requestAccounts</span>();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;connect failed&#x27;</span>, e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"title function_\">initOKXWallet</span>()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">initOKXWallet</span> = (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 调转到OKX App的内部浏览器</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> encodedUrl = <span class=\"string\">&quot;https://www.okx.com/download?deeplink=&quot;</span> + <span class=\"built_in\">encodeURIComponent</span>(<span class=\"string\">&quot;okx://wallet/dapp/url?dappUrl=&quot;</span> + <span class=\"built_in\">encodeURIComponent</span>(location.<span class=\"property\">href</span>));</span><br><span class=\"line\">    <span class=\"variable language_\">window</span>.<span class=\"property\">location</span>.<span class=\"property\">href</span> = encodedUrl;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"移动端OKX使用BTC发送交易\"><a href=\"#移动端OKX使用BTC发送交易\" class=\"headerlink\" title=\"移动端OKX使用BTC发送交易\"></a>移动端OKX使用BTC发送交易</h4><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"title function_\">okxSend</span> = <span class=\"keyword\">async</span> (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> acceptAddress = <span class=\"string\">&#x27;your btc address&#x27;</span></span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> txid = <span class=\"title function_\">await</span> (<span class=\"variable language_\">window</span> <span class=\"keyword\">as</span> <span class=\"built_in\">any</span>).<span class=\"property\">bitcoin</span>.<span class=\"title function_\">sendBitcoin</span>(</span><br><span class=\"line\">            acceptAddress, <span class=\"comment\">// 收款地址</span></span><br><span class=\"line\">            <span class=\"number\">6000</span>, <span class=\"comment\">// 金额单位：聪</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"attr\">feeRate</span>: <span class=\"number\">10</span> <span class=\"comment\">// 费率</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        );</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(txid, <span class=\"string\">&#x27;tx&#x27;</span>);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (error) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(error);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"总的来说还是身份方便的，省去了构建UTXO的烦恼\"><a href=\"#总的来说还是身份方便的，省去了构建UTXO的烦恼\" class=\"headerlink\" title=\"总的来说还是身份方便的，省去了构建UTXO的烦恼\"></a>总的来说还是身份方便的，省去了构建UTXO的烦恼</h4>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"由于BTC网络的登录并不像wallet-connect-EVM网络那样使用现成的包直接可以建立连接器只要你浏览器内部装有OKX插件就可以直接唤起并登录具体方法如下\"><a href=\"#由于BTC网络的登录并不像wallet-connect-EVM网络那样使用现成的包直接可以建立连接器只要你浏览器内部装有OKX插件就可以直接唤起并登录具体方法如下\" class=\"headerlink\" title=\"由于BTC网络的登录并不像wallet connect EVM网络那样使用现成的包直接可以建立连接器只要你浏览器内部装有OKX插件就可以直接唤起并登录具体方法如下\"></a>由于BTC网络的登录并不像wallet connect EVM网络那样使用现成的包直接可以建立连接器只要你浏览器内部装有OKX插件就可以直接唤起并登录具体方法如下</h3><h4 id=\"PC端登录方法\"><a href=\"#PC端登录方法\" class=\"headerlink\" title=\"PC端登录方法\"></a>PC端登录方法</h4><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">connectBTC</span> = (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"title function_\">typeof</span> (<span class=\"variable language_\">window</span> <span class=\"keyword\">as</span> <span class=\"built_in\">any</span>).<span class=\"property\">okxwallet</span> !== <span class=\"string\">&#x27;undefined&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> res = <span class=\"title function_\">await</span> (<span class=\"variable language_\">window</span> <span class=\"keyword\">as</span> <span class=\"built_in\">any</span>).<span class=\"property\">okxwallet</span>.<span class=\"property\">bitcoin</span>.<span class=\"title function_\">requestAccounts</span>();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;OKX Wallet is not installed.&#x27;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"PC发起交易-目前仅支持BTC主网\"><a href=\"#PC发起交易-目前仅支持BTC主网\" class=\"headerlink\" title=\"PC发起交易 目前仅支持BTC主网\"></a>PC发起交易 目前仅支持BTC主网</h4><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">sendBTC</span> = (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"title function_\">await</span> (<span class=\"variable language_\">window</span> <span class=\"keyword\">as</span> <span class=\"built_in\">any</span>).<span class=\"property\">okxwallet</span>.<span class=\"property\">bitcoin</span>.<span class=\"title function_\">sendBitcoin</span>(</span><br><span class=\"line\">            acceptAddress, <span class=\"comment\">// 接收地址</span></span><br><span class=\"line\">            <span class=\"number\">6000</span>, <span class=\"comment\">// 发送金额 单位：聪</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"attr\">feeRate</span>: <span class=\"number\">10</span> <span class=\"comment\">// 指定费率</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        );</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (error) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">error</span>(error)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"移动端登录跟PC端登录有显著区别因为移动端浏览器没法装插件钱包需要跳转到OKX的App中再执行登录操作\"><a href=\"#移动端登录跟PC端登录有显著区别因为移动端浏览器没法装插件钱包需要跳转到OKX的App中再执行登录操作\" class=\"headerlink\" title=\"移动端登录跟PC端登录有显著区别因为移动端浏览器没法装插件钱包需要跳转到OKX的App中再执行登录操作\"></a>移动端登录跟PC端登录有显著区别因为移动端浏览器没法装插件钱包需要跳转到OKX的App中再执行登录操作</h4><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">checkOkxWallet</span> = <span class=\"keyword\">async</span> (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 检查是否监听到浏览器插件</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"title function_\">typeof</span> (<span class=\"variable language_\">window</span> <span class=\"keyword\">as</span> <span class=\"built_in\">any</span>).<span class=\"property\">okxwallet</span> !== <span class=\"string\">&#x27;undefined&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">const</span> accounts = <span class=\"title function_\">await</span> (<span class=\"variable language_\">window</span> <span class=\"keyword\">as</span> <span class=\"built_in\">any</span>).<span class=\"property\">bitcoin</span>.<span class=\"title function_\">requestAccounts</span>();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;connect failed&#x27;</span>, e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"title function_\">initOKXWallet</span>()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">initOKXWallet</span> = (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 调转到OKX App的内部浏览器</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> encodedUrl = <span class=\"string\">&quot;https://www.okx.com/download?deeplink=&quot;</span> + <span class=\"built_in\">encodeURIComponent</span>(<span class=\"string\">&quot;okx://wallet/dapp/url?dappUrl=&quot;</span> + <span class=\"built_in\">encodeURIComponent</span>(location.<span class=\"property\">href</span>));</span><br><span class=\"line\">    <span class=\"variable language_\">window</span>.<span class=\"property\">location</span>.<span class=\"property\">href</span> = encodedUrl;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"移动端OKX使用BTC发送交易\"><a href=\"#移动端OKX使用BTC发送交易\" class=\"headerlink\" title=\"移动端OKX使用BTC发送交易\"></a>移动端OKX使用BTC发送交易</h4><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"title function_\">okxSend</span> = <span class=\"keyword\">async</span> (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> acceptAddress = <span class=\"string\">&#x27;your btc address&#x27;</span></span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> txid = <span class=\"title function_\">await</span> (<span class=\"variable language_\">window</span> <span class=\"keyword\">as</span> <span class=\"built_in\">any</span>).<span class=\"property\">bitcoin</span>.<span class=\"title function_\">sendBitcoin</span>(</span><br><span class=\"line\">            acceptAddress, <span class=\"comment\">// 收款地址</span></span><br><span class=\"line\">            <span class=\"number\">6000</span>, <span class=\"comment\">// 金额单位：聪</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"attr\">feeRate</span>: <span class=\"number\">10</span> <span class=\"comment\">// 费率</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        );</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(txid, <span class=\"string\">&#x27;tx&#x27;</span>);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (error) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(error);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"总的来说还是身份方便的，省去了构建UTXO的烦恼\"><a href=\"#总的来说还是身份方便的，省去了构建UTXO的烦恼\" class=\"headerlink\" title=\"总的来说还是身份方便的，省去了构建UTXO的烦恼\"></a>总的来说还是身份方便的，省去了构建UTXO的烦恼</h4>"},{"title":"ts实现康威生命游戏","cover":"https://s1.ax1x.com/2022/05/05/OeYnqe.png","top_img":"https://s1.ax1x.com/2022/05/05/OeY4iR.png","abbrlink":"8cc9b930","date":"2024-08-12T03:54:00.000Z","_content":"#### 生命游戏中，对于任意细胞，规则如下：\n1. 每个细胞有两种状态 - 存活或死亡，每个细胞与以自身为中心的周围八格细胞产生互动（如图，黑色为存活，白色为死亡）\n2. 当前细胞为存活状态时，当周围的存活细胞低于2个时（不包含2个），该细胞变成死亡状态。（模拟生命数量稀少）\n3. 当前细胞为存活状态时，当周围有2个或3个存活细胞时，该细胞保持原样。\n4. 当前细胞为存活状态时，当周围有超过3个存活细胞时，该细胞变成死亡状态。（模拟生命数量过多）\n5. 当前细胞为死亡状态时，当周围有3个存活细胞时，该细胞变成存活状态。（模拟繁殖）\n6. 可以把最初的细胞结构定义为种子，当所有在种子中的细胞同时被以上规则处理后，可以得到第一代细胞图。按规则继续处理当前的细胞图，可以得到下一代的细胞图，周而复始。\n\n```ts\nexport class GameOfLife {\n    private activeCells: Array<[number, number]>;\n\n    constructor() {\n        this.activeCells = []; // 初始化矩阵\n    }\n\n    addCell(x: number, y: number): void { // 添加活细胞亮点\n        this.activeCells.push([x, y]);\n    }\n\n    removeCell(x: number, y: number): void { // 删除活细胞亮点\n        this.activeCells = this.activeCells.filter(([cx, cy]) => cx !== x || cy !== y);\n    }\n\n    isActive(x: number, y: number): boolean { // 验证该位置是否有存活的细胞\n        return this.activeCells.some(([cx, cy]) => cx === x && cy === y);\n    }\n\n    private getNeighbors(x: number, y: number): Array<[number, number]> {\n        const neighbors: Array<[number, number]> = [];\n        for (let dx = -1; dx <= 1; dx++) {\n            for (let dy = -1; dy <= 1; dy++) {\n                if (dx === 0 && dy === 0) continue;\n                neighbors.push([x + dx, y + dy]);\n            }\n        }\n        return neighbors;\n    }\n\n    private countActiveNeighbors(x: number, y: number): number {\n        return this.getNeighbors(x, y).reduce(\n            (count, [nx, ny]) => count + (this.isActive(nx, ny) ? 1 : 0),\n            0\n        );\n    }\n\n    step(): void { // 执行一次规则\n        const toEvaluate = new Set<string>();\n        const nextState: Array<[number, number]> = [];\n\n        this.activeCells.forEach(([x, y]) => {\n            toEvaluate.add(`${x},${y}`);\n            this.getNeighbors(x, y).forEach(([nx, ny]) => {\n                toEvaluate.add(`${nx},${ny}`);\n            });\n        });\n\n        toEvaluate.forEach((cell: string) => {\n            const [x, y] = cell.split(\",\").map(Number);\n            const isActive = this.isActive(x, y);\n            const activeNeighbors = this.countActiveNeighbors(x, y);\n            if (\n                (isActive && (activeNeighbors === 2 || activeNeighbors === 3)) ||\n                (!isActive && activeNeighbors === 3)\n            ) {\n                nextState.push([x, y]);\n            }\n        });\n\n        this.activeCells = nextState;\n    }\n}\n```","source":"_posts/ts实现康威生命游戏.md","raw":"---\ntitle: ts实现康威生命游戏\ntags: TypeScript\ncover: 'https://s1.ax1x.com/2022/05/05/OeYnqe.png'\ntop_img: 'https://s1.ax1x.com/2022/05/05/OeY4iR.png'\nabbrlink: 8cc9b930\ndate: 2024-08-12 11:54:00\n---\n#### 生命游戏中，对于任意细胞，规则如下：\n1. 每个细胞有两种状态 - 存活或死亡，每个细胞与以自身为中心的周围八格细胞产生互动（如图，黑色为存活，白色为死亡）\n2. 当前细胞为存活状态时，当周围的存活细胞低于2个时（不包含2个），该细胞变成死亡状态。（模拟生命数量稀少）\n3. 当前细胞为存活状态时，当周围有2个或3个存活细胞时，该细胞保持原样。\n4. 当前细胞为存活状态时，当周围有超过3个存活细胞时，该细胞变成死亡状态。（模拟生命数量过多）\n5. 当前细胞为死亡状态时，当周围有3个存活细胞时，该细胞变成存活状态。（模拟繁殖）\n6. 可以把最初的细胞结构定义为种子，当所有在种子中的细胞同时被以上规则处理后，可以得到第一代细胞图。按规则继续处理当前的细胞图，可以得到下一代的细胞图，周而复始。\n\n```ts\nexport class GameOfLife {\n    private activeCells: Array<[number, number]>;\n\n    constructor() {\n        this.activeCells = []; // 初始化矩阵\n    }\n\n    addCell(x: number, y: number): void { // 添加活细胞亮点\n        this.activeCells.push([x, y]);\n    }\n\n    removeCell(x: number, y: number): void { // 删除活细胞亮点\n        this.activeCells = this.activeCells.filter(([cx, cy]) => cx !== x || cy !== y);\n    }\n\n    isActive(x: number, y: number): boolean { // 验证该位置是否有存活的细胞\n        return this.activeCells.some(([cx, cy]) => cx === x && cy === y);\n    }\n\n    private getNeighbors(x: number, y: number): Array<[number, number]> {\n        const neighbors: Array<[number, number]> = [];\n        for (let dx = -1; dx <= 1; dx++) {\n            for (let dy = -1; dy <= 1; dy++) {\n                if (dx === 0 && dy === 0) continue;\n                neighbors.push([x + dx, y + dy]);\n            }\n        }\n        return neighbors;\n    }\n\n    private countActiveNeighbors(x: number, y: number): number {\n        return this.getNeighbors(x, y).reduce(\n            (count, [nx, ny]) => count + (this.isActive(nx, ny) ? 1 : 0),\n            0\n        );\n    }\n\n    step(): void { // 执行一次规则\n        const toEvaluate = new Set<string>();\n        const nextState: Array<[number, number]> = [];\n\n        this.activeCells.forEach(([x, y]) => {\n            toEvaluate.add(`${x},${y}`);\n            this.getNeighbors(x, y).forEach(([nx, ny]) => {\n                toEvaluate.add(`${nx},${ny}`);\n            });\n        });\n\n        toEvaluate.forEach((cell: string) => {\n            const [x, y] = cell.split(\",\").map(Number);\n            const isActive = this.isActive(x, y);\n            const activeNeighbors = this.countActiveNeighbors(x, y);\n            if (\n                (isActive && (activeNeighbors === 2 || activeNeighbors === 3)) ||\n                (!isActive && activeNeighbors === 3)\n            ) {\n                nextState.push([x, y]);\n            }\n        });\n\n        this.activeCells = nextState;\n    }\n}\n```","slug":"ts实现康威生命游戏","published":1,"updated":"2024-08-12T04:01:57.779Z","_id":"clzqgw0zg000024kvhmgzapnp","comments":1,"layout":"post","photos":[],"link":"","content":"<h4 id=\"生命游戏中，对于任意细胞，规则如下：\"><a href=\"#生命游戏中，对于任意细胞，规则如下：\" class=\"headerlink\" title=\"生命游戏中，对于任意细胞，规则如下：\"></a>生命游戏中，对于任意细胞，规则如下：</h4><ol>\n<li>每个细胞有两种状态 - 存活或死亡，每个细胞与以自身为中心的周围八格细胞产生互动（如图，黑色为存活，白色为死亡）</li>\n<li>当前细胞为存活状态时，当周围的存活细胞低于2个时（不包含2个），该细胞变成死亡状态。（模拟生命数量稀少）</li>\n<li>当前细胞为存活状态时，当周围有2个或3个存活细胞时，该细胞保持原样。</li>\n<li>当前细胞为存活状态时，当周围有超过3个存活细胞时，该细胞变成死亡状态。（模拟生命数量过多）</li>\n<li>当前细胞为死亡状态时，当周围有3个存活细胞时，该细胞变成存活状态。（模拟繁殖）</li>\n<li>可以把最初的细胞结构定义为种子，当所有在种子中的细胞同时被以上规则处理后，可以得到第一代细胞图。按规则继续处理当前的细胞图，可以得到下一代的细胞图，周而复始。</li>\n</ol>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> <span class=\"title class_\">GameOfLife</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"attr\">activeCells</span>: <span class=\"title class_\">Array</span>&lt;[<span class=\"built_in\">number</span>, <span class=\"built_in\">number</span>]&gt;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">constructor</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">activeCells</span> = []; <span class=\"comment\">// 初始化矩阵</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">addCell</span>(<span class=\"attr\">x</span>: <span class=\"built_in\">number</span>, <span class=\"attr\">y</span>: <span class=\"built_in\">number</span>): <span class=\"built_in\">void</span> &#123; <span class=\"comment\">// 添加活细胞亮点</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">activeCells</span>.<span class=\"title function_\">push</span>([x, y]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">removeCell</span>(<span class=\"attr\">x</span>: <span class=\"built_in\">number</span>, <span class=\"attr\">y</span>: <span class=\"built_in\">number</span>): <span class=\"built_in\">void</span> &#123; <span class=\"comment\">// 删除活细胞亮点</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">activeCells</span> = <span class=\"variable language_\">this</span>.<span class=\"property\">activeCells</span>.<span class=\"title function_\">filter</span>(<span class=\"function\">(<span class=\"params\">[cx, cy]</span>) =&gt;</span> cx !== x || cy !== y);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">isActive</span>(<span class=\"attr\">x</span>: <span class=\"built_in\">number</span>, <span class=\"attr\">y</span>: <span class=\"built_in\">number</span>): <span class=\"built_in\">boolean</span> &#123; <span class=\"comment\">// 验证该位置是否有存活的细胞</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.<span class=\"property\">activeCells</span>.<span class=\"title function_\">some</span>(<span class=\"function\">(<span class=\"params\">[cx, cy]</span>) =&gt;</span> cx === x &amp;&amp; cy === y);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"title function_\">getNeighbors</span>(<span class=\"attr\">x</span>: <span class=\"built_in\">number</span>, <span class=\"attr\">y</span>: <span class=\"built_in\">number</span>): <span class=\"title class_\">Array</span>&lt;[<span class=\"built_in\">number</span>, <span class=\"built_in\">number</span>]&gt; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> <span class=\"attr\">neighbors</span>: <span class=\"title class_\">Array</span>&lt;[<span class=\"built_in\">number</span>, <span class=\"built_in\">number</span>]&gt; = [];</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> dx = -<span class=\"number\">1</span>; dx &lt;= <span class=\"number\">1</span>; dx++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> dy = -<span class=\"number\">1</span>; dy &lt;= <span class=\"number\">1</span>; dy++) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (dx === <span class=\"number\">0</span> &amp;&amp; dy === <span class=\"number\">0</span>) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">                neighbors.<span class=\"title function_\">push</span>([x + dx, y + dy]);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> neighbors;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"title function_\">countActiveNeighbors</span>(<span class=\"attr\">x</span>: <span class=\"built_in\">number</span>, <span class=\"attr\">y</span>: <span class=\"built_in\">number</span>): <span class=\"built_in\">number</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.<span class=\"title function_\">getNeighbors</span>(x, y).<span class=\"title function_\">reduce</span>(</span><br><span class=\"line\">            <span class=\"function\">(<span class=\"params\">count, [nx, ny]</span>) =&gt;</span> count + (<span class=\"variable language_\">this</span>.<span class=\"title function_\">isActive</span>(nx, ny) ? <span class=\"number\">1</span> : <span class=\"number\">0</span>),</span><br><span class=\"line\">            <span class=\"number\">0</span></span><br><span class=\"line\">        );</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">step</span>(): <span class=\"built_in\">void</span> &#123; <span class=\"comment\">// 执行一次规则</span></span><br><span class=\"line\">        <span class=\"keyword\">const</span> toEvaluate = <span class=\"keyword\">new</span> <span class=\"title class_\">Set</span>&lt;<span class=\"built_in\">string</span>&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">const</span> <span class=\"attr\">nextState</span>: <span class=\"title class_\">Array</span>&lt;[<span class=\"built_in\">number</span>, <span class=\"built_in\">number</span>]&gt; = [];</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">activeCells</span>.<span class=\"title function_\">forEach</span>(<span class=\"function\">(<span class=\"params\">[x, y]</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            toEvaluate.<span class=\"title function_\">add</span>(<span class=\"string\">`<span class=\"subst\">$&#123;x&#125;</span>,<span class=\"subst\">$&#123;y&#125;</span>`</span>);</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.<span class=\"title function_\">getNeighbors</span>(x, y).<span class=\"title function_\">forEach</span>(<span class=\"function\">(<span class=\"params\">[nx, ny]</span>) =&gt;</span> &#123;</span><br><span class=\"line\">                toEvaluate.<span class=\"title function_\">add</span>(<span class=\"string\">`<span class=\"subst\">$&#123;nx&#125;</span>,<span class=\"subst\">$&#123;ny&#125;</span>`</span>);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">        toEvaluate.<span class=\"title function_\">forEach</span>(<span class=\"function\">(<span class=\"params\"><span class=\"attr\">cell</span>: <span class=\"built_in\">string</span></span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">const</span> [x, y] = cell.<span class=\"title function_\">split</span>(<span class=\"string\">&quot;,&quot;</span>).<span class=\"title function_\">map</span>(<span class=\"title class_\">Number</span>);</span><br><span class=\"line\">            <span class=\"keyword\">const</span> isActive = <span class=\"variable language_\">this</span>.<span class=\"title function_\">isActive</span>(x, y);</span><br><span class=\"line\">            <span class=\"keyword\">const</span> activeNeighbors = <span class=\"variable language_\">this</span>.<span class=\"title function_\">countActiveNeighbors</span>(x, y);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (</span><br><span class=\"line\">                (isActive &amp;&amp; (activeNeighbors === <span class=\"number\">2</span> || activeNeighbors === <span class=\"number\">3</span>)) ||</span><br><span class=\"line\">                (!isActive &amp;&amp; activeNeighbors === <span class=\"number\">3</span>)</span><br><span class=\"line\">            ) &#123;</span><br><span class=\"line\">                nextState.<span class=\"title function_\">push</span>([x, y]);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">activeCells</span> = nextState;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h4 id=\"生命游戏中，对于任意细胞，规则如下：\"><a href=\"#生命游戏中，对于任意细胞，规则如下：\" class=\"headerlink\" title=\"生命游戏中，对于任意细胞，规则如下：\"></a>生命游戏中，对于任意细胞，规则如下：</h4><ol>\n<li>每个细胞有两种状态 - 存活或死亡，每个细胞与以自身为中心的周围八格细胞产生互动（如图，黑色为存活，白色为死亡）</li>\n<li>当前细胞为存活状态时，当周围的存活细胞低于2个时（不包含2个），该细胞变成死亡状态。（模拟生命数量稀少）</li>\n<li>当前细胞为存活状态时，当周围有2个或3个存活细胞时，该细胞保持原样。</li>\n<li>当前细胞为存活状态时，当周围有超过3个存活细胞时，该细胞变成死亡状态。（模拟生命数量过多）</li>\n<li>当前细胞为死亡状态时，当周围有3个存活细胞时，该细胞变成存活状态。（模拟繁殖）</li>\n<li>可以把最初的细胞结构定义为种子，当所有在种子中的细胞同时被以上规则处理后，可以得到第一代细胞图。按规则继续处理当前的细胞图，可以得到下一代的细胞图，周而复始。</li>\n</ol>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">class</span> <span class=\"title class_\">GameOfLife</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"attr\">activeCells</span>: <span class=\"title class_\">Array</span>&lt;[<span class=\"built_in\">number</span>, <span class=\"built_in\">number</span>]&gt;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">constructor</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">activeCells</span> = []; <span class=\"comment\">// 初始化矩阵</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">addCell</span>(<span class=\"attr\">x</span>: <span class=\"built_in\">number</span>, <span class=\"attr\">y</span>: <span class=\"built_in\">number</span>): <span class=\"built_in\">void</span> &#123; <span class=\"comment\">// 添加活细胞亮点</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">activeCells</span>.<span class=\"title function_\">push</span>([x, y]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">removeCell</span>(<span class=\"attr\">x</span>: <span class=\"built_in\">number</span>, <span class=\"attr\">y</span>: <span class=\"built_in\">number</span>): <span class=\"built_in\">void</span> &#123; <span class=\"comment\">// 删除活细胞亮点</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">activeCells</span> = <span class=\"variable language_\">this</span>.<span class=\"property\">activeCells</span>.<span class=\"title function_\">filter</span>(<span class=\"function\">(<span class=\"params\">[cx, cy]</span>) =&gt;</span> cx !== x || cy !== y);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">isActive</span>(<span class=\"attr\">x</span>: <span class=\"built_in\">number</span>, <span class=\"attr\">y</span>: <span class=\"built_in\">number</span>): <span class=\"built_in\">boolean</span> &#123; <span class=\"comment\">// 验证该位置是否有存活的细胞</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.<span class=\"property\">activeCells</span>.<span class=\"title function_\">some</span>(<span class=\"function\">(<span class=\"params\">[cx, cy]</span>) =&gt;</span> cx === x &amp;&amp; cy === y);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"title function_\">getNeighbors</span>(<span class=\"attr\">x</span>: <span class=\"built_in\">number</span>, <span class=\"attr\">y</span>: <span class=\"built_in\">number</span>): <span class=\"title class_\">Array</span>&lt;[<span class=\"built_in\">number</span>, <span class=\"built_in\">number</span>]&gt; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> <span class=\"attr\">neighbors</span>: <span class=\"title class_\">Array</span>&lt;[<span class=\"built_in\">number</span>, <span class=\"built_in\">number</span>]&gt; = [];</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> dx = -<span class=\"number\">1</span>; dx &lt;= <span class=\"number\">1</span>; dx++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> dy = -<span class=\"number\">1</span>; dy &lt;= <span class=\"number\">1</span>; dy++) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (dx === <span class=\"number\">0</span> &amp;&amp; dy === <span class=\"number\">0</span>) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">                neighbors.<span class=\"title function_\">push</span>([x + dx, y + dy]);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> neighbors;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"title function_\">countActiveNeighbors</span>(<span class=\"attr\">x</span>: <span class=\"built_in\">number</span>, <span class=\"attr\">y</span>: <span class=\"built_in\">number</span>): <span class=\"built_in\">number</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.<span class=\"title function_\">getNeighbors</span>(x, y).<span class=\"title function_\">reduce</span>(</span><br><span class=\"line\">            <span class=\"function\">(<span class=\"params\">count, [nx, ny]</span>) =&gt;</span> count + (<span class=\"variable language_\">this</span>.<span class=\"title function_\">isActive</span>(nx, ny) ? <span class=\"number\">1</span> : <span class=\"number\">0</span>),</span><br><span class=\"line\">            <span class=\"number\">0</span></span><br><span class=\"line\">        );</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">step</span>(): <span class=\"built_in\">void</span> &#123; <span class=\"comment\">// 执行一次规则</span></span><br><span class=\"line\">        <span class=\"keyword\">const</span> toEvaluate = <span class=\"keyword\">new</span> <span class=\"title class_\">Set</span>&lt;<span class=\"built_in\">string</span>&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">const</span> <span class=\"attr\">nextState</span>: <span class=\"title class_\">Array</span>&lt;[<span class=\"built_in\">number</span>, <span class=\"built_in\">number</span>]&gt; = [];</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">activeCells</span>.<span class=\"title function_\">forEach</span>(<span class=\"function\">(<span class=\"params\">[x, y]</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            toEvaluate.<span class=\"title function_\">add</span>(<span class=\"string\">`<span class=\"subst\">$&#123;x&#125;</span>,<span class=\"subst\">$&#123;y&#125;</span>`</span>);</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.<span class=\"title function_\">getNeighbors</span>(x, y).<span class=\"title function_\">forEach</span>(<span class=\"function\">(<span class=\"params\">[nx, ny]</span>) =&gt;</span> &#123;</span><br><span class=\"line\">                toEvaluate.<span class=\"title function_\">add</span>(<span class=\"string\">`<span class=\"subst\">$&#123;nx&#125;</span>,<span class=\"subst\">$&#123;ny&#125;</span>`</span>);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">        toEvaluate.<span class=\"title function_\">forEach</span>(<span class=\"function\">(<span class=\"params\"><span class=\"attr\">cell</span>: <span class=\"built_in\">string</span></span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">const</span> [x, y] = cell.<span class=\"title function_\">split</span>(<span class=\"string\">&quot;,&quot;</span>).<span class=\"title function_\">map</span>(<span class=\"title class_\">Number</span>);</span><br><span class=\"line\">            <span class=\"keyword\">const</span> isActive = <span class=\"variable language_\">this</span>.<span class=\"title function_\">isActive</span>(x, y);</span><br><span class=\"line\">            <span class=\"keyword\">const</span> activeNeighbors = <span class=\"variable language_\">this</span>.<span class=\"title function_\">countActiveNeighbors</span>(x, y);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (</span><br><span class=\"line\">                (isActive &amp;&amp; (activeNeighbors === <span class=\"number\">2</span> || activeNeighbors === <span class=\"number\">3</span>)) ||</span><br><span class=\"line\">                (!isActive &amp;&amp; activeNeighbors === <span class=\"number\">3</span>)</span><br><span class=\"line\">            ) &#123;</span><br><span class=\"line\">                nextState.<span class=\"title function_\">push</span>([x, y]);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">activeCells</span> = nextState;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"电脑共享VPN到手机方法","abbrlink":"36de35a5","date":"2024-08-21T09:03:09.000Z","_content":"#### 实现原理电脑开启VPN，手机和电脑连接同一个WIFI,设置手机代理为电脑的HTTP代理端口，从而实现共享VPN\n#### 1.设置代理的方法如下图所示，我使用的是clash,在查看clash代理端口时，可以直接在windows搜索栏中输入“代理服务器设置”， 其他的vpn应该类似。\n![avatar](../images/vpn1.png)\n![avatar](../images/vpn2.png)\n#### 2.手机wifi代理设置完毕之后就可以正常使用网络了\n","source":"_posts/电脑共享VPN到手机方法.md","raw":"---\ntitle: 电脑共享VPN到手机方法\nabbrlink: 36de35a5\ndate: 2024-08-21 17:03:09\ntags: VPN\n---\n#### 实现原理电脑开启VPN，手机和电脑连接同一个WIFI,设置手机代理为电脑的HTTP代理端口，从而实现共享VPN\n#### 1.设置代理的方法如下图所示，我使用的是clash,在查看clash代理端口时，可以直接在windows搜索栏中输入“代理服务器设置”， 其他的vpn应该类似。\n![avatar](../images/vpn1.png)\n![avatar](../images/vpn2.png)\n#### 2.手机wifi代理设置完毕之后就可以正常使用网络了\n","slug":"电脑共享VPN到手机方法","published":1,"updated":"2024-08-21T09:12:38.078Z","_id":"cm03mm8d600000ckvcgaaa9x0","comments":1,"layout":"post","photos":[],"link":"","content":"<h4 id=\"实现原理电脑开启VPN，手机和电脑连接同一个WIFI-设置手机代理为电脑的HTTP代理端口，从而实现共享VPN\"><a href=\"#实现原理电脑开启VPN，手机和电脑连接同一个WIFI-设置手机代理为电脑的HTTP代理端口，从而实现共享VPN\" class=\"headerlink\" title=\"实现原理电脑开启VPN，手机和电脑连接同一个WIFI,设置手机代理为电脑的HTTP代理端口，从而实现共享VPN\"></a>实现原理电脑开启VPN，手机和电脑连接同一个WIFI,设置手机代理为电脑的HTTP代理端口，从而实现共享VPN</h4><h4 id=\"1-设置代理的方法如下图所示，我使用的是clash-在查看clash代理端口时，可以直接在windows搜索栏中输入“代理服务器设置”，-其他的vpn应该类似。\"><a href=\"#1-设置代理的方法如下图所示，我使用的是clash-在查看clash代理端口时，可以直接在windows搜索栏中输入“代理服务器设置”，-其他的vpn应该类似。\" class=\"headerlink\" title=\"1.设置代理的方法如下图所示，我使用的是clash,在查看clash代理端口时，可以直接在windows搜索栏中输入“代理服务器设置”， 其他的vpn应该类似。\"></a>1.设置代理的方法如下图所示，我使用的是clash,在查看clash代理端口时，可以直接在windows搜索栏中输入“代理服务器设置”， 其他的vpn应该类似。</h4><p><img src=\"/../images/vpn1.png\" alt=\"avatar\"><br><img src=\"/../images/vpn2.png\" alt=\"avatar\"></p>\n<h4 id=\"2-手机wifi代理设置完毕之后就可以正常使用网络了\"><a href=\"#2-手机wifi代理设置完毕之后就可以正常使用网络了\" class=\"headerlink\" title=\"2.手机wifi代理设置完毕之后就可以正常使用网络了\"></a>2.手机wifi代理设置完毕之后就可以正常使用网络了</h4>","site":{"data":{}},"cover":"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7","excerpt":"","more":"<h4 id=\"实现原理电脑开启VPN，手机和电脑连接同一个WIFI-设置手机代理为电脑的HTTP代理端口，从而实现共享VPN\"><a href=\"#实现原理电脑开启VPN，手机和电脑连接同一个WIFI-设置手机代理为电脑的HTTP代理端口，从而实现共享VPN\" class=\"headerlink\" title=\"实现原理电脑开启VPN，手机和电脑连接同一个WIFI,设置手机代理为电脑的HTTP代理端口，从而实现共享VPN\"></a>实现原理电脑开启VPN，手机和电脑连接同一个WIFI,设置手机代理为电脑的HTTP代理端口，从而实现共享VPN</h4><h4 id=\"1-设置代理的方法如下图所示，我使用的是clash-在查看clash代理端口时，可以直接在windows搜索栏中输入“代理服务器设置”，-其他的vpn应该类似。\"><a href=\"#1-设置代理的方法如下图所示，我使用的是clash-在查看clash代理端口时，可以直接在windows搜索栏中输入“代理服务器设置”，-其他的vpn应该类似。\" class=\"headerlink\" title=\"1.设置代理的方法如下图所示，我使用的是clash,在查看clash代理端口时，可以直接在windows搜索栏中输入“代理服务器设置”， 其他的vpn应该类似。\"></a>1.设置代理的方法如下图所示，我使用的是clash,在查看clash代理端口时，可以直接在windows搜索栏中输入“代理服务器设置”， 其他的vpn应该类似。</h4><p><img src=\"/../images/vpn1.png\" alt=\"avatar\"><br><img src=\"/../images/vpn2.png\" alt=\"avatar\"></p>\n<h4 id=\"2-手机wifi代理设置完毕之后就可以正常使用网络了\"><a href=\"#2-手机wifi代理设置完毕之后就可以正常使用网络了\" class=\"headerlink\" title=\"2.手机wifi代理设置完毕之后就可以正常使用网络了\"></a>2.手机wifi代理设置完毕之后就可以正常使用网络了</h4>"},{"title":"Git推送失败443","abbrlink":"3bc3f9fd","date":"2024-08-21T09:22:44.000Z","_content":"","source":"_posts/Git推送失败443.md","raw":"---\ntitle: Git推送失败443\nabbrlink: 3bc3f9fd\ndate: 2024-08-21 17:22:44\ntags:\n---\n","slug":"Git推送失败443","published":1,"updated":"2024-08-21T09:22:51.342Z","_id":"cm03nbd180000g0kvau0m5vct","comments":1,"layout":"post","photos":[],"link":"","content":"","site":{"data":{}},"cover":"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7","excerpt":"","more":""}],"PostAsset":[],"PostCategory":[],"PostTag":[{"post_id":"cl2stpn4900010ovn1qbp84m4","tag_id":"cl2stpn4e00030ovngu6h2okz","_id":"cl2stpn4j00080ovnejvse0vy"},{"post_id":"cl2stpn4c00020ovn7ln844l9","tag_id":"cl2stpn4i00070ovn9i3vfrhu","_id":"cl2stpn4k000b0ovn4jqa0hx4"},{"post_id":"cl2stpn4f00040ovnanbwdeeo","tag_id":"cl2stpn4k000a0ovncsuc8wuf","_id":"cl2stpn4l000d0ovnbrzb4rdr"},{"post_id":"cl2stpn4g00050ovnc0d93ipv","tag_id":"cl2stpn4l000c0ovn31532tl9","_id":"cl2stpn4l000f0ovn26kg9fpk"},{"post_id":"cl2stpn4i00060ovncmom35t9","tag_id":"cl2stpn4l000e0ovn9bdj85la","_id":"cl2stpn4l000g0ovndcn9h6to"},{"post_id":"cl2stpn4j00090ovn01rv3qs1","tag_id":"cl2stpn4e00030ovngu6h2okz","_id":"cl2stqh0i0000b0vnamqu2pcn"},{"post_id":"cl2yfocqf0000bovnh1d51htu","tag_id":"cl2yfq4fr0000jcvnaumkc5d2","_id":"cl2yfq4fu0001jcvnc44pajvg"},{"post_id":"cl2yiuekw00006kvn4ah61oxw","tag_id":"cl2stpn4l000c0ovn31532tl9","_id":"cl2yk8w3l0000gkvnf8r6ai9w"},{"post_id":"cl2zuujf60000a8vn4331bbhv","tag_id":"cl2zuxsuk0000ucvn42z7b02a","_id":"cl2zuxsum0001ucvnhb9l5c9x"},{"post_id":"cl2zvsk5k0000xgvna1cu609j","tag_id":"cl2zuxsuk0000ucvn42z7b02a","_id":"cl2zvsk5m0001xgvn6m2v5ydq"},{"post_id":"cl384kvze0000i8vndy6xemti","tag_id":"cl384kvzj0001i8vndu7teib2","_id":"cl384kvzm0002i8vn0qymgh27"},{"post_id":"cl386imhn0000gwvn9b8a48wt","tag_id":"cl384kvzj0001i8vndu7teib2","_id":"cl386imhq0001gwvn7xq7e3xb"},{"post_id":"clzl40jfp0000uckv4x511y5w","tag_id":"clzl40jft0001uckv64v9d8z8","_id":"clzl40jfv0002uckvfuzc999w"},{"post_id":"clzl55jzv0000k8kv9dao807d","tag_id":"clzl55jzw0001k8kv93eq2hjo","_id":"clzl55jzy0002k8kv0mufcg5u"},{"post_id":"clzmcegld000028kvfj3c8yfb","tag_id":"cl2zuxsuk0000ucvn42z7b02a","_id":"clzmcflbm000128kv5xhqakiz"},{"post_id":"clzmd3xjv000228kv9864g8mc","tag_id":"clzl40jft0001uckv64v9d8z8","_id":"clzmdj59o000328kv44iyam4e"},{"post_id":"clzqgw0zg000024kvhmgzapnp","tag_id":"cl2stpn4i00070ovn9i3vfrhu","_id":"clzqgw0zj000124kvg1eefmyj"},{"post_id":"cm03mm8d600000ckvcgaaa9x0","tag_id":"cm03n0j020000h4kv3nid1awd","_id":"cm03n0j050001h4kveeds2397"}],"Tag":[{"name":"Vite","_id":"cl2stpn4e00030ovngu6h2okz"},{"name":"TypeScript","_id":"cl2stpn4i00070ovn9i3vfrhu"},{"name":"WeiXinPay","_id":"cl2stpn4k000a0ovncsuc8wuf"},{"name":"Vue","_id":"cl2stpn4l000c0ovn31532tl9"},{"name":"微信小程序","_id":"cl2stpn4l000e0ovn9bdj85la"},{"name":"Pinia","_id":"cl2yfq4fr0000jcvnaumkc5d2"},{"name":"Web3.js","_id":"cl2zuxsuk0000ucvn42z7b02a"},{"name":"Css","_id":"cl384kvzj0001i8vndu7teib2"},{"name":"BTC","_id":"clzl40jft0001uckv64v9d8z8"},{"name":"Animate","_id":"clzl55jzw0001k8kv93eq2hjo"},{"name":"VPN","_id":"cm03n0j020000h4kv3nid1awd"}]}}